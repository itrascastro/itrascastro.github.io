<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <title>Bloc 3: Formularis reactius i validacions | DA2_OA01 - Programació Avançada (Angular) - IOC</title>
    <meta name="description" content="Material educatiu - Institut Obert de Catalunya">
    <meta name="page-unitat" content="3">
    <meta name="page-bloc" content="3">
    
    <!-- SEO Tags -->
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Bloc 3: Formularis reactius i validacions | DA2_OA01 - Programació Avançada (Angular)</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Bloc 3: Formularis reactius i validacions" />
<meta property="og:locale" content="ca_ES" />
<meta name="description" content="FormGroup, FormControl, FormBuilder i validadors integrats per gestió avançada de formularis" />
<meta property="og:description" content="FormGroup, FormControl, FormBuilder i validadors integrats per gestió avançada de formularis" />
<link rel="canonical" href="http://localhost:4006/ioc/da2_OA01/unitat-3/bloc-3/" />
<meta property="og:url" content="http://localhost:4006/ioc/da2_OA01/unitat-3/bloc-3/" />
<meta property="og:site_name" content="DA2_OA01 - Programació Avançada (Angular)" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Bloc 3: Formularis reactius i validacions" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"FormGroup, FormControl, FormBuilder i validadors integrats per gestió avançada de formularis","headline":"Bloc 3: Formularis reactius i validacions","url":"http://localhost:4006/ioc/da2_OA01/unitat-3/bloc-3/"}</script>
<!-- End Jekyll SEO tag -->

    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/ioc/da2_OA01/assets/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="canonical" href="http://localhost:4006/ioc/da2_OA01/unitat-3/bloc-3/">
    <!-- Rich editor styles (for embedded notes panel) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.snow.min.css">
    <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css" disabled>
    <link rel="stylesheet" href="/ioc/da2_OA01/assets/css/quadern-rich-editor.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/ioc/da2_OA01/assets/images/favicon.ico">
    
    <!-- RSS Feed -->
    <link type="application/atom+xml" rel="alternate" href="http://localhost:4006/ioc/da2_OA01/feed.xml" title="DA2_OA01 - Programació Avançada (Angular)" />

    <!-- Syntax Highlighting (Prism) -->
    <link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-java.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-jsx.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-html.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-tsx.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>

    <!-- Code Block Component -->
    <link rel="stylesheet" href="/ioc/da2_OA01/assets/css/code-block.css">
    <script src="/ioc/da2_OA01/assets/js/code-block.js"></script>

</head>

<body class="bloc-layout">
    <!-- Skip to content for accessibility -->
    <a class="skip-link" href="#main-content">Salta al contingut principal</a>


    
    <!-- Header fix -->
    <header class="header" role="banner" id="top">
        <div class="header-brand">
            <a href="/ioc/da2_OA01/" class="logo-link" aria-label="Inici">
                <img src="/ioc/da2_OA01/assets/images/logo_IOC_light.jpg" alt="Institut Obert de Catalunya" class="logo logo-light">
                <img src="/ioc/da2_OA01/assets/images/logo_IOC_dark.png" alt="Institut Obert de Catalunya" class="logo logo-dark">
            </a>
            <a href="/ioc/da2_OA01/" class="title-link">
                <h1>DA2_OA01 - DA2_OA01 - Programació Avançada (Angular)</h1>
            </a>
        </div>
        <div class="header-actions">
            <button class="theme-toggle" id="theme-toggle">Mode Fosc</button>
            <button class="nav-panel-toggle" type="button" aria-expanded="false" aria-label="Obre la navegació">
                <i class="bi bi-list" aria-hidden="true"></i>
                <span class="nav-panel-label">Navegació</span>
            </button>
        </div>
    </header>

    <div class="offcanvas-backdrop" hidden></div>
    <nav class="offcanvas-nav" aria-hidden="true" aria-label="Navegació del curs">
        <div class="offcanvas-header">
            <h2 class="offcanvas-title">Navegació</h2>
            <button class="offcanvas-close" type="button" aria-label="Tanca la navegació">
                <i class="bi bi-x-lg" aria-hidden="true"></i>
            </button>
        </div>
        <div class="offcanvas-body">
            <a href="/ioc/da2_OA01/" class="nav-dropdown-item ">Índex del Curs</a>
            
                
                    <a href="/ioc/da2_OA01/unitat-1/bloc-1/" class="nav-dropdown-item ">
                        Unitat 1 - Bloc 1: Conceptes fonamentals i instal·lació
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-1/bloc-2/" class="nav-dropdown-item ">
                        Unitat 1 - Bloc 2: Entorn de desenvolupament integrat
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-1/bloc-3/" class="nav-dropdown-item ">
                        Unitat 1 - Bloc 3: Creació del projecte base
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-1/bloc-4/" class="nav-dropdown-item ">
                        Unitat 1 - Bloc 4: Cas d'ús: Preparació de l'entorn
                    </a>
                
            
                
                    <a href="/ioc/da2_OA01/unitat-2/bloc-1/" class="nav-dropdown-item ">
                        Unitat 2 - Bloc 1: Components i comunicació bàsica
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-2/bloc-2/" class="nav-dropdown-item ">
                        Unitat 2 - Bloc 2: Data binding i events
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-2/bloc-3/" class="nav-dropdown-item ">
                        Unitat 2 - Bloc 3: Formularis amb vinculació bidireccional
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-2/bloc-4/" class="nav-dropdown-item ">
                        Unitat 2 - Bloc 4: Cas d'ús: Catàleg d'elements
                    </a>
                
            
                
                    <a href="/ioc/da2_OA01/unitat-3/bloc-1/" class="nav-dropdown-item ">
                        Unitat 3 - Bloc 1: Serveis i separació de responsabilitats
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-3/bloc-2/" class="nav-dropdown-item ">
                        Unitat 3 - Bloc 2: Gestió d'estat i comunicació entre components
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-3/bloc-3/" class="nav-dropdown-item current">
                        Unitat 3 - Bloc 3: Optimització i bones pràctiques
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-3/bloc-4/" class="nav-dropdown-item ">
                        Unitat 3 - Bloc 4: Cas d'ús: Catàleg amb API REST
                    </a>
                
            
                
                    <a href="/ioc/da2_OA01/unitat-4/bloc-1/" class="nav-dropdown-item ">
                        Unitat 4 - Bloc 1: Sistema de rutes i navegació
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-4/bloc-2/" class="nav-dropdown-item ">
                        Unitat 4 - Bloc 2: Arquitectura escalable
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-4/bloc-3/" class="nav-dropdown-item ">
                        Unitat 4 - Bloc 3: Optimització de rendiment
                    </a>
                
                    <a href="/ioc/da2_OA01/unitat-4/bloc-4/" class="nav-dropdown-item ">
                        Unitat 4 - Bloc 4: Cas d'ús: Aplicació completa
                    </a>
                
            
        </div>
    </nav>

    <div class="container">
        <!-- Sidebar Navegació -->
        
        <aside class="sidebar">
            <button class="sidebar-toggle" type="button" aria-expanded="false">
                <span>Contingut del bloc</span>
                <i class="bi bi-chevron-down" aria-hidden="true"></i>
            </button>
            <div class="sidebar-scroll">
                <!-- Contingut d'aquest Bloc -->
                <div class="sidebar-section">
                    <h3>Contingut del Bloc</h3>
                    

    
    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat3_Bloc3_Seccio1" class="nav-link" data-section="Unitat3_Bloc3_Seccio1">1. Formularis reactius: grups i controls</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat3_Bloc3_Seccio2" class="nav-link" data-section="Unitat3_Bloc3_Seccio2">2. Validacions personalitzades i asíncrones</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat3_Bloc3_Seccio3" class="nav-link" data-section="Unitat3_Bloc3_Seccio3">3. Formularis complexos i camps dinàmics</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    



                </div>
            </div>
        </aside>
        

        <main class="main-content" role="main" id="main-content">
            
            <!-- Navegació horizontal -->
            
            <nav class="horizontal-nav" aria-label="Navegació de ruta">
                <div class="horizontal-nav-list">
                    <a href="/ioc/da2_OA01/" class="horizontal-nav-item">Inici</a>
                    
                    
                        
                        
                            
                        
                            
                        
                            
                                
                                
                        
                        
                            <span class="horizontal-nav-separator"> &gt; </span>
                            <a href="/ioc/da2_OA01/unitat-3/" class="horizontal-nav-item">
                                Unitat 3: Serveis i gestió de dades (RA3)
                            </a>
                        
                        
                        
                            
                            
                                
                            
                                
                            
                                
                                    
                                    
                            
                            
                                <span class="horizontal-nav-separator"> &gt; </span>
                                <span class="horizontal-nav-item current">
                                    Bloc 3.3: Optimització i bones pràctiques
                                </span>
                            
                        
                    
                </div>
            </nav>
            
            
            <!-- Contingut de la Pàgina -->
            <article class="page-content">
                <div class="content-body">
                    

<!-- Objectius del bloc (si estan definits al frontmatter) -->


<!-- Contingut principal -->
<!-- SECCIÓ 1: Formularis reactius: grups i controls -->
<div class="section" id="Unitat3_Bloc3_Seccio1">
  <h2 id="Unitat3_Bloc3_Seccio1">1. Formularis reactius: grups i controls</h2>

  <!-- MULTIMÈDIA -->
  <!--
  ════════════════════════════════════════════════════════════════
  Component: Enllaços multimèdia YouTube
  ════════════════════════════════════════════════════════════════

  Paràmetres:
    - unitat: número de la unitat (1-4)
    - bloc: número del bloc (1-4)
    - seccio: número de la secció (1-3)

  Exemple d'ús:
    {% include multimedia-youtube.html unitat=1 bloc=1 seccio=1 %}

  El component busca automàticament les URLs corresponents a
  site.data.multimedia i mostra els botons de vídeo i àudio.
  ════════════════════════════════════════════════════════════════
-->





  
  
  
  
  

  

  

  
<div class="multimedia-resources">
  <div class="multimedia-header">
    <i class="bi bi-play-circle-fill"></i>
    <span>Contingut multimèdia d'aquesta lectura</span>
  </div>

  <div class="multimedia-buttons">
    
    <a href="https://www.youtube.com/watch?v=hwk4PEpVa6Q" target="_blank" rel="noopener noreferrer" class="multimedia-btn video-btn" title="Lectura 3.3.1 · Formularis reactius: grups i controls">
      <i class="bi bi-youtube"></i>
      <span>Veure vídeo</span>
      <i class="bi bi-box-arrow-up-right"></i>
    </a>
    

    
    <a href="https://www.youtube.com/watch?v=WgXW1IuRqMU" target="_blank" rel="noopener noreferrer" class="multimedia-btn audio-btn" title="[Audio] Lectura 3.3.1 · Formularis reactius: grups i controls">
      <i class="bi bi-mic-fill"></i>
      <span>Escoltar àudio</span>
      <i class="bi bi-box-arrow-up-right"></i>
    </a>
    
  </div>

  
  
</div>
  




  <!-- Component: Objectius del bloc/unitat -->



<div class="objectius-box">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-bullseye" aria-hidden="true"></i> Objectius</div>
  <div class="component-content">
    <ul>
      
        <li>Crear formularis reactius amb FormGroup, FormControl i FormBuilder, configurant la seva estructura completament des de TypeScript per obtenir control programàtic total</li>
      
        <li>Aplicar validadors integrats (Validators.required, minLength, pattern, etc.) i gestionar missatges d'error reactius que es mostrin dinàmicament segons l'estat del formulari</li>
      
        <li>Comparar formularis template-driven i reactius per decidir quin enfocament utilitzar segons la complexitat i els requisits del projecte</li>
      
    </ul>
  </div>
  <!-- IMPORTANT: també es pot usar via front matter: page.objectius (array) -->
</div>



  <!-- Component: Caixa informativa -->
<div class="info-box" role="note">
    <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-info-circle" aria-hidden="true"></i> Informació</div>
    <strong>RA3 · Criteri 1</strong> — Defineix models de dades i estructures adequades al cas d'ús.
    
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.1. Prerequisits</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<p>Abans de començar, necessiteu:</p>
<ul>
<li><strong>Unitat 2 completa:</strong> Formularis template-driven funcionals amb <code>[(ngModel)]</code> i validacions bàsiques.</li>
<li><strong>Lectures 3.1.x–3.2.x:</strong> <code>ElementService</code> amb signals operatiu, components reactius funcionals.</li>
<li><strong>Projecte actualitzat:</strong> <code>cataleg-elements</code> amb <code>git status</code> net, sense canvis pendents.</li>
<li><strong>VS Code obert:</strong> Terminal integrada disponible per executar comandes Angular CLI.</li>
<li><strong>Documentació:</strong> Fitxer <code>docs/formularis.md</code> existent de la Unitat 2.</li>
</ul>
<p><strong>Verificació ràpida:</strong></p>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">cd ~/workspace/cataleg-elements
ng serve --port 4300
# Verificar http://localhost:4300 accessible amb catàleg funcional</code></pre>
  </div>
</div>

<p><strong>Punt d'autocomprovació:</strong> Servidor operatiu, catàleg visible al navegador, formularis template-driven de la Unitat 2 funcionals.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.2. Marc conceptual</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.2.1. Què són els formularis reactius</h4>
<p>Els <strong>formularis reactius</strong> (reactive forms) són un enfocament de gestió de formularis en Angular on l'estructura, validacions i lògica es defineixen completament a la classe TypeScript del component, i la plantilla HTML només reflecteix aquesta configuració. Proporcionen control programàtic total sobre l'estat del formulari, permetent validacions dinàmiques, transformacions de dades i gestió complexa d'esdeveniments.</p>
<p><strong>Diferència clau:</strong></p>
<ul>
<li><strong>Template-driven:</strong> Configuració al HTML amb directives (<code>ngModel</code>, <code>required</code>, etc.)</li>
<li><strong>Reactius:</strong> Configuració al TypeScript amb <code>FormGroup</code>, <code>FormControl</code>, <code>Validators</code></li>
</ul>
<h4>1.2.2. Problema amb formularis template-driven</h4>
<p>Els formularis template-driven són suficients per casos simples, però presenten limitacions quan la complexitat augmenta.</p>
<p><strong>Situació amb template-driven:</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">export class FormulariComponent {
  element = {
    titol: &#39;&#39;,
    categoria: &#39;&#39;,
    valoracio: 0
  };
  onSubmit(): void {
    console.log(this.element);
  }
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;form #formulari=&quot;ngForm&quot; (ngSubmit)=&quot;onSubmit()&quot;&gt;
&lt;label&gt;
Títol
&lt;input type=&quot;text&quot; name=&quot;titol&quot; [(ngModel)]=&quot;element.titol&quot; required minlength=&quot;4&quot; #titol=&quot;ngModel&quot;&gt;
&lt;/label&gt;
&lt;div *ngIf=&quot;titol.touched &amp;&amp; titol.invalid&quot;&gt;
&lt;p *ngIf=&quot;titol.errors?.[&#39;required&#39;]&quot;&gt;El títol és obligatori.&lt;/p&gt;
&lt;p *ngIf=&quot;titol.errors?.[&#39;minlength&#39;]&quot;&gt;Cal almenys 4 caràcters.&lt;/p&gt;
&lt;/div&gt;
&lt;label&gt;
Categoria
&lt;select name=&quot;categoria&quot; [(ngModel)]=&quot;element.categoria&quot; required&gt;
&lt;option value=&quot;&quot;&gt;Selecciona...&lt;/option&gt;
&lt;option value=&quot;UI&quot;&gt;Components UI&lt;/option&gt;
&lt;option value=&quot;Backend&quot;&gt;Backend&lt;/option&gt;
&lt;/select&gt;
&lt;/label&gt;
&lt;label&gt;
Valoració (0-5)
&lt;input type=&quot;number&quot; name=&quot;valoracio&quot; [(ngModel)]=&quot;element.valoracio&quot; required min=&quot;0&quot; max=&quot;5&quot;&gt;
&lt;/label&gt;
&lt;button type=&quot;submit&quot; [disabled]=&quot;formulari.invalid&quot;&gt;Guardar&lt;/button&gt;
&lt;/form&gt;</code></pre>
  </div>
</div>

<p><strong>Problemes que genera:</strong></p>
<p><strong>1. Validacions dinàmiques impossibles</strong></p>
<p>Afegir o eliminar validacions segons altres camps requereix lògica complexa al template amb múltiples <code>*ngIf</code>. Exemple: "Si categoria = 'Backend', el camp 'tecnologia' és obligatori". Amb template-driven, cal mantenir sincronitzat estat entre template i component. Codi fràgil i difícil de mantenir quan hi ha 10+ camps interdependents.</p>
<p><strong>2. Testing extremadament difícil</strong></p>
<p>Provar formulari template-driven requereix simular DOM complet, crear instàncies de directives Angular (<code>ngModel</code>, <code>ngForm</code>) i esperar detecció de canvis. Tests lents (100-300ms per test), fràgils (canviar HTML trenca tests) i acoblats a implementació. Impossible fer tests unitaris purs sense integració.</p>
<p><strong>3. Lògica dispersa entre template i component</strong></p>
<p>Validacions al HTML (<code>required</code>, <code>minlength</code>), gestió d'errors al template (<code>*ngIf</code>), transformacions al component. Quan teniu 15 camps amb validacions personalitzades, cal buscar codi a 3 llocs diferents. Manteniment caòtic. Difícil entendre flux complet.</p>
<p><strong>4. Reutilització limitada</strong></p>
<p>Voleu el mateix formulari amb validacions diferents? Cal duplicar HTML complet. Voleu validacions compartides entre 5 formularis? Cal copiar directives a cada template. Zero reutilització de lògica de validació.</p>
<p><strong>5. Control programàtic mínim</strong></p>
<p>Deshabilitar camp segons resposta API? Complicat amb template-driven. Omplir formulari amb dades carregades asíncronament? Sincronització manual propensa a errors. Subscriure's a canvis d'un camp per actualitzar un altre? Lògica enrevessada amb <code>@ViewChild</code> i esdeveniments.</p>
<h4>1.2.3. Solució amb formularis reactius</h4>
<p>Angular proporciona API programàtica amb control total des de TypeScript.</p>
<p><strong>Situació amb formularis reactius:</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Component, OnInit, inject } from &#39;@angular/core&#39;;
import { FormBuilder, FormGroup, Validators, ReactiveFormsModule } from &#39;@angular/forms&#39;;
@Component({
  selector: &#39;app-formulari-reactiu&#39;,
  standalone: true,
  imports: [ReactiveFormsModule, CommonModule],
  templateUrl: &#39;./formulari-reactiu.component.html&#39;
})
export class FormulariReactiuComponent implements OnInit {
  private readonly fb = inject(FormBuilder);
  formulari!: FormGroup;
  ngOnInit(): void {
    this.formulari = this.fb.group({
      titol: [&#39;&#39;, [Validators.required, Validators.minLength(4)]],
      categoria: [&#39;&#39;, Validators.required],
      valoracio: [0, [Validators.required, Validators.min(0), Validators.max(5)]],
      descripcio: [&#39;&#39;, Validators.maxLength(200)]
    });
    this.formulari.get(&#39;categoria&#39;)?.valueChanges.subscribe(categoria =&gt; {
      if (categoria === &#39;Backend&#39;) {
        this.formulari.get(&#39;descripcio&#39;)?.setValidators([Validators.required, Validators.minLength(20)]);
      } else {
        this.formulari.get(&#39;descripcio&#39;)?.setValidators([Validators.maxLength(200)]);
      }
      this.formulari.get(&#39;descripcio&#39;)?.updateValueAndValidity();
    });
  }
  onSubmit(): void {
    if (this.formulari.valid) {
      console.log(this.formulari.value);
    }
  }
  get titolControl() {
    return this.formulari.get(&#39;titol&#39;);
  }
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;form [formGroup]=&quot;formulari&quot; (ngSubmit)=&quot;onSubmit()&quot;&gt;
&lt;label&gt;
Títol
&lt;input type=&quot;text&quot; formControlName=&quot;titol&quot;&gt;
&lt;/label&gt;
&lt;div *ngIf=&quot;titolControl?.touched &amp;&amp; titolControl?.invalid&quot; class=&quot;error&quot;&gt;
&lt;p *ngIf=&quot;titolControl?.hasError(&#39;required&#39;)&quot;&gt;El títol és obligatori.&lt;/p&gt;
&lt;p *ngIf=&quot;titolControl?.hasError(&#39;minlength&#39;)&quot;&gt;
Cal almenys {{ titolControl?.errors?.[&#39;minlength&#39;].requiredLength }} caràcters.
&lt;/p&gt;
&lt;/div&gt;
&lt;label&gt;
Categoria
&lt;select formControlName=&quot;categoria&quot;&gt;
&lt;option value=&quot;&quot;&gt;Selecciona...&lt;/option&gt;
&lt;option value=&quot;UI&quot;&gt;Components UI&lt;/option&gt;
&lt;option value=&quot;Backend&quot;&gt;Backend&lt;/option&gt;
&lt;/select&gt;
&lt;/label&gt;
&lt;label&gt;
Valoració (0-5)
&lt;input type=&quot;number&quot; formControlName=&quot;valoracio&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Descripció
&lt;textarea formControlName=&quot;descripcio&quot;&gt;&lt;/textarea&gt;
&lt;/label&gt;
&lt;button type=&quot;submit&quot; [disabled]=&quot;formulari.invalid&quot;&gt;Guardar&lt;/button&gt;
&lt;/form&gt;</code></pre>
  </div>
</div>

<p><strong>Avantatges específics:</strong></p>
<ul>
<li><i class="bi bi-check-circle" aria-hidden="true"></i> <strong>Validacions dinàmiques fàcils:</strong> Afegir/eliminar validadors programàticament amb <code>.setValidators()</code>. Exemple implementat: quan categoria = "Backend", descripció es torna obligatòria. Codi net i localitzat.</li>
<li><i class="bi bi-check-circle" aria-hidden="true"></i> <strong>Testing unitari pur:</strong> Provar FormGroup sense DOM. Test exemple: <code>expect(formulari.get('titol')?.hasError('required')).toBe(true)</code>. Tests ràpids (5-10ms), desacoblats de HTML, mantenibles.</li>
<li><i class="bi bi-check-circle" aria-hidden="true"></i> <strong>Lògica centralitzada:</strong> Totes les validacions al <code>ngOnInit()</code>. Codi fàcil de trobar, modificar i revisar. Un cop entès el component TypeScript, tens tota la lògica del formulari.</li>
<li><i class="bi bi-check-circle" aria-hidden="true"></i> <strong>Reutilització senzilla:</strong> Crear funció <code>crearFormulariElement()</code> retornant FormGroup. Reutilitzar validadors personalitzats entre múltiples formularis. Validador compartit: 1 funció vs 10 templates amb directives duplicades.</li>
<li><i class="bi bi-check-circle" aria-hidden="true"></i> <strong>Control programàtic total:</strong> Deshabilitar camps: <code>.disable()</code>. Omplir formulari: <code>.setValue()</code>. Subscriure's a canvis: <code>.valueChanges.subscribe()</code>. API potent i flexible.</li>
</ul>
<h4>1.2.4. Exemple real complet</h4>
<p><strong>Situació:</strong> Formulari d'element amb validació dinàmica: si categoria = "Backend", descripció obligatòria (min 20 caràcters); si no, opcional (max 200).</p>
<p><strong>Amb template-driven (complex):</strong></p>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;textarea name=&quot;descripcio&quot; [(ngModel)]=&quot;element.descripcio&quot; [required]=&quot;element.categoria === &#39;Backend&#39;&quot; [minlength]=&quot;element.categoria === &#39;Backend&#39; ? 20 : 0&quot; [maxlength]=&quot;element.categoria !== &#39;Backend&#39; ? 200 : 9999&quot;&gt;
&lt;/textarea&gt;
&lt;div *ngIf=&quot;descripcio.touched &amp;&amp; descripcio.invalid&quot;&gt;
&lt;p *ngIf=&quot;descripcio.errors?.[&#39;required&#39;] &amp;&amp; element.categoria === &#39;Backend&#39;&quot;&gt;
Descripció obligatòria per Backend.
&lt;/p&gt;
&lt;p *ngIf=&quot;descripcio.errors?.[&#39;minlength&#39;] &amp;&amp; element.categoria === &#39;Backend&#39;&quot;&gt;
Cal almenys 20 caràcters per Backend.
&lt;/p&gt;
&lt;p *ngIf=&quot;descripcio.errors?.[&#39;maxlength&#39;] &amp;&amp; element.categoria !== &#39;Backend&#39;&quot;&gt;
Màxim 200 caràcters.
&lt;/p&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<p><strong>Amb reactius (clar i mantenible):</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">ngOnInit(): void {
  this.formulari = this.fb.group({
    categoria: [&#39;&#39;, Validators.required],
    descripcio: [&#39;&#39;, Validators.maxLength(200)]
  });
  this.formulari.get(&#39;categoria&#39;)?.valueChanges.subscribe(categoria =&gt; {
    const descripcioControl = this.formulari.get(&#39;descripcio&#39;);
    if (categoria === &#39;Backend&#39;) {
      descripcioControl?.setValidators([
        Validators.required,
        Validators.minLength(20)
      ]);
    } else {
      descripcioControl?.setValidators([Validators.maxLength(200)]);
    }
    descripcioControl?.updateValueAndValidity();
  });
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;select formControlName=&quot;categoria&quot;&gt;...&lt;/select&gt;
&lt;textarea formControlName=&quot;descripcio&quot;&gt;&lt;/textarea&gt;
&lt;div *ngIf=&quot;descripcioControl?.touched &amp;&amp; descripcioControl?.invalid&quot;&gt;
&lt;p *ngIf=&quot;descripcioControl?.hasError(&#39;required&#39;)&quot;&gt;
Descripció obligatòria per Backend.
&lt;/p&gt;
&lt;p *ngIf=&quot;descripcioControl?.hasError(&#39;minlength&#39;)&quot;&gt;
Cal almenys 20 caràcters.
&lt;/p&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<h4>1.2.5. Comparativa visual</h4>
<table>
<thead>
<tr>
<th>Aspecte</th>
<th>Template-driven</th>
<th>Reactius</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Definició</strong></td>
<td>HTML (directives <code>ngModel</code>)</td>
<td>TypeScript (<code>FormGroup</code>, <code>FormControl</code>)</td>
</tr>
<tr>
<td><strong>Validacions</strong></td>
<td>Directives HTML (<code>required</code>, <code>minlength</code>)</td>
<td>Validators programàtics (<code>Validators.required</code>)</td>
</tr>
<tr>
<td><strong>Validacions dinàmiques</strong></td>
<td>Difícil (lògica al template amb <code>*ngIf</code>)</td>
<td>Fàcil (<code>.setValidators()</code> programàtic)</td>
</tr>
<tr>
<td><strong>Testing</strong></td>
<td>Requereix DOM complet</td>
<td>Tests unitaris purs sense DOM</td>
</tr>
<tr>
<td><strong>Temps test</strong></td>
<td>100-300ms per test</td>
<td>5-10ms per test</td>
</tr>
<tr>
<td><strong>Reutilització</strong></td>
<td>Baixa (duplicar HTML)</td>
<td>Alta (funcions retornant FormGroup)</td>
</tr>
<tr>
<td><strong>Control programàtic</strong></td>
<td>Limitat (<code>@ViewChild</code>, esdeveniments)</td>
<td>Total (API completa <code>.disable()</code>, <code>.setValue()</code>)</td>
</tr>
<tr>
<td><strong>Complexitat inicial</strong></td>
<td>Baixa (casos simples)</td>
<td>Mitjana (configuració TypeScript)</td>
</tr>
<tr>
<td><strong>Escalabilitat</strong></td>
<td>Difícil (formularis complexos)</td>
<td>Excel·lent (estructura clara)</td>
</tr>
<tr>
<td><strong>Accessibilitat a dades</strong></td>
<td>Via <code>ngModel</code> (bidireccional)</td>
<td>Via <code>.value</code> (unidireccional)</td>
</tr>
<tr>
<td><strong>Subscripció a canvis</strong></td>
<td>Complexa (<code>@ViewChild</code> + events)</td>
<td>Nativa (<code>.valueChanges</code> observable)</td>
</tr>
</tbody>
</table>
<h4>1.2.6. Conceptes clau</h4>
<table>
<thead>
<tr>
<th>Concepte</th>
<th>Definició</th>
<th>Sintaxi</th>
<th>Quan usar</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>FormGroup</strong></td>
<td>Contenidor de FormControls relacionats</td>
<td><code>fb.group({ camp: [...] })</code></td>
<td>Agrupar camps d'un formulari</td>
</tr>
<tr>
<td><strong>FormControl</strong></td>
<td>Control individual amb valor i validadors</td>
<td><code>new FormControl('', Validators.required)</code></td>
<td>Crear camp únic</td>
</tr>
<tr>
<td><strong>FormBuilder</strong></td>
<td>Servei per crear FormGroups amb sintaxi simplificada</td>
<td><code>fb.group(...)</code></td>
<td>Simplificar creació de formularis</td>
</tr>
<tr>
<td><strong>Validators</strong></td>
<td>Classe amb validadors integrats</td>
<td><code>Validators.required</code>, <code>Validators.email</code></td>
<td>Aplicar validacions comunes</td>
</tr>
<tr>
<td><strong>valueChanges</strong></td>
<td>Observable que emet cada canvi de valor</td>
<td><code>control.valueChanges.subscribe(...)</code></td>
<td>Reaccionar a canvis de camps</td>
</tr>
<tr>
<td><strong>statusChanges</strong></td>
<td>Observable que emet cada canvi d'estat</td>
<td><code>control.statusChanges.subscribe(...)</code></td>
<td>Reaccionar a canvis de validació</td>
</tr>
</tbody>
</table>
<h4>1.2.7. Quan usar cada enfocament</h4>
<p><strong><i class="bi bi-check-circle" aria-hidden="true"></i> Usar template-driven quan:</strong></p>
<ul>
<li>Formulari molt simple (3-5 camps, validacions bàsiques)</li>
<li>Aplicació petita sense requisits de testing</li>
<li>Equip poc familiaritzat amb programació reactiva</li>
<li>Prototipatge ràpid sense manteniment a llarg termini</li>
</ul>
<p><strong><i class="bi bi-check-circle" aria-hidden="true"></i> Usar reactius quan:</strong></p>
<ul>
<li>Formulari complex (10+ camps, validacions interdependents)</li>
<li>Validacions dinàmiques (camps canvien segons altres camps)</li>
<li>Testing prioritari (tests unitaris ràpids)</li>
<li>Formularis reutilitzables entre múltiples components</li>
<li>Integració amb APIs asíncrones (autocompletar, validacions remotes)</li>
<li>Aplicació escalable amb manteniment a llarg termini</li>
</ul>
<p><strong>Recomanació general:</strong> Per aplicacions professionals, usar formularis reactius per defecte. Template-driven només per casos molt simples on el desenvolupament ràpid és prioritari sobre mantenibilitat.</p>
<h4>1.2.8. Característiques principals</h4>
<p><strong>Control programàtic</strong></p>
<p>Accés complet a l'estat del formulari des de TypeScript: <code>.valid</code>, <code>.invalid</code>, <code>.touched</code>, <code>.dirty</code>, <code>.pristine</code>. Modificació de valors: <code>.setValue()</code>, <code>.patchValue()</code>. Gestió de validadors: <code>.setValidators()</code>, <code>.clearValidators()</code>.</p>
<p><strong>Reactivitat amb observables</strong></p>
<p><code>.valueChanges</code> emet cada cop que canvia el valor. <code>.statusChanges</code> emet quan canvia l'estat de validació. Subscriure's permet implementar lògica reactiva complexa (autoguardat, validacions asíncrones, actualitzacions en cascada).</p>
<p><strong>Composició de formularis</strong></p>
<p>FormGroup pot contenir altres FormGroups (formularis niuats). FormArray permet llistes dinàmiques de controls. Estructura jeràrquica per formularis complexos.</p>
<p><strong>Validació explícita</strong></p>
<p>Validadors aplicats a la creació del control. Validacions sincronitzades (Validators.required) i asíncrones (validar amb API). Missatges d'error accessibles via <code>.hasError('validador')</code>.</p>
<h4>1.2.9. Integració amb el flux de treball</h4>
<p>Els formularis reactius s'integren amb:</p>
<ul>
<li><strong>Signals:</strong> Combinar FormGroup amb signals per reactivitat optimitzada</li>
<li><strong>Services:</strong> Carregar/guardar dades de formularis via serveis HTTP</li>
<li><strong>Routing:</strong> Resolvers per precarregar dades abans de mostrar formulari</li>
<li><strong>RxJS:</strong> Operadors per transformar, filtrar i combinar streams de dades</li>
</ul>
<p>En les pròximes lectures aprendreu:</p>
<ul>
<li>Validacions personalitzades (custom validators)</li>
<li>Validacions asíncrones (comprovar API)</li>
<li>FormArray per llistes dinàmiques</li>
<li>Formularis niuats complexos</li>
</ul>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.3. Model mental</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.3.1. Flux de formulari reactiu</h4>

<div class="code-block" data-lang="text" role="region" aria-label="Bloc de codi text">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-text">Component TypeScript
  ↓ FormBuilder.group()
FormGroup creat en memòria
  ↓ conté FormControls
Validadors aplicats a cada control
  ↓ [formGroup]=&quot;formulari&quot;
Template HTML vinculat
  ↓ formControlName=&quot;camp&quot;
Input de l&#39;usuari
  ↓ .valueChanges observable
Subscripció reactiva (opcional)
  ↓ Validators executats
Estat del formulari actualitzat
  ↓ .valid / .invalid
Change detection Angular
  ↓ 
DOM actualitzat</code></pre>
  </div>
</div>

<h4>1.3.2. Estructura jeràrquica</h4>

<div class="code-block" data-lang="text" role="region" aria-label="Bloc de codi text">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-text">FormGroup (formulari)
  ├── FormControl (titol) + [Validators.required, Validators.minLength(4)]
  ├── FormControl (categoria) + [Validators.required]
  ├── FormControl (valoracio) + [Validators.min(0), Validators.max(5)]
  └── FormControl (descripcio) + [Validators.maxLength(200)]</code></pre>
  </div>
</div>

<p><strong>Regla mnemotècnica:</strong></p>
<ul>
<li>FormGroup = Contenidor d'objecte <code>{ titol: '...', categoria: '...' }</code></li>
<li>FormControl = Propietat individual amb validadors</li>
<li>FormBuilder = Factoria per crear FormGroups amb sintaxi curta</li>
</ul>
<h4>1.3.3. Relació TypeScript ↔ Template</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">this.formulari = this.fb.group({
  titol: [&#39;&#39;, Validators.required]
});</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;form [formGroup]=&quot;formulari&quot;&gt;
&lt;input formControlName=&quot;titol&quot;&gt;
&lt;/form&gt;</code></pre>
  </div>
</div>

<h4>1.3.4. Analogia útil</h4>
<p><strong>Formulari reactiu = Full de càlcul programable</strong></p>
<ul>
<li>FormGroup = Full amb múltiples cel·les</li>
<li>FormControl = Cel·la individual amb valor i fórmules (validadors)</li>
<li>Validators = Regles de validació de dades (> 0, text obligatori)</li>
<li>.valueChanges = Event que es dispara quan canvia una cel·la</li>
<li>.valid / .invalid = Estat global del full (totes fórmules complides?)</li>
</ul>
<p><strong>Error comú a evitar:</strong></p>
<p><i class="bi bi-x-circle" aria-hidden="true"></i> Pensar que FormControl és com ngModel (bidireccional)</p>
<p><i class="bi bi-check-circle" aria-hidden="true"></i> FormControl és unidireccional: TypeScript → Template</p>
<p><strong>Per què unidireccional?</strong></p>
<p>Template NO pot modificar FormControl directament. Usuari escriu input → Angular actualitza FormControl → Change detection → Template mostra valor actualitzat. Flux controlat i predictible.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.4. Formularis template-driven vs reactius: comparativa</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.4.1. Objectiu</h4>
<p>Entendre les diferències fonamentals entre els dos enfocaments i decidir quan usar cada un.</p>
<h4>1.4.2. Template-driven</h4>
<ul>
<li>Configuració basada en directives HTML: <code>[(ngModel)]</code>, <code>required</code>, <code>minlength</code></li>
<li>Lògica de validació al template amb <code>*ngIf</code> i variables de plantilla</li>
<li>Adequat per formularis simples amb validacions estàtiques</li>
<li>Menys codi TypeScript, més codi HTML</li>
</ul>
<p><strong>Exemple template-driven:</strong></p>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;form #f=&quot;ngForm&quot;&gt;
&lt;input name=&quot;titol&quot; [(ngModel)]=&quot;titol&quot; required minlength=&quot;4&quot;&gt;
&lt;div *ngIf=&quot;f.controls[&#39;titol&#39;]?.invalid&quot;&gt;Error&lt;/div&gt;
&lt;/form&gt;</code></pre>
  </div>
</div>

<h4>1.4.3. Reactius</h4>
<ul>
<li>Configuració basada en codi TypeScript: <code>FormGroup</code>, <code>FormControl</code>, <code>Validators</code></li>
<li>Lògica de validació al component amb API programàtica</li>
<li>Adequat per formularis complexos amb validacions dinàmiques</li>
<li>Més codi TypeScript, menys codi HTML</li>
</ul>
<p><strong>Exemple reactiu:</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  titol: [&#39;&#39;, [Validators.required, Validators.minLength(4)]]
});</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;form [formGroup]=&quot;formulari&quot;&gt;
&lt;input formControlName=&quot;titol&quot;&gt;
&lt;div *ngIf=&quot;formulari.get(&#39;titol&#39;)?.invalid&quot;&gt;Error&lt;/div&gt;
&lt;/form&gt;</code></pre>
  </div>
</div>

<h4>1.4.4. Criteri de decisió</h4>
<ul>
<li>Formulari &lt; 5 camps, validacions estàtiques → Template-driven</li>
<li>Formulari &gt; 5 camps, validacions dinàmiques → Reactius</li>
<li>Aplicació professional amb testing → Reactius</li>
<li>Prototipatge ràpid → Template-driven</li>
</ul>
<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Template-driven = simplicitat per casos bàsics. Reactius = control i escalabilitat per casos complexos.
</div>

<h4>1.4.5. Resultat esperat</h4>
<p>Compreneu quan usar cada enfocament segons els requisits del projecte.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.5. Crear FormGroup i FormControls bàsics</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.5.1. Objectiu</h4>
<p>Aprendre a crear formularis reactius manualment amb <code>FormGroup</code> i <code>FormControl</code>.</p>
<h4>1.5.2. Sintaxi bàsica sense FormBuilder</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { FormGroup, FormControl, Validators } from &#39;@angular/forms&#39;;
export class FormulariComponent {
  formulari = new FormGroup({
    titol: new FormControl(&#39;&#39;, Validators.required),
    categoria: new FormControl(&#39;UI&#39;),
    valoracio: new FormControl(0, [Validators.min(0), Validators.max(5)])
  });
}</code></pre>
  </div>
</div>

<p><strong>Estructura:</strong></p>
<ul>
<li><code>FormGroup</code>: contenidor de múltiples FormControls</li>
<li><code>FormControl(valorInicial, validadors)</code>: control individual</li>
<li>Validadors: poden ser un únic validador o array de validadors</li>
</ul>
<h4>1.5.3. Accés a controls</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">const titolControl = this.formulari.get(&#39;titol&#39;);
if (titolControl?.invalid) {
  console.log(&#39;Títol invàlid&#39;);
}
if (titolControl?.hasError(&#39;required&#39;)) {
  console.log(&#39;Títol obligatori&#39;);
}
const valorTitol = titolControl?.value;</code></pre>
  </div>
</div>

<h4>1.5.4. Modificar valors</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">this.formulari.setValue({
  titol: &#39;Nou element&#39;,
  categoria: &#39;Backend&#39;,
  valoracio: 4
});
this.formulari.patchValue({
  titol: &#39;Títol modificat&#39;
});
this.formulari.get(&#39;titol&#39;)?.setValue(&#39;Altre títol&#39;);</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> FormGroup agrupa FormControls. Accediu a controls amb <code>.get('nom')</code> per comprovar estat i modificar valors.
</div>

<h4>1.5.5. Resultat esperat</h4>
<p>Sabeu crear FormGroup manualment i accedir a controls individualment.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.6. Configurar FormBuilder per simplificar creació</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.6.1. Objectiu</h4>
<p>Usar FormBuilder per crear formularis amb sintaxi més concisa i llegible.</p>
<h4>1.6.2. FormBuilder vs creació manual</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = new FormGroup({
  titol: new FormControl(&#39;&#39;, [Validators.required, Validators.minLength(4)]),
  categoria: new FormControl(&#39;&#39;, Validators.required),
  valoracio: new FormControl(0, [Validators.min(0), Validators.max(5)])
});
formulari = this.fb.group({
  titol: [&#39;&#39;, [Validators.required, Validators.minLength(4)]],
  categoria: [&#39;&#39;, Validators.required],
  valoracio: [0, [Validators.min(0), Validators.max(5)]]
});</code></pre>
  </div>
</div>

<h4>1.6.3. Injectar FormBuilder</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Component, inject } from &#39;@angular/core&#39;;
import { FormBuilder, Validators } from &#39;@angular/forms&#39;;
export class FormulariComponent {
  private readonly fb = inject(FormBuilder);
  formulari = this.fb.group({
    titol: [&#39;&#39;, Validators.required],
    categoria: [&#39;UI&#39;],
    valoracio: [0]
  });
}</code></pre>
  </div>
</div>

<h4>1.6.4. Sintaxi FormBuilder</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">this.fb.group({
  camp: [valorInicial],
  camp: [valorInicial, validador],
  camp: [valorInicial, [valid1, valid2]],
  camp: [valorInicial, [valid1], [validAsync]]
})</code></pre>
  </div>
</div>

<h4>1.6.5. Formulari complet d'exemple</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  titol: [&#39;&#39;, [Validators.required, Validators.minLength(4), Validators.maxLength(50)]],
  categoria: [&#39;&#39;, Validators.required],
  preu: [0, [Validators.required, Validators.min(0)]],
  descripcio: [&#39;&#39;, Validators.maxLength(200)],
  actiu: [true],
  dataCreacio: [new Date().toISOString().split(&#39;T&#39;)[0]]
});</code></pre>
  </div>
</div>

<p><strong>Avantatges FormBuilder:</strong></p>
<ul>
<li>Sintaxi més curta i llegible</li>
<li>Menys repetició de <code>new FormControl</code></li>
<li>Estàndard de la comunitat Angular</li>
<li>Més fàcil de mantenir</li>
</ul>
<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> FormBuilder simplifica creació de formularis amb sintaxi d'array: <code>[valor, [validadors]]</code>.
</div>

<h4>1.6.6. Resultat esperat</h4>
<p>Preferiu FormBuilder sobre creació manual per codi més net i mantenible.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.7. Aplicar validadors integrats (required, minLength, etc.)</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.7.1. Objectiu</h4>
<p>Dominar els validadors integrats d'Angular i aplicar-los correctament.</p>
<h4>1.7.2. Validadors integrats disponibles</h4>
<table>
<thead>
<tr>
<th>Validador</th>
<th>Descripció</th>
<th>Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Validators.required</code></td>
<td>Camp obligatori</td>
<td><code>['', Validators.required]</code></td>
</tr>
<tr>
<td><code>Validators.minLength(n)</code></td>
<td>Mínim n caràcters</td>
<td><code>['', Validators.minLength(4)]</code></td>
</tr>
<tr>
<td><code>Validators.maxLength(n)</code></td>
<td>Màxim n caràcters</td>
<td><code>['', Validators.maxLength(50)]</code></td>
</tr>
<tr>
<td><code>Validators.min(n)</code></td>
<td>Valor mínim numèric</td>
<td><code>[0, Validators.min(0)]</code></td>
</tr>
<tr>
<td><code>Validators.max(n)</code></td>
<td>Valor màxim numèric</td>
<td><code>[100, Validators.max(100)]</code></td>
</tr>
<tr>
<td><code>Validators.email</code></td>
<td>Format email vàlid</td>
<td><code>['', Validators.email]</code></td>
</tr>
<tr>
<td><code>Validators.pattern(regex)</code></td>
<td>Expressió regular</td>
<td><code>['', Validators.pattern(/^[A-Z]/)]</code></td>
</tr>
</tbody>
</table>
<h4>1.7.3. Aplicar múltiples validadors</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  titol: [&#39;&#39;, [
    Validators.required,
    Validators.minLength(4),
    Validators.maxLength(50),
    Validators.pattern(/^[A-Z]/)
  ]],
  email: [&#39;&#39;, [
    Validators.required,
    Validators.email
  ]],
  telefon: [&#39;&#39;, [
    Validators.required,
    Validators.pattern(/^[0-9]{9}$/)
  ]],
  edat: [0, [
    Validators.required,
    Validators.min(18),
    Validators.max(120)
  ]],
  descripcio: [&#39;&#39;, Validators.maxLength(200)]
});</code></pre>
  </div>
</div>

<h4>1.7.4. Comprovar errors específics</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">const titolControl = this.formulari.get(&#39;titol&#39;);
if (titolControl?.hasError(&#39;required&#39;)) {
  console.log(&#39;Camp obligatori&#39;);
}
if (titolControl?.hasError(&#39;minlength&#39;)) {
  const minLength = titolControl?.errors?.[&#39;minlength&#39;].requiredLength;
  console.log(`Cal almenys ${minLength} caràcters`);
}
if (titolControl?.hasError(&#39;pattern&#39;)) {
  console.log(&#39;Format incorrecte&#39;);
}</code></pre>
  </div>
</div>

<h4>1.7.5. Pattern per casos comuns</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">Validators.pattern(/^[a-zA-ZÀ-ÿ\s]+$/)
Validators.pattern(/^[0-9]+$/)
Validators.pattern(/^[6-9][0-9]{8}$/)
Validators.pattern(/^[0-9]{5}$/)
Validators.pattern(/^https?:\/\/.+/)
Validators.pattern(/^[0-9]{8}[A-Z]$/)</code></pre>
  </div>
</div>

<h4>1.7.6. Validadors opcionals</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">descripcio: [&#39;&#39;, [
  Validators.maxLength(200)
]]
comentari: [&#39;&#39;, [
  Validators.minLength(10)
]]</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Combineu múltiples validadors per assegurar qualitat de dades. Useu <code>.hasError()</code> per missatges específics.
</div>

<h4>1.7.7. Resultat esperat</h4>
<p>Sabeu aplicar validadors integrats i comprovar errors específics per mostrar missatges contextuals.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.8. Vincular formulari a plantilla amb formControlName</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.8.1. Objectiu</h4>
<p>Connectar el FormGroup definit a TypeScript amb la plantilla HTML.</p>
<h4>1.8.2. Estructura bàsica de vinculació</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;form [formGroup]=&quot;formulari&quot; (ngSubmit)=&quot;onSubmit()&quot;&gt;
&lt;label&gt;
Títol
&lt;input type=&quot;text&quot; formControlName=&quot;titol&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Categoria
&lt;select formControlName=&quot;categoria&quot;&gt;
&lt;option value=&quot;&quot;&gt;Selecciona...&lt;/option&gt;
&lt;option value=&quot;UI&quot;&gt;Components UI&lt;/option&gt;
&lt;option value=&quot;Backend&quot;&gt;Backend&lt;/option&gt;
&lt;option value=&quot;Data&quot;&gt;Data Science&lt;/option&gt;
&lt;/select&gt;
&lt;/label&gt;
&lt;label&gt;
Valoració (0-5)
&lt;input type=&quot;number&quot; formControlName=&quot;valoracio&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Descripció
&lt;textarea formControlName=&quot;descripcio&quot; rows=&quot;4&quot;&gt;&lt;/textarea&gt;
&lt;/label&gt;
&lt;button type=&quot;submit&quot; [disabled]=&quot;formulari.invalid&quot;&gt;
Guardar
&lt;/button&gt;
&lt;/form&gt;</code></pre>
  </div>
</div>

<h4>1.8.3. Importar ReactiveFormsModule</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Component, inject } from &#39;@angular/core&#39;;
import { FormBuilder, ReactiveFormsModule, Validators } from &#39;@angular/forms&#39;;
import { CommonModule } from &#39;@angular/common&#39;;
@Component({
  selector: &#39;app-formulari-element&#39;,
  standalone: true,
  imports: [ReactiveFormsModule, CommonModule],
  templateUrl: &#39;./formulari-element.component.html&#39;
})
export class FormulariElementComponent {
  private readonly fb = inject(FormBuilder);
  formulari = this.fb.group({
    titol: [&#39;&#39;, [Validators.required, Validators.minLength(4)]],
    categoria: [&#39;&#39;, Validators.required],
    valoracio: [0, [Validators.min(0), Validators.max(5)]],
    descripcio: [&#39;&#39;, Validators.maxLength(200)]
  });
  onSubmit(): void {
    if (this.formulari.valid) {
      console.log(&#39;Dades del formulari:&#39;, this.formulari.value);
    }
  }
}</code></pre>
  </div>
</div>

<h4>1.8.4. Checkbox i radio buttons</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;label&gt;
&lt;input type=&quot;checkbox&quot; formControlName=&quot;actiu&quot;&gt;
Element actiu
&lt;/label&gt;
&lt;fieldset&gt;
&lt;legend&gt;Prioritat&lt;/legend&gt;
&lt;label&gt;
&lt;input type=&quot;radio&quot; formControlName=&quot;prioritat&quot; value=&quot;baixa&quot;&gt;
Baixa
&lt;/label&gt;
&lt;label&gt;
&lt;input type=&quot;radio&quot; formControlName=&quot;prioritat&quot; value=&quot;mitjana&quot;&gt;
Mitjana
&lt;/label&gt;
&lt;label&gt;
&lt;input type=&quot;radio&quot; formControlName=&quot;prioritat&quot; value=&quot;alta&quot;&gt;
Alta
&lt;/label&gt;
&lt;/fieldset&gt;</code></pre>
  </div>
</div>

<h4>1.8.5. Accedir a estat del formulari al template</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;p&gt;Formulari vàlid: &lt;/p&gt;
&lt;p&gt;Modificat: &lt;/p&gt;
&lt;p&gt;Tocat: &lt;/p&gt;
&lt;pre&gt;&lt;/pre&gt;</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> <code>[formGroup]</code> al <code>&lt;form&gt;</code>, <code>formControlName</code> a cada input. ReactiveFormsModule obligatori a imports.
</div>

<h4>1.8.6. Resultat esperat</h4>
<p>Formulari TypeScript vinculat a template, inputs sincronitzats automàticament.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.9. Mostrar missatges d'error reactius</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.9.1. Objectiu</h4>
<p>Implementar missatges d'error contextuals que es mostrin només quan correspon.</p>
<h4>1.9.2. Patró de missatges d'error</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;label&gt;
Títol
&lt;input type=&quot;text&quot; formControlName=&quot;titol&quot;&gt;
&lt;/label&gt;
&lt;div *ngIf=&quot;formulari.get(&#39;titol&#39;)?.touched &amp;&amp; formulari.get(&#39;titol&#39;)?.invalid&quot; class=&quot;error&quot;&gt;
&lt;p *ngIf=&quot;formulari.get(&#39;titol&#39;)?.hasError(&#39;required&#39;)&quot;&gt;
El títol és obligatori.
&lt;/p&gt;
&lt;p *ngIf=&quot;formulari.get(&#39;titol&#39;)?.hasError(&#39;minlength&#39;)&quot;&gt;
Cal almenys
{{ formulari.get(&#39;titol&#39;)?.errors?.[&#39;minlength&#39;].requiredLength }}
caràcters.
&lt;/p&gt;
&lt;p *ngIf=&quot;formulari.get(&#39;titol&#39;)?.hasError(&#39;maxlength&#39;)&quot;&gt;
Màxim
{{ formulari.get(&#39;titol&#39;)?.errors?.[&#39;maxlength&#39;].requiredLength }}
caràcters.
&lt;/p&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<h4>1.9.3. Simplificar amb getter</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">get titolControl() {
  return this.formulari.get(&#39;titol&#39;);
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div *ngIf=&quot;titolControl?.touched &amp;&amp; titolControl?.invalid&quot; class=&quot;error&quot;&gt;
&lt;p *ngIf=&quot;titolControl?.hasError(&#39;required&#39;)&quot;&gt;
El títol és obligatori.
&lt;/p&gt;
&lt;p *ngIf=&quot;titolControl?.hasError(&#39;minlength&#39;)&quot;&gt;
Cal almenys {{ titolControl?.errors?.[&#39;minlength&#39;].requiredLength }} caràcters.
&lt;/p&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<h4>1.9.4. Estils per missatges d'error</h4>

<div class="code-block" data-lang="scss" role="region" aria-label="Bloc de codi scss">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">SCSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-scss">.error {
  background: #fee;
  border: 1px solid #fcc;
  border-radius: 4px;
  padding: 0.5rem;
  margin-top: 0.25rem;
  p {
    margin: 0.25rem 0;
    color: #c33;
    font-size: 0.875rem;
  }
}
input.ng-touched.ng-invalid,
select.ng-touched.ng-invalid,
textarea.ng-touched.ng-invalid {
  border-color: #c33;
  background: #fff5f5;
}</code></pre>
  </div>
</div>

<h4>1.9.5. Missatges per altres validadors</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div *ngIf=&quot;emailControl?.touched &amp;&amp; emailControl?.invalid&quot; class=&quot;error&quot;&gt;
&lt;p *ngIf=&quot;emailControl?.hasError(&#39;required&#39;)&quot;&gt;
L&#39;email és obligatori.
&lt;/p&gt;
&lt;p *ngIf=&quot;emailControl?.hasError(&#39;email&#39;)&quot;&gt;
Format d&#39;email incorrecte.
&lt;/p&gt;
&lt;/div&gt;
&lt;div *ngIf=&quot;telefonControl?.touched &amp;&amp; telefonControl?.invalid&quot; class=&quot;error&quot;&gt;
&lt;p *ngIf=&quot;telefonControl?.hasError(&#39;required&#39;)&quot;&gt;
El telèfon és obligatori.
&lt;/p&gt;
&lt;p *ngIf=&quot;telefonControl?.hasError(&#39;pattern&#39;)&quot;&gt;
El telèfon ha de tenir 9 dígits.
&lt;/p&gt;
&lt;/div&gt;
&lt;div *ngIf=&quot;edatControl?.touched &amp;&amp; edatControl?.invalid&quot; class=&quot;error&quot;&gt;
&lt;p *ngIf=&quot;edatControl?.hasError(&#39;min&#39;)&quot;&gt;
Edat mínima: {{ edatControl?.errors?.[&#39;min&#39;].min }}.
&lt;/p&gt;
&lt;p *ngIf=&quot;edatControl?.hasError(&#39;max&#39;)&quot;&gt;
Edat màxima: {{ edatControl?.errors?.[&#39;max&#39;].max }}.
&lt;/p&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Condició <code>.touched && .invalid</code> evita mostrar errors abans que l'usuari interactuï. <code>.hasError()</code> per missatges específics.
</div>

<h4>1.9.6. Resultat esperat</h4>
<p>Missatges d'error contextuals que apareixen només quan l'usuari toca el camp i té errors.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.10. Gestionar enviament i accés a valors</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.10.1. Objectiu</h4>
<p>Implementar gestió de l'enviament del formulari i accés a les dades validades.</p>
<h4>1.10.2. Gestió d'enviament bàsica</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">onSubmit(): void {
  if (this.formulari.invalid) {
    console.warn(&#39;Formulari invàlid&#39;);
    return;
  }
  const dades = this.formulari.value;
  console.log(&#39;Dades del formulari:&#39;, dades);
  this.elementService.crearElement(dades).subscribe({
    next: () =&gt; {
      console.log(&#39;Element creat correctament&#39;);
      this.formulari.reset();
    },
    error: (err) =&gt; {
      console.error(&#39;Error en crear element:&#39;, err);
    }
  });
}</code></pre>
  </div>
</div>

<h4>1.10.3. Marcar tots els camps com a tocats</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">onSubmit(): void {
  this.formulari.markAllAsTouched();
  if (this.formulari.invalid) {
    console.warn(&#39;Formulari invàlid. Revisa els camps.&#39;);
    return;
  }
}</code></pre>
  </div>
</div>

<h4>1.10.4. Accedir a valors individuals</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">const titol = this.formulari.get(&#39;titol&#39;)?.value;
const categoria = this.formulari.get(&#39;categoria&#39;)?.value;
console.log(`Títol: ${titol}, Categoria: ${categoria}`);</code></pre>
  </div>
</div>

<h4>1.10.5. Establir valors per defecte o des d'API</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">ngOnInit(): void {
  this.elementService.obtenirElement(this.elementId).subscribe(element =&gt; {
    this.formulari.patchValue({
      titol: element.titol,
      categoria: element.categoria,
      valoracio: element.valoracio,
      descripcio: element.descripcio
    });
  });
}</code></pre>
  </div>
</div>

<h4>1.10.6. Resetear formulari</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">this.formulari.reset();
this.formulari.reset({
  titol: &#39;&#39;,
  categoria: &#39;UI&#39;,
  valoracio: 0,
  descripcio: &#39;&#39;
});</code></pre>
  </div>
</div>

<h4>1.10.7. Deshabilitar formulari durant enviament</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">isEnviant = false;
onSubmit(): void {
  if (this.formulari.invalid) return;
  this.isEnviant = true;
  this.formulari.disable();
  this.elementService.crearElement(this.formulari.value).subscribe({
    next: () =&gt; {
      console.log(&#39;Element creat&#39;);
      this.formulari.enable();
      this.formulari.reset();
      this.isEnviant = false;
    },
    error: (err) =&gt; {
      console.error(&#39;Error:&#39;, err);
      this.formulari.enable();
      this.isEnviant = false;
    }
  });
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;button type=&quot;submit&quot; [disabled]=&quot;formulari.invalid || isEnviant&quot;&gt;
{{ isEnviant ? &#39;Enviant...&#39; : &#39;Guardar&#39; }}
&lt;/button&gt;</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Validar amb <code>.invalid</code> abans d'enviar. Usar <code>.markAllAsTouched()</code> per mostrar tots els errors. <code>.disable()</code> durant enviament.
</div>

<h4>1.10.8. Resultat esperat</h4>
<p>Gestió completa de l'enviament amb validació, feedback visual i gestió d'errors.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.11. Documentar configuració i proves</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.11.1. Objectiu</h4>
<p>Registrar la configuració del formulari i les proves realitzades al dossier tècnic.</p>
<h4>1.11.2. Actualitzar docs/formularis.md</h4>

<div class="code-block" data-lang="markdown" role="region" aria-label="Bloc de codi markdown">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">MARKDOWN</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-markdown">## Formularis reactius
### Configuració
**Component:** `FormulariElementComponent`
**Tipus:** Formulari reactiu amb FormBuilder
### Camps i validacions
| Camp | Tipus | Validacions | Valor per defecte |
|------|-------|-------------|-------------------|
| titol | text | required, minLength(4), maxLength(50) | &#39;&#39; |
| categoria | select | required | &#39;&#39; |
| valoracio | number | required, min(0), max(5) | 0 |
| descripcio | textarea | maxLength(200) | &#39;&#39; |
### Missatges d&#39;error
| Camp | Error | Missatge |
|------|-------|----------|
| titol | required | &quot;El títol és obligatori.&quot; |
| titol | minlength | &quot;Cal almenys 4 caràcters.&quot; |
| titol | maxlength | &quot;Màxim 50 caràcters.&quot; |
| categoria | required | &quot;La categoria és obligatòria.&quot; |
| valoracio | min | &quot;Valoració mínima: 0.&quot; |
| valoracio | max | &quot;Valoració màxima: 5.&quot; |
| descripcio | maxlength | &quot;Màxim 200 caràcters.&quot; |
### Gestió d&#39;enviament
1. Validar formulari amb `.invalid`
2. Marcar camps com a tocats amb `.markAllAsTouched()`
3. Deshabilitar formulari amb `.disable()` durant enviament
4. Enviar dades a `ElementService.crearElement()`
5. Gestionar èxit/error
6. Resetear formulari amb `.reset()` si èxit
### Proves realitzades
- Validació required funciona
- Validació minLength mostra missatge correcte
- Validació min/max per valoració
- Botó submit deshabilitat quan formulari invàlid
- Formulari es reseteja després d&#39;enviar
- Missatges d&#39;error només apareixen després de tocar camps
### Decisions de disseny
**Per què formularis reactius vs template-driven:**
- Validacions dinàmiques necessàries (futur: descripció obligatòria per Backend)
- Testing unitari prioritari
- Reutilització de validadors entre múltiples formularis
- Control programàtic total per integracions futures
**Futures millores:**
- Validacions asíncrones (comprovar títol duplicat a API)
- FormArray per afegir múltiples imatges
- Validadors personalitzats (ex: categoria específica segons regles negoci)</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Documentar camps, validacions, missatges i decisions de disseny facilita manteniment i onboarding.
</div>

<h4>1.11.3. Resultat esperat</h4>
<p>Dossier actualitzat amb especificació completa del formulari reactiu.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.12. Mini exemple pràctic</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.12.1. Objectiu</h4>
<p>Consolidar el flux complet: FormBuilder, validadors, vinculació template, missatges d'error, enviament.</p>
<h4>1.12.2. Passos</h4>
<p><strong>1. Generar component (5'):</strong></p>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">ng generate component components/formulari-element --standalone</code></pre>
  </div>
</div>

<p><strong>2. Configurar FormBuilder (10'):</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Component, inject } from &#39;@angular/core&#39;;
import { FormBuilder, ReactiveFormsModule, Validators } from &#39;@angular/forms&#39;;
import { CommonModule } from &#39;@angular/common&#39;;
@Component({
  selector: &#39;app-formulari-element&#39;,
  standalone: true,
  imports: [ReactiveFormsModule, CommonModule],
  templateUrl: &#39;./formulari-element.component.html&#39;,
  styleUrls: [&#39;./formulari-element.component.scss&#39;]
})
export class FormulariElementComponent {
  private readonly fb = inject(FormBuilder);
  formulari = this.fb.group({
    titol: [&#39;&#39;, [Validators.required, Validators.minLength(4)]],
    categoria: [&#39;&#39;, Validators.required],
    valoracio: [0, [Validators.required, Validators.min(0), Validators.max(5)]],
    descripcio: [&#39;&#39;, Validators.maxLength(200)]
  });
  get titolControl() {
    return this.formulari.get(&#39;titol&#39;);
  }
  onSubmit(): void {
    this.formulari.markAllAsTouched();
    if (this.formulari.invalid) {
      console.warn(&#39;Formulari invàlid&#39;);
      return;
    }
    console.log(&#39;Dades:&#39;, this.formulari.value);
    this.formulari.reset();
  }
}</code></pre>
  </div>
</div>

<p><strong>3. Crear plantilla (15'):</strong></p>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;form [formGroup]=&quot;formulari&quot; (ngSubmit)=&quot;onSubmit()&quot;&gt;
&lt;label&gt;
Títol
&lt;input type=&quot;text&quot; formControlName=&quot;titol&quot;&gt;
&lt;/label&gt;
&lt;div *ngIf=&quot;titolControl?.touched &amp;&amp; titolControl?.invalid&quot; class=&quot;error&quot;&gt;
&lt;p *ngIf=&quot;titolControl?.hasError(&#39;required&#39;)&quot;&gt;El títol és obligatori.&lt;/p&gt;
&lt;p *ngIf=&quot;titolControl?.hasError(&#39;minlength&#39;)&quot;&gt;Cal almenys 4 caràcters.&lt;/p&gt;
&lt;/div&gt;
&lt;label&gt;
Categoria
&lt;select formControlName=&quot;categoria&quot;&gt;
&lt;option value=&quot;&quot;&gt;Selecciona...&lt;/option&gt;
&lt;option value=&quot;UI&quot;&gt;Components UI&lt;/option&gt;
&lt;option value=&quot;Backend&quot;&gt;Backend&lt;/option&gt;
&lt;/select&gt;
&lt;/label&gt;
&lt;label&gt;
Valoració (0-5)
&lt;input type=&quot;number&quot; formControlName=&quot;valoracio&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Descripció
&lt;textarea formControlName=&quot;descripcio&quot;&gt;&lt;/textarea&gt;
&lt;/label&gt;
&lt;button type=&quot;submit&quot; [disabled]=&quot;formulari.invalid&quot;&gt;Guardar&lt;/button&gt;
&lt;/form&gt;</code></pre>
  </div>
</div>

<p><strong>4. Afegir estils (10'):</strong></p>

<div class="code-block" data-lang="scss" role="region" aria-label="Bloc de codi scss">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">SCSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-scss">form {
  max-width: 600px;
  margin: 2rem auto;
  padding: 2rem;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
label {
  display: block;
  margin-bottom: 1rem;
  font-weight: 500;
  input, select, textarea {
    display: block;
    width: 100%;
    margin-top: 0.25rem;
    padding: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-family: inherit;
    &amp;.ng-touched.ng-invalid {
      border-color: #c33;
      background: #fff5f5;
    }
  }
}
.error {
  background: #fee;
  border: 1px solid #fcc;
  padding: 0.5rem;
  border-radius: 4px;
  margin-top: 0.25rem;
  p {
    margin: 0.25rem 0;
    color: #c33;
    font-size: 0.875rem;
  }
}
button[type=&quot;submit&quot;] {
  padding: 0.75rem 2rem;
  background: #3498db;
  color: white;
  border: none;
  border-radius: 4px;
  font-weight: 500;
  cursor: pointer;
  &amp;:hover:not(:disabled) {
    background: #2980b9;
  }
  &amp;:disabled {
    background: #bbb;
    cursor: not-allowed;
  }
}</code></pre>
  </div>
</div>

<p><strong>5. Provar funcionalitat (10'):</strong></p>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">ng serve --port 4300</code></pre>
  </div>
</div>

<p><strong>6. Documentar (10'):</strong></p>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Actualitzar docs/formularis.md amb configuració
# Afegir taula de camps i validacions
# Registrar proves realitzades</code></pre>
  </div>
</div>

<p><strong>7. Executar tests (5'):</strong></p>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">npm run lint
npm run test -- --watch=false</code></pre>
  </div>
</div>

<h4>1.12.3. Resultat esperat</h4>
<p>Formulari reactiu complet funcional amb validacions, missatges d'error contextuals, gestió d'enviament i documentació actualitzada.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.13. Resolució de problemes (Win/macOS/Linux)</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>1.13.1. Taula de resolució</h4>
<table>
<thead>
<tr>
<th>Símptoma</th>
<th>Solució Windows</th>
<th>Solució macOS/Linux</th>
</tr>
</thead>
<tbody>
<tr>
<td>Formulari sempre invàlid</td>
<td>Comprovar amb <code>console.log(formulari.value, formulari.errors)</code></td>
<td>Comprovar amb <code>console.log(formulari.value, formulari.errors)</code></td>
</tr>
<tr>
<td>Missatges d'error no apareixen</td>
<td>Verificar sintaxi: <code>control?.touched && control?.invalid</code></td>
<td>Verificar sintaxi: <code>control?.touched && control?.invalid</code></td>
</tr>
<tr>
<td>Inputs no responen</td>
<td>Afegir <code>imports: [ReactiveFormsModule]</code> al component</td>
<td>Afegir <code>imports: [ReactiveFormsModule]</code> al component</td>
</tr>
<tr>
<td><code>.value</code> retorna undefined</td>
<td>Verificar nom exacte a FormGroup i formControlName</td>
<td>Verificar nom exacte a FormGroup i formControlName</td>
</tr>
<tr>
<td>Botó submit no es deshabilita</td>
<td>Usar <code>[disabled]="formulari.invalid"</code></td>
<td>Usar <code>[disabled]="formulari.invalid"</code></td>
</tr>
<tr>
<td><code>Cannot find module '@angular/forms'</code></td>
<td><code>npm install @angular/forms --save</code></td>
<td><code>npm install @angular/forms --save</code></td>
</tr>
<tr>
<td><code>FormBuilder is not defined</code></td>
<td><code>import { FormBuilder } from '@angular/forms';</code></td>
<td><code>import { FormBuilder } from '@angular/forms';</code></td>
</tr>
<tr>
<td><code>Can't bind to 'formGroup'</code></td>
<td>Afegir a <code>imports: [ReactiveFormsModule]</code></td>
<td>Afegir a <code>imports: [ReactiveFormsModule]</code></td>
</tr>
<tr>
<td><code>No provider for FormBuilder</code></td>
<td><code>private fb = inject(FormBuilder)</code> o constructor</td>
<td><code>private fb = inject(FormBuilder)</code> o constructor</td>
</tr>
<tr>
<td><code>formControlName must be used with parent formGroup</code></td>
<td>Assegurar <code>&lt;form [formGroup]="formulari"&gt;</code> envolta inputs</td>
<td>Assegurar <code>&lt;form [formGroup]="formulari"&gt;</code> envolta inputs</td>
</tr>
</tbody>
</table>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.14. Prompts d'IA</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Expert en formularis Angular. <strong>Context:</strong> Estic aprenent a usar formularis reactius per primera vegada. <strong>Tasca:</strong> Compara en 5 punts clau formularis template-driven i formularis reactius a Angular, incloent casos d'ús recomanats per cada enfocament amb exemples concrets. <strong>Format:</strong> Taula comparativa amb columnes: Característica, Template-driven, Reactius, Quan usar cadascun.</div>
  </div>
</div>

<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Dissenyador de formularis Angular. <strong>Context:</strong> Necessito crear un formulari d'usuari complet amb validacions. <strong>Tasca:</strong> Genera una taula amb camps típics d'un formulari d'usuari (nom, email, telèfon, adreça completa) amb validacions Angular adequades i missatges d'error contextuals en català per cada cas d'error possible. <strong>Format:</strong> Taula amb columnes: Camp, Validacions aplicades, Missatge d'error per cada validador.</div>
  </div>
</div>

<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Arquitecte de validacions dinàmiques. <strong>Context:</strong> Estic implementant un formulari on alguns camps canvien de validacions segons el valor d'altres camps. <strong>Tasca:</strong> Explica detalladament amb codi complet com implementar validació dinàmica: si el camp 'tipus' és 'empresa', el camp 'NIF' passa a ser obligatori amb pattern específic; si és 'particular', el 'DNI' és obligatori. Inclou gestió amb valueChanges i setValidators. <strong>Format:</strong> Exemple de codi TypeScript comentat pas a pas.</div>
  </div>
</div>

<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Expert en FormBuilder. <strong>Context:</strong> Necessito veure un exemple complet i realista de formulari reactiu. <strong>Tasca:</strong> Crea un exemple complet de FormBuilder amb 8 camps diferents utilitzant TOTS els validadors integrats disponibles (required, email, pattern, min, max, minLength, maxLength) aplicats de manera realista. Inclou camp text, email, telèfon, edat, descripció, checkbox, radio i select. <strong>Format:</strong> Codi TypeScript amb comentaris explicatius per cada validador.</div>
  </div>
</div>

<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Especialista en UX de formularis. <strong>Context:</strong> Vull implementar la millor experiència d'usuari en l'enviament de formularis reactius. <strong>Tasca:</strong> Descriu tres estratègies diferents per gestionar l'enviament de formularis reactius: 1) Validació prèvia amb markAllAsTouched, 2) Deshabilitar formulari durant enviament amb disable/enable, i 3) Feedback visual d'errors progressiu. Per cada estratègia proporciona codi complet, avantatges, inconvenients i millors pràctiques. <strong>Format:</strong> Guia amb seccions separades per cada estratègia amb exemples de codi.</div>
  </div>
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.15. Autoavaluació</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>Conceptes teòrics</h4>
<!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Comprenc la diferència entre formularis template-driven i reactius</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Entenc el paper de FormGroup, FormControl i FormBuilder</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé quan usar validadors síncrons vs asíncrons</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Comprenc el flux unidireccional TypeScript → Template</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>

<h4>Habilitats pràctiques</h4>

<!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc crear FormGroup manualment amb new FormGroup()</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé usar FormBuilder per sintaxi simplificada fb.group({})</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc aplicar múltiples validadors integrats a un FormControl</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé vincular FormGroup a template amb [formGroup] i formControlName</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc crear getters per simplificar accés a controls des del template</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé mostrar missatges d'error contextuals amb .hasError()</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc gestionar enviament amb validació prèvia i markAllAsTouched()</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé deshabilitar/habilitar formularis durant enviament amb disable/enable</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>

<h4>Resolució de problemes</h4>
<!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé diagnosticar per què un formulari està sempre invàlid</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc solucionar errors d'importació de ReactiveFormsModule</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Entenc com depurar validacions que no funcionen correctament</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.16. Síntesi</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<p>
Disposeu d'un formulari reactiu completament funcional amb control programàtic des de TypeScript, validacions integrades i missatges d'error contextuals que milloren l'experiència d'usuari. El projecte inclou FormBuilder configurat amb servei injectat per crear formularis amb sintaxi concisa reduint codi repetitiu i millorant llegibilitat, validadors integrats aplicats combinant múltiples validadors (required, minLength, maxLength, min, max) per assegurar qualitat de dades abans d'enviar, vinculació template reactiva amb plantilla HTML connectada a FormGroup mitjançant [formGroup] i formControlName amb sincronització automàtica bidireccional, missatges d'error contextuals proporcionant feedback visual només quan l'usuari ha tocat els camps (.touched) amb missatges específics segons tipus d'error (.hasError), gestió d'enviament robusta amb validació prèvia (.invalid), marcar camps (.markAllAsTouched) i deshabilitar durant enviament (.disable), i documentació completa amb taula de camps amb validacions i missatges, decisions de disseny registrades i comparativa template-driven vs reactius documentada. La base de formularis reactius establerta serveix com a fonament per funcionalitats avançades a la Lectura 3.3.2 incloent validacions personalitzades (custom validators), validacions asíncrones (consultar API), validacions dinàmiques avançades i FormArray per llistes dinàmiques.
</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">1.17. Repàs de conceptes</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>FormGroup:</strong> Contenidor de múltiples FormControls relacionats que agrupa camps d'un formulari amb sintaxi <code>fb.group({ camp: [...] })</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>FormControl:</strong> Control individual amb valor i validadors que representa un camp únic del formulari amb sintaxi <code>new FormControl('', Validators.required)</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>FormBuilder:</strong> Servei per crear FormGroups amb sintaxi simplificada <code>fb.group(...)</code> reduint repetició de codi.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>Validators:</strong> Classe amb validadors integrats (required, minLength, maxLength, min, max, email, pattern) per aplicar validacions comunes.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>valueChanges:</strong> Observable que emet cada canvi de valor d'un control amb sintaxi <code>control.valueChanges.subscribe(...)</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>statusChanges:</strong> Observable que emet cada canvi d'estat de validació amb sintaxi <code>control.statusChanges.subscribe(...)</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>[formGroup]:</strong> Directiva per vincular FormGroup al <code>&lt;form&gt;</code> al template HTML.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>formControlName:</strong> Directiva per vincular input a un FormControl específic dins del FormGroup.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>ReactiveFormsModule:</strong> Mòdul Angular obligatori per usar formularis reactius que s'ha d'importar al component standalone.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.touched:</strong> Propietat booleana que indica si l'usuari ha tocat (focus + blur) el camp del formulari.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.invalid:</strong> Propietat booleana que indica si el camp no compleix les validacions aplicades.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.hasError():</strong> Mètode per comprovar error específic amb sintaxi <code>control?.hasError('required')</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.setValue():</strong> Mètode per establir TOTS els valors del formulari requerint objecte complet.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.patchValue():</strong> Mètode per establir valors PARCIALS del formulari permetent actualitzar només alguns camps.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.reset():</strong> Mètode per resetear formulari a valors inicials netejant dades i estat de validació.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.markAllAsTouched():</strong> Mètode per marcar tots els controls com a tocats mostrant tots els missatges d'error de validació.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.disable():</strong> Mètode per deshabilitar tots els camps del formulari impedint edició de l'usuari.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.enable():</strong> Mètode per habilitar tots els camps del formulari permetent edició de l'usuari després de disable.</p>
  </div>
</div>

  
  </div>
</div>

</div>

<!-- SECCIÓ 2: Validacions personalitzades i asíncrones -->
<div class="section" id="Unitat3_Bloc3_Seccio2">
  <h2 id="Unitat3_Bloc3_Seccio2">2. Validacions personalitzades i asíncrones</h2>

  <!-- MULTIMÈDIA -->
  <!--
  ════════════════════════════════════════════════════════════════
  Component: Enllaços multimèdia YouTube
  ════════════════════════════════════════════════════════════════

  Paràmetres:
    - unitat: número de la unitat (1-4)
    - bloc: número del bloc (1-4)
    - seccio: número de la secció (1-3)

  Exemple d'ús:
    {% include multimedia-youtube.html unitat=1 bloc=1 seccio=1 %}

  El component busca automàticament les URLs corresponents a
  site.data.multimedia i mostra els botons de vídeo i àudio.
  ════════════════════════════════════════════════════════════════
-->





  
  
  
  
  

  

  

  
<div class="multimedia-resources">
  <div class="multimedia-header">
    <i class="bi bi-play-circle-fill"></i>
    <span>Contingut multimèdia d'aquesta lectura</span>
  </div>

  <div class="multimedia-buttons">
    
    <a href="https://www.youtube.com/watch?v=B8i7XE5FeCs" target="_blank" rel="noopener noreferrer" class="multimedia-btn video-btn" title="Lectura 3.3.2 · Validacions personalitzades i asíncrones">
      <i class="bi bi-youtube"></i>
      <span>Veure vídeo</span>
      <i class="bi bi-box-arrow-up-right"></i>
    </a>
    

    
    <a href="https://www.youtube.com/watch?v=BA8JGTByNDw" target="_blank" rel="noopener noreferrer" class="multimedia-btn audio-btn" title="[Audio] Lectura 3.3.2 · Validacions personalitzades i asíncrones">
      <i class="bi bi-mic-fill"></i>
      <span>Escoltar àudio</span>
      <i class="bi bi-box-arrow-up-right"></i>
    </a>
    
  </div>

  
  
</div>
  




  <!-- Component: Objectius del bloc/unitat -->



<div class="objectius-box">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-bullseye" aria-hidden="true"></i> Objectius</div>
  <div class="component-content">
    <ul>
      
        <li>Crear validadors personalitzats síncrons per implementar regles de negoci específiques que els validadors integrats no cobreixen (formats interns, dependències entre camps, rangs personalitzats)</li>
      
        <li>Implementar validacions asíncrones que consulten fonts externes (APIs, bases de dades mock) amb indicadors visuals de validació en curs per millorar l'experiència d'usuari</li>
      
        <li>Organitzar validadors en fitxers reutilitzables amb nomenclatura consistent, documentant la política de validació per facilitar manteniment i escalabilitat</li>
      
    </ul>
  </div>
  <!-- IMPORTANT: també es pot usar via front matter: page.objectius (array) -->
</div>



  <!-- Component: Caixa informativa -->
<div class="info-box" role="note">
    <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-info-circle" aria-hidden="true"></i> Informació</div>
    <strong>RA3 · Criteri 1</strong> — Defineix models de dades i estructures adequades al cas d'ús.
    
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.1. Prerequisits</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<p>Abans de començar, necessiteu:</p>
<ul>
<li><strong>Lectura 3.3.1 completa:</strong> Formulari reactiu amb <code>FormBuilder</code>, validadors integrats (<code>required</code>, <code>minLength</code>, etc.) i missatges d'error contextuals funcionals</li>
<li><strong>json-server instal·lat globalment:</strong> Per crear API mock de validació asíncrona</li>
<li><strong>API mock configurada:</strong> Fitxer <code>tools/api/cataleg.json</code> amb dades de prova</li>
<li><strong>Projecte actualitzat:</strong> <code>cataleg-elements</code> amb <code>git status</code> net</li>
<li><strong>VS Code obert:</strong> Terminal integrada disponible per executar múltiples servidors</li>
</ul>
<p><strong>Verificació ràpida:</strong></p>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">cd ~/workspace/cataleg-elements
json-server --version
# Si no està instal·lat
npm install -g json-server
# Crear estructura API mock
mkdir -p tools/api</code></pre>
  </div>
</div>

<p><strong>Crear fitxer de dades mock:</strong></p>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">cat &gt; tools/api/cataleg.json &lt;&lt; &#39;EOF&#39;
{
  &quot;codisExistents&quot;: [
    &quot;CAT-2024-001&quot;,
    &quot;CAT-2024-002&quot;,
    &quot;CAT-2024-003&quot;
  ],
  &quot;usuarisExistents&quot;: [
    &quot;admin&quot;,
    &quot;editor&quot;,
    &quot;viewer&quot;
  ]
}
EOF</code></pre>
  </div>
</div>

<p><strong>Executar ambdós servidors:</strong></p>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Terminal 1: Angular
ng serve --port 4300
# Terminal 2: json-server
json-server --watch tools/api/cataleg.json --port 4301</code></pre>
  </div>
</div>

<p><strong>Punt d'autocomprovació:</strong> Ambdós servidors operatius, formulari base accessible a http://localhost:4300, API mock a http://localhost:4301/codisExistents.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.2. Marc conceptual</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>2.2.1. Què són les validacions personalitzades</h4>
<p>Les <strong>validacions personalitzades</strong> són funcions pures que implementen regles de negoci específiques no cobertes pels validadors integrats d'Angular. Mentre <code>Validators.required</code> o <code>Validators.email</code> cobreixen casos generals, les validacions personalitzades permeten implementar formats interns de l'empresa, dependències complexes entre camps o comprovacions contra fonts externes.</p>
<p><strong>Diferència clau:</strong></p>
<ul>
<li><strong>Validadors integrats:</strong> Regles genèriques reutilitzables entre projectes (<code>email</code>, <code>minLength</code>)</li>
<li><strong>Validadors personalitzats:</strong> Regles específiques del domini (<code>codiInternValid</code>, <code>dataFinPosteriorDataInici</code>)</li>
</ul>
<h4>2.2.2. Problema sense validacions personalitzades</h4>
<p>Els validadors integrats són suficients per casos estàndard, però fallen quan hi ha requisits específics del projecte.</p>
<p><strong>Situació sense validadors personalitzats:</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// component.ts - Intentant validar format intern &quot;CAT-YYYY-NNN&quot;
formulari = this.fb.group({
  codi: [&#39;&#39;, [
    Validators.required,
    Validators.pattern(/^CAT-\d{4}-\d{3}$/)  // Patró complex i poc llegible
  ]],
  dataInici: [&#39;&#39;, Validators.required],
  dataFi: [&#39;&#39;, Validators.required]
  // NO podem validar que dataFi &gt; dataInici amb validadors integrats
});
onSubmit(): void {
  // Validació manual al submit - tard i fràgil
  const inici = new Date(this.formulari.get(&#39;dataInici&#39;)?.value);
  const fi = new Date(this.formulari.get(&#39;dataFi&#39;)?.value);
  if (fi &lt;= inici) {
    alert(&#39;Data fi ha de ser posterior a data inici&#39;);
    return;
  }
  // Aquesta validació no es mostra als missatges d&#39;error del formulari
  // No es pot reutilitzar en altres formularis
  // Testing difícil (acoblat al component)
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div *ngIf=&quot;formulari.get(&#39;codi&#39;)?.hasError(&#39;pattern&#39;)&quot;&gt;
  Format incorrecte.
&lt;/div&gt;
&lt;!-- No hi ha validació reactiva per dates --&gt;
&lt;!-- L&#39;usuari omple tot el formulari i descobreix l&#39;error al final --&gt;</code></pre>
  </div>
</div>

<p><strong>Problemes que genera:</strong></p>
<p><strong>1. Validacions de negoci impossibles amb integrats</strong></p>
<p>Regles com "El camp 'pressupost' ha de ser múltiple de 100" o "El camp 'email' ha de tenir domini '@empresa.com'" no tenen validador integrat equivalent. Cal implementar lògica manual al component, dispersant validacions entre TypeScript i template. Codi difícil de mantenir quan teniu 20+ camps amb regles específiques.</p>
<p><strong>2. Dependències entre camps no validables</strong></p>
<p>Validar que "dataFi > dataInici" o "Si tipus='empresa', NIF obligatori" requereix accés a múltiples controls. Validadors integrats només veuen un FormControl. Implementar validacions manuals al <code>onSubmit()</code> genera experiència d'usuari deficient: l'usuari omple tot el formulari, clica submit i llavors descobreix errors. Frustrant i ineficient.</p>
<p><strong>3. Validacions contra API impossibles</strong></p>
<p>Comprovar si username ja existeix, verificar codi de descompte vàlid o validar IBAN contra base de dades requereix peticions HTTP asíncrones. Validadors integrats són síncrons. Implementar lògica manual amb <code>subscribe()</code> genera codi desorganitzat, subscripcions no gestionades (fuites de memòria) i feedback visual inconsistent.</p>
<p><strong>4. Missatges d'error poc informatius</strong></p>
<p><code>Validators.pattern()</code> retorna error genèric <code>{ pattern: true }</code>. Missatge "Format incorrecte" no ajuda l'usuari. Cal context: "El codi ha de tenir format CAT-YYYY-NNN (exemple: CAT-2024-001)". Sense validadors personalitzats, els missatges són genèrics i poc útils.</p>
<p><strong>5. Reutilització zero entre formularis</strong></p>
<p>Lògica de validació dispersa entre components (<code>.ts</code>), templates (<code>.html</code>) i mètodes (<code>onSubmit()</code>). Voleu el mateix format de codi en 5 formularis diferents? Cal copiar-pegar regex, lògica de validació i missatges. Manteniment caòtic: canviar format requereix modificar 5 components.</p>
<h4>2.2.3. Solució amb validacions personalitzades</h4>
<p>Angular permet crear funcions validators reutilitzables que encapsulen regles de negoci.</p>
<p><strong>Situació amb validadors personalitzats:</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// src/app/validacions/element.validators.ts - Validadors reutilitzables
import { AbstractControl, ValidationErrors, ValidatorFn } from &#39;@angular/forms&#39;;
/**
 * Valida format de codi intern: CAT-YYYY-NNN
 * Exemple vàlid: CAT-2024-001
 */
export function codiInternValid(): ValidatorFn {
  return (control: AbstractControl): ValidationErrors | null =&gt; {
    const valor = String(control.value || &#39;&#39;).trim();
    if (!valor) return null; // Si buit, required s&#39;encarrega
    const pattern = /^CAT-\d{4}-\d{3}$/;
    if (!pattern.test(valor)) {
      return {
        codiInternInvalid: {
          formatEsperat: &#39;CAT-YYYY-NNN&#39;,
          exemple: &#39;CAT-2024-001&#39;,
          valorRebut: valor
        }
      };
    }
    return null;
  };
}
/**
 * Valida que dataFi sigui posterior a dataInici
 * Ús: aplicar a FormGroup, no a FormControl individual
 */
export function dataFiPosteriorDataInici(): ValidatorFn {
  return (group: AbstractControl): ValidationErrors | null =&gt; {
    const inici = group.get(&#39;dataInici&#39;)?.value;
    const fi = group.get(&#39;dataFi&#39;)?.value;
    if (!inici || !fi) return null; // Required s&#39;encarrega
    const dataInici = new Date(inici);
    const dataFi = new Date(fi);
    if (dataFi &lt;= dataInici) {
      return {
        dataFiNoPosteriror: {
          dataInici: inici,
          dataFi: fi,
          missatge: &#39;La data de finalització ha de ser posterior a la data d\&#39;inici&#39;
        }
      };
    }
    return null;
  };
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// component.ts - Aplicar validadors personalitzats
import { codiInternValid, dataFiPosteriorDataInici } from &#39;../../validacions/element.validators&#39;;
formulari = this.fb.group({
  codi: [&#39;&#39;, [Validators.required, codiInternValid()]],
  dataInici: [&#39;&#39;, Validators.required],
  dataFi: [&#39;&#39;, Validators.required]
}, {
  validators: [dataFiPosteriorDataInici()]  // Validador a nivell de grup
});
get codiControl() {
  return this.formulari.get(&#39;codi&#39;);
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;label&gt;
  Codi intern
  &lt;input type=&quot;text&quot; formControlName=&quot;codi&quot;&gt;
&lt;/label&gt;
&lt;div *ngIf=&quot;codiControl?.touched &amp;&amp; codiControl?.invalid&quot; class=&quot;error&quot;&gt;
  &lt;p *ngIf=&quot;codiControl?.hasError(&#39;required&#39;)&quot;&gt;
    El codi és obligatori.
  &lt;/p&gt;
  &lt;p *ngIf=&quot;codiControl?.hasError(&#39;codiInternInvalid&#39;)&quot;&gt;
    El codi ha de tenir format {{ codiControl?.errors?.[&#39;codiInternInvalid&#39;].formatEsperat }}.
    Exemple: {{ codiControl?.errors?.[&#39;codiInternInvalid&#39;].exemple }}.
  &lt;/p&gt;
&lt;/div&gt;
&lt;!-- Validació de grup --&gt;
&lt;div *ngIf=&quot;formulari.hasError(&#39;dataFiNoPosteriror&#39;) &amp;&amp; formulari.get(&#39;dataFi&#39;)?.touched&quot; class=&quot;error&quot;&gt;
  &lt;p&gt;{{ formulari.errors?.[&#39;dataFiNoPosteriror&#39;].missatge }}&lt;/p&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<p><strong>Validador asíncron per comprovar disponibilitat:</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// element.validators.ts - Validador asíncron
import { HttpClient } from &#39;@angular/common/http&#39;;
import { Observable, of, timer } from &#39;rxjs&#39;;
import { map, switchMap, catchError } from &#39;rxjs/operators&#39;;
/**
 * Valida que el codi no existeixi ja a la base de dades
 * Retorna Observable per permetre validació asíncrona
 */
export function codiDisponible(http: HttpClient, apiUrl: string): ValidatorFn {
  return (control: AbstractControl): Observable&lt;ValidationErrors | null&gt; =&gt; {
    const valor = String(control.value || &#39;&#39;).trim();
    // Si buit o format incorrecte, altres validadors s&#39;encarreguen
    if (!valor || !/^CAT-\d{4}-\d{3}$/.test(valor)) {
      return of(null);
    }
    // Debounce de 500ms per no saturar API
    return timer(500).pipe(
      switchMap(() =&gt;
        http.get&lt;string[]&gt;(`${apiUrl}/codisExistents`).pipe(
          map(codis =&gt; {
            const existeix = codis.includes(valor);
            return existeix ? { codiDuplicat: { valor } } : null;
          }),
          catchError(() =&gt; of(null))  // Si error API, no bloquejar formulari
        )
      )
    );
  };
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// component.ts - Aplicar validador asíncron
import { HttpClient } from &#39;@angular/common/http&#39;;
import { codiDisponible } from &#39;../../validacions/element.validators&#39;;
constructor(private readonly fb: FormBuilder, private readonly http: HttpClient) {}
formulari = this.fb.group({
  codi: [&#39;&#39;,
    [Validators.required, codiInternValid()],  // Validadors síncrons
    [codiDisponible(this.http, &#39;http://localhost:4301&#39;)]  // Validadors asíncrons
  ]
});</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;label&gt;
  Codi intern
  &lt;input type=&quot;text&quot; formControlName=&quot;codi&quot;&gt;
&lt;/label&gt;
&lt;!-- Indicador durant validació asíncrona --&gt;
&lt;div *ngIf=&quot;codiControl?.pending&quot; class=&quot;info&quot;&gt;
  &lt;span class=&quot;spinner&quot;&gt;&lt;/span&gt;
  Comprovant disponibilitat del codi...
&lt;/div&gt;
&lt;div *ngIf=&quot;codiControl?.touched &amp;&amp; codiControl?.invalid&quot; class=&quot;error&quot;&gt;
  &lt;p *ngIf=&quot;codiControl?.hasError(&#39;codiDuplicat&#39;)&quot;&gt;
    El codi {{ codiControl?.errors?.[&#39;codiDuplicat&#39;].valor }} ja existeix.
    Trieu un altre.
  &lt;/p&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<p><strong>Avantatges específics:</strong></p>
<ul>
<li><strong>Regles de negoci implementables:</strong> Qualsevol lògica de validació encapsulada en funció pura. Exemple implementat: format intern CAT-YYYY-NNN, dates interdependents, disponibilitat contra API.</li>
<li><strong>Missatges contextuals:</strong> Errors retornen objectes amb metadades. Missatge "Format CAT-YYYY-NNN (exemple: CAT-2024-001)" vs genèric "Format incorrecte". Millor experiència d'usuari.</li>
<li><strong>Reutilització total:</strong> Exportar validador, importar a qualsevol component. 1 validador <code>codiInternValid()</code> reutilitzat en 10 formularis. Canviar format: modificar 1 funció vs 10 components.</li>
<li><strong>Testing senzill:</strong> Provar funció pura sense component ni DOM. Test: <code>expect(codiInternValid()(controlMock)).toEqual({ codiInternInvalid: {...} })</code>. Tests ràpids (1-5ms), desacoblats.</li>
<li><strong>Validacions asíncrones natives:</strong> Framework suporta retornar <code>Observable&lt;ValidationErrors | null&gt;</code>. Feedback automàtic: <code>control.pending</code> durant validació, després <code>valid</code> o <code>invalid</code>. Zero gestió manual de subscripcions.</li>
</ul>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.3. Model mental</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>2.3.1. Flux de validador síncron</h4>

<div class="code-block" data-lang="text" role="region" aria-label="Bloc de codi text">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-text">Usuari escriu al FormControl
  ↓ .valueChanges emet
Angular executa validadors síncrons
  ↓ validador(control)
Funció pura avalua valor
  ↓ comprova condicions
Retorna ValidationErrors | null
  ↓ si error !== null
control.errors actualitzat
  ↓ control.status = &#39;INVALID&#39;
Template mostra missatge d&#39;error
  ↓ .hasError(&#39;clauError&#39;)
Usuari veu feedback immediat</code></pre>
  </div>
</div>

<p><strong>Temps d'execució:</strong> &lt; 1ms (síncron)</p>
<h4>2.3.2. Flux de validador asíncron</h4>

<div class="code-block" data-lang="text" role="region" aria-label="Bloc de codi text">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-text">Usuari escriu al FormControl
  ↓ .valueChanges emet
Validadors síncrons executen primer
  ↓ Si síncrons passen
control.status = &#39;PENDING&#39;
  ↓ Template mostra spinner
Angular executa validadors asíncrons
  ↓ validador(control)
Funció retorna Observable
  ↓ HttpClient.get() o Promise
Espera resposta asíncrona (500ms-2s)
  ↓ Observable emet
ValidationErrors | null rebut
  ↓ control.status = &#39;VALID&#39; | &#39;INVALID&#39;
Template actualitza UI
  ↓ Mostra error o oculta spinner</code></pre>
  </div>
</div>

<p><strong>Temps d'execució:</strong> 500ms-3s (depèn d'API)</p>
<h4>2.3.3. Jerarquia de validació</h4>

<div class="code-block" data-lang="text" role="region" aria-label="Bloc de codi text">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-text">FormGroup (formulari)
  ├── Validadors de grup (dataFiPosteriorDataInici)
  │     ↓ Accés a múltiples FormControls
  │     ↓ Validar relacions entre camps
  │
  ├── FormControl (codi)
  │     ├── Validadors síncrons
  │     │     ├── Validators.required
  │     │     └── codiInternValid()
  │     └── Validadors asíncrons
  │           └── codiDisponible()
  │
  └── FormControl (email)
        ├── Validadors síncrons
        │     ├── Validators.required
        │     └── Validators.email
        └── Validadors asíncrons
              └── emailDisponible()</code></pre>
  </div>
</div>

<h4>2.3.4. Analogia útil</h4>
<p><strong>Validador síncron = Inspector de documents immediat</strong></p>
<ul>
<li>Comprova document en 1 segon</li>
<li>Regles clares: "Format incorrecte", "Falta camp obligatori"</li>
<li>Resultat instantani: <i class="bi bi-check-circle-fill text-success"></i> OK o <i class="bi bi-x-circle-fill text-danger"></i> Error</li>
<li>Exemple: Comprovar que DNI té 9 caràcters</li>
</ul>
<p><strong>Validador asíncron = Inspector que consulta registre central</strong></p>
<ul>
<li>Triga 2-3 segons mentre consulta base de dades</li>
<li>Mentre comprova, mostra "Comprovant..."</li>
<li>Després retorna: <i class="bi bi-check-circle-fill text-success"></i> Disponible o <i class="bi bi-x-circle-fill text-danger"></i> Ja existeix</li>
<li>Exemple: Comprovar que username no està registrat</li>
</ul>
<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Validadors asíncrons només s'executen si validadors síncrons passen. Per eficiència: No té sentit comprovar disponibilitat d'username si el format és invàlid. Síncrons ràpids (&lt; 1ms) filtren errors bàsics abans de peticions costoses (500ms-2s).
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.4. Limitacions dels validadors integrats (0-15')</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>2.4.1. Validadors integrats disponibles</h4>
<ul>
<li><code>Validators.required</code>, <code>minLength</code>, <code>maxLength</code></li>
<li><code>Validators.min</code>, <code>max</code> (numèrics)</li>
<li><code>Validators.email</code></li>
<li><code>Validators.pattern(regex)</code></li>
</ul>
<h4>2.4.2. Limitacions identificades</h4>
<p><strong>1. Formats específics del projecte</strong></p>
<p>Voleu validar codi intern <code>CAT-YYYY-NNN</code>? <code>Validators.pattern(/^CAT-\d{4}-\d{3}$/)</code> funciona però:</p>
<ul>
<li>Missatge d'error genèric: <code>{ pattern: true }</code></li>
<li>No indica format esperat a l'usuari</li>
<li>No reutilitzable amb nom descriptiu</li>
</ul>
<p><strong>2. Dependències entre camps</strong></p>
<p>Com validar "Data fi posterior a data inici"? Validadors integrats només veuen un FormControl. No poden comparar múltiples camps. Solució: validador personalitzat a nivell FormGroup.</p>
<p><strong>3. Regles de negoci complexes</strong></p>
<p>"Pressupost múltiple de 100€", "Email amb domini '@empresa.com'", "CIF espanyol vàlid". Cap validador integrat cobreix aquests casos. Cal crear validadors personalitzats.</p>
<p><strong>4. Validacions contra font externa</strong></p>
<p>"Username disponible?", "Codi descompte vàlid?", "IBAN existeix al banc?". Requereix petició HTTP asíncrona. Validadors integrats són síncrons.</p>
<p><strong>Exemple de limitació:</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// Intentant validar amb integrats - no suficient
formulari = this.fb.group({
  email: [&#39;&#39;, [Validators.required, Validators.email]],
  // No puc validar que sigui @empresa.com
  pressupost: [0, [Validators.required, Validators.min(100)]],
  // No puc validar que sigui múltiple de 100
  dataInici: [&#39;&#39;, Validators.required],
  dataFi: [&#39;&#39;, Validators.required]
  // No puc validar que dataFi &gt; dataInici
});</code></pre>
  </div>
</div>

<!-- Component: Caixa d'advertiment -->
<div class="warning-box" role="alert" aria-live="assertive">
    <div class="component-header warning-header" role="heading" aria-level="4"><i class="bi bi-exclamation-triangle" aria-hidden="true"></i> Important</div>
    <strong>Clau:</strong> Validadors integrats cobreixen casos genèrics. Per regles específiques, cal crear validadors personalitzats.
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.5. Crear validadors síncrons personalitzats (15-30')</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>2.5.1. Signatura d'un validador síncron</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">type ValidatorFn = (control: AbstractControl) =&gt; ValidationErrors | null;</code></pre>
  </div>
</div>

<h4>2.5.2. Validador bàsic</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// src/app/validacions/element.validators.ts
import { AbstractControl, ValidationErrors } from &#39;@angular/forms&#39;;
/**
 * Valida que el pressupost sigui múltiple de 100
 */
export function pressupostMultipleCent(control: AbstractControl): ValidationErrors | null {
  const valor = Number(control.value);
  // Si buit o no numèric, altres validadors s&#39;encarreguen
  if (Number.isNaN(valor) || valor === 0) {
    return null;
  }
  // Comprovar si és múltiple de 100
  if (valor % 100 !== 0) {
    return {
      noMultipleCent: {
        valorRebut: valor,
        multiplesPropers: [
          Math.floor(valor / 100) * 100,
          Math.ceil(valor / 100) * 100
        ]
      }
    };
  }
  return null;  // Validació passa
}</code></pre>
  </div>
</div>

<h4>2.5.3. Aplicar al formulari</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// component.ts
import { pressupostMultipleCent } from &#39;../../validacions/element.validators&#39;;
formulari = this.fb.group({
  pressupost: [0, [
    Validators.required,
    Validators.min(100),
    pressupostMultipleCent  // Validador personalitzat
  ]]
});</code></pre>
  </div>
</div>

<h4>2.5.4. Mostrar missatge</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div *ngIf=&quot;pressupostControl?.touched &amp;&amp; pressupostControl?.invalid&quot; class=&quot;error&quot;&gt;
  &lt;p *ngIf=&quot;pressupostControl?.hasError(&#39;noMultipleCent&#39;)&quot;&gt;
    El pressupost ha de ser múltiple de 100€.
    Valors propers:
    {{ pressupostControl?.errors?.[&#39;noMultipleCent&#39;].multiplesPropers[0] }}€ o
    {{ pressupostControl?.errors?.[&#39;noMultipleCent&#39;].multiplesPropers[1] }}€.
  &lt;/p&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<h4>2.5.5. Validador per format específic</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">/**
 * Valida format codi intern: CAT-YYYY-NNN
 */
export function codiInternValid(control: AbstractControl): ValidationErrors | null {
  const valor = String(control.value || &#39;&#39;).trim();
  if (!valor) return null;  // Required s&#39;encarrega
  const pattern = /^CAT-\d{4}-\d{3}$/;
  if (!pattern.test(valor)) {
    return {
      codiInternInvalid: {
        formatEsperat: &#39;CAT-YYYY-NNN&#39;,
        exemple: &#39;CAT-2024-001&#39;,
        valorRebut: valor
      }
    };
  }
  return null;
}</code></pre>
  </div>
</div>

<!-- Component: Caixa informativa -->
<div class="info-box" role="note">
    <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-info-circle" aria-hidden="true"></i> Informació</div>
    <strong>Clau:</strong> Validadors personalitzats són funcions que retornen <code>ValidationErrors | null</code>. Retornar objectes amb metadades per missatges contextuals.
    
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.6. Validadors amb paràmetres configurables (30-50')</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>2.6.1. Problema amb validadors sense paràmetres</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// Validador específic, no reutilitzable
export function pressupostMultipleCent(control: AbstractControl): ValidationErrors | null {
  return control.value % 100 === 0 ? null : { error: true };
}
// Cal crear un validador per cada múltiple?
export function pressupostMultipleCinquanta(...) { ... }
export function pressupostMultipleDeu(...) { ... }</code></pre>
  </div>
</div>

<h4>2.6.2. Solució: validador amb paràmetres (factory pattern)</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">/**
 * Valida que el valor sigui múltiple d&#39;un número
 * @param multipli - Número del qual ha de ser múltiple
 * @returns ValidatorFn
 */
export function multipliDe(multipli: number): ValidatorFn {
  return (control: AbstractControl): ValidationErrors | null =&gt; {
    const valor = Number(control.value);
    if (Number.isNaN(valor) || valor === 0) {
      return null;
    }
    if (valor % multipli !== 0) {
      return {
        noMultipli: {
          multipli,
          valorRebut: valor,
          multiplesPropers: [
            Math.floor(valor / multipli) * multipli,
            Math.ceil(valor / multipli) * multipli
          ]
        }
      };
    }
    return null;
  };
}</code></pre>
  </div>
</div>

<h4>2.6.3. Ús amb diferents paràmetres</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  pressupost: [0, [multipliDe(100)]],      // Múltiple de 100
  quantitat: [0, [multipliDe(10)]],        // Múltiple de 10
  paquets: [0, [multipliDe(6)]]            // Múltiple de 6 (packs)
});</code></pre>
  </div>
</div>

<h4>2.6.4. Validador per paraula prohibida</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">/**
 * Valida que el text no contingui una paraula prohibida
 * @param paraula - Paraula a evitar (case-insensitive)
 */
export function senseParaulaProhibida(paraula: string): ValidatorFn {
  return (control: AbstractControl): ValidationErrors | null =&gt; {
    const text = String(control.value || &#39;&#39;).toLowerCase();
    const paraulaLower = paraula.toLowerCase();
    if (text.includes(paraulaLower)) {
      return {
        paraulaProhibida: {
          paraula,
          textRebut: control.value
        }
      };
    }
    return null;
  };
}</code></pre>
  </div>
</div>

<h4>2.6.5. Aplicar múltiples paraules prohibides</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  titol: [&#39;&#39;, [
    Validators.required,
    senseParaulaProhibida(&#39;spam&#39;),
    senseParaulaProhibida(&#39;oferta&#39;),
    senseParaulaProhibida(&#39;gratis&#39;)
  ]]
});</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Factory pattern (funció que retorna ValidatorFn) permet validadors configurables i reutilitzables.
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.7. Introduir validacions asíncrones: concepte i cas d'ús (50-70')</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>2.7.1. Diferència síncron vs asíncron</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Aspecte</th>
<th>Síncron</th>
<th>Asíncron</th>
</tr>
</thead>
<tbody>
<tr>
<td>Execució</td>
<td>Immediata (&lt; 1ms)</td>
<td>Diferida (500ms-3s)</td>
</tr>
<tr>
<td>Retorn</td>
<td><code>ValidationErrors | null</code></td>
<td><code>Observable&lt;ValidationErrors | null&gt;</code></td>
</tr>
<tr>
<td>Casos d'ús</td>
<td>Formats, rangs, càlculs</td>
<td>API, DB, serveis externs</td>
</tr>
<tr>
<td>Estat</td>
<td><code>valid</code> o <code>invalid</code></td>
<td><code>pending</code> → <code>valid</code> | <code>invalid</code></td>
</tr>
<tr>
<td>Feedback UI</td>
<td>Immediat</td>
<td>Spinner durant validació</td>
</tr>
</tbody>
</table>
<h4>2.7.2. Per què necessitem validacions asíncrones</h4>
<p><strong>1. Comprovar disponibilitat</strong></p>
<p>Username, email, codi intern ja existeixen? Cal consultar base de dades o API.</p>
<p><strong>2. Validar amb servei extern</strong></p>
<p>IBAN vàlid segons banc, CIF/NIF vàlid segons Agencia Tributaria, codi postal existeix segons servei postal.</p>
<p><strong>3. Regles de negoci asíncrones</strong></p>
<p>Descompte vàlid?, producte disponible en stock?, límit de crèdit suficient?</p>
<h4>2.7.3. Cas d'ús pràctic: comprovar codi disponible</h4>
<p><strong>Context:</strong> Aplicació permet crear elements amb codi únic. Cal validar que el codi no existeixi ja a la base de dades abans de permetre crear l'element.</p>
<p><strong>Flux desitjat:</strong></p>
<ol>
<li>Usuari escriu codi: <code>CAT-2024-001</code></li>
<li>Template mostra: "Comprovant disponibilitat..." (spinner)</li>
<li>Validador consulta API: <code>GET /codisExistents</code></li>
<li>API respon: <code>["CAT-2024-001", "CAT-2024-002"]</code></li>
<li>Validador comprova: codi existeix a la llista</li>
<li>Retorna error: <code>{ codiDuplicat: true }</code></li>
<li>Template mostra: "Aquest codi ja existeix. Trieu un altre."</li>
</ol>
<h4>2.7.4. Estats del control durant validació</h4>

<div class="code-block" data-lang="text" role="region" aria-label="Bloc de codi text">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-text">Usuari escriu → control.status = &#39;PENDING&#39;
                ↓
             Consulta API (1-2s)
                ↓
    API respon → control.status = &#39;VALID&#39; o &#39;INVALID&#39;</code></pre>
  </div>
</div>

<h4>2.7.5. Indicador visual</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div *ngIf=&quot;codiControl?.pending&quot;&gt;
  Comprovant disponibilitat...
&lt;/div&gt;</code></pre>
  </div>
</div>

<!-- Component: Caixa informativa -->
<div class="info-box" role="note">
    <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-info-circle" aria-hidden="true"></i> Informació</div>
    <strong>Clau:</strong> Validacions asíncrones retornen Observable, Angular gestiona estats <code>pending</code> → <code>valid</code>/<code>invalid</code> automàticament.
    
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.8. Implementar validador asíncron amb API mock (70-90')</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>2.8.1. Preparar API mock</h4>

<div class="code-block" data-lang="json" role="region" aria-label="Bloc de codi json">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">JSON</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-json">{
  &quot;codisExistents&quot;: [
    &quot;CAT-2024-001&quot;,
    &quot;CAT-2024-002&quot;,
    &quot;CAT-2024-003&quot;
  ]
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">json-server --watch tools/api/cataleg.json --port 4301
# Verificar
curl http://localhost:4301/codisExistents</code></pre>
  </div>
</div>

<h4>2.8.2. Validador asíncron complet</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// src/app/validacions/element.validators.ts
import { HttpClient } from &#39;@angular/common/http&#39;;
import { AbstractControl, AsyncValidatorFn, ValidationErrors } from &#39;@angular/forms&#39;;
import { Observable, of, timer } from &#39;rxjs&#39;;
import { map, switchMap, catchError } from &#39;rxjs/operators&#39;;
/**
 * Valida que el codi no existeixi ja a la base de dades
 * @param http - HttpClient per fer peticions
 * @param apiUrl - URL base de l&#39;API
 * @returns AsyncValidatorFn
 */
export function codiDisponible(http: HttpClient, apiUrl: string): AsyncValidatorFn {
  return (control: AbstractControl): Observable&lt;ValidationErrors | null&gt; =&gt; {
    const valor = String(control.value || &#39;&#39;).trim();
    // Si buit o format incorrecte, altres validadors s&#39;encarreguen
    if (!valor || !/^CAT-\d{4}-\d{3}$/.test(valor)) {
      return of(null);  // Observable que emet null immediatament
    }
    // Debounce de 500ms: esperar que l&#39;usuari deixi d&#39;escriure
    return timer(500).pipe(
      switchMap(() =&gt;
        http.get&lt;string[]&gt;(`${apiUrl}/codisExistents`).pipe(
          map(codis =&gt; {
            const existeix = codis.includes(valor);
            console.log(`[codiDisponible] Valor: ${valor}, Existeix: ${existeix}`);
            return existeix ? {
              codiDuplicat: {
                valor,
                missatge: &#39;Aquest codi ja existeix a la base de dades&#39;
              }
            } : null;
          }),
          catchError(error =&gt; {
            console.error(&#39;[codiDisponible] Error API:&#39;, error);
            // Si error API, no bloquejar formulari
            return of(null);
          })
        )
      )
    );
  };
}</code></pre>
  </div>
</div>

<h4>2.8.3. Aplicar al formulari</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// component.ts
import { HttpClient } from &#39;@angular/common/http&#39;;
import { codiDisponible, codiInternValid } from &#39;../../validacions/element.validators&#39;;
constructor(
  private readonly fb: FormBuilder,
  private readonly http: HttpClient
) {}
formulari = this.fb.group({
  codi: [&#39;&#39;,
    // Validadors síncrons (primer array)
    [Validators.required, codiInternValid],
    // Validadors asíncrons (segon array)
    [codiDisponible(this.http, &#39;http://localhost:4301&#39;)]
  ]
});
get codiControl() {
  return this.formulari.get(&#39;codi&#39;);
}</code></pre>
  </div>
</div>

<h4>2.8.4. Explicació del flux</h4>
<ol>
<li><strong>Usuari escriu:</strong> <code>CAT-2024-001</code></li>
<li><strong>Validadors síncrons executen:</strong> <code>required</code> <i class="bi bi-check-circle-fill text-success"></i>, <code>codiInternValid</code> <i class="bi bi-check-circle-fill text-success"></i></li>
<li><strong>Control passa a PENDING:</strong> <code>control.status = 'PENDING'</code></li>
<li><strong>timer(500):</strong> Espera 500ms (debounce)</li>
<li><strong>HttpClient.get():</strong> Consulta API <code>GET /codisExistents</code></li>
<li><strong>map():</strong> Comprova si valor existeix a l'array</li>
<li><strong>Retorna error o null:</strong> <code>{ codiDuplicat: {...} }</code> si existeix, <code>null</code> si disponible</li>
<li><strong>Control actualitza estat:</strong> <code>VALID</code> o <code>INVALID</code></li>
</ol>
<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> <code>timer()</code> per debounce, <code>switchMap()</code> per cancel·lar peticions anteriors, <code>catchError()</code> per no bloquejar si API falla.
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.9. Mostrar indicadors de validació pending (90-105')</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>2.9.1. Estats del FormControl</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">control.status: &#39;VALID&#39; | &#39;INVALID&#39; | &#39;PENDING&#39; | &#39;DISABLED&#39;
control.pending: boolean  // true durant validació asíncrona</code></pre>
  </div>
</div>

<h4>2.9.2. Template amb indicador pending</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;label&gt;
  Codi intern
  &lt;input
    type=&quot;text&quot;
    formControlName=&quot;codi&quot;
    placeholder=&quot;CAT-2024-001&quot;&gt;
&lt;/label&gt;
&lt;!-- Indicador durant validació asíncrona --&gt;
&lt;div *ngIf=&quot;codiControl?.pending&quot; class=&quot;info&quot;&gt;
  &lt;span class=&quot;spinner&quot;&gt;&lt;/span&gt;
  &lt;span&gt;Comprovant disponibilitat del codi...&lt;/span&gt;
&lt;/div&gt;
&lt;!-- Missatges d&#39;error --&gt;
&lt;div *ngIf=&quot;codiControl?.touched &amp;&amp; codiControl?.invalid&quot; class=&quot;error&quot;&gt;
  &lt;p *ngIf=&quot;codiControl?.hasError(&#39;required&#39;)&quot;&gt;
    El codi és obligatori.
  &lt;/p&gt;
  &lt;p *ngIf=&quot;codiControl?.hasError(&#39;codiInternInvalid&#39;)&quot;&gt;
    Format incorrecte. Esperat:
    {{ codiControl?.errors?.[&#39;codiInternInvalid&#39;].formatEsperat }}
  &lt;/p&gt;
  &lt;p *ngIf=&quot;codiControl?.hasError(&#39;codiDuplicat&#39;)&quot;&gt;
    {{ codiControl?.errors?.[&#39;codiDuplicat&#39;].missatge }}
  &lt;/p&gt;
&lt;/div&gt;
&lt;!-- Indicador d&#39;èxit --&gt;
&lt;div *ngIf=&quot;codiControl?.valid &amp;&amp; codiControl?.value&quot; class=&quot;success&quot;&gt;
  &lt;span&gt;&lt;i class=&quot;bi bi-check-circle-fill&quot;&gt;&lt;/i&gt;&lt;/span&gt; Codi disponible
&lt;/div&gt;</code></pre>
  </div>
</div>

<h4>2.9.3. Estils per indicadors</h4>

<div class="code-block" data-lang="scss" role="region" aria-label="Bloc de codi scss">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">SCSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-scss">.info {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem;
  background: #e3f2fd;
  border: 1px solid #90caf9;
  border-radius: 4px;
  color: #1976d2;
  font-size: 0.875rem;
  margin-top: 0.25rem;
  .spinner {
    display: inline-block;
    width: 1rem;
    height: 1rem;
    border: 2px solid #90caf9;
    border-top-color: #1976d2;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }
}
.success {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem;
  background: #e8f5e9;
  border: 1px solid #81c784;
  border-radius: 4px;
  color: #388e3c;
  font-size: 0.875rem;
  margin-top: 0.25rem;
  span {
    font-weight: bold;
  }
}
@keyframes spin {
  to { transform: rotate(360deg); }
}</code></pre>
  </div>
</div>

<h4>2.9.4. Deshabilitar botó durant pending</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;button
  type=&quot;submit&quot;
  [disabled]=&quot;formulari.invalid || formulari.pending&quot;&gt;
  {{ formulari.pending ? &#39;Validant...&#39; : &#39;Guardar&#39; }}
&lt;/button&gt;</code></pre>
  </div>
</div>

<!-- Component: Caixa informativa -->
<div class="info-box" role="note">
    <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-info-circle" aria-hidden="true"></i> Informació</div>
    <strong>Clau:</strong> Usar <code>.pending</code> per mostrar spinners durant validació. Deshabilitar submit fins que totes les validacions compleixin.
    
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.10. Organitzar validadors en fitxers reutilitzables (105-115')</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>2.10.1. Estructura de directoris</h4>

<div class="code-block" data-lang="text" role="region" aria-label="Bloc de codi text">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-text">src/app/
├── validacions/
│   ├── element.validators.ts       # Validadors específics d&#39;elements
│   ├── usuari.validators.ts        # Validadors d&#39;usuaris
│   ├── comuns.validators.ts        # Validadors genèrics reutilitzables
│   └── index.ts                    # Barrel export</code></pre>
  </div>
</div>

<h4>2.10.2. Validadors comuns reutilitzables</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// src/app/validacions/comuns.validators.ts
import { AbstractControl, ValidationErrors, ValidatorFn } from &#39;@angular/forms&#39;;
/**
 * Valida que el valor sigui múltiple d&#39;un número
 */
export function multipliDe(multipli: number): ValidatorFn {
  return (control: AbstractControl): ValidationErrors | null =&gt; {
    const valor = Number(control.value);
    if (Number.isNaN(valor) || valor === 0) return null;
    return valor % multipli === 0 ? null : {
      noMultipli: { multipli, valorRebut: valor }
    };
  };
}
/**
 * Valida que el text no contingui paraula prohibida
 */
export function senseParaula(paraula: string): ValidatorFn {
  return (control: AbstractControl): ValidationErrors | null =&gt; {
    const text = String(control.value || &#39;&#39;).toLowerCase();
    return text.includes(paraula.toLowerCase()) ?
      { paraulaProhibida: { paraula } } : null;
  };
}</code></pre>
  </div>
</div>

<h4>2.10.3. Validadors específics d'elements</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// src/app/validacions/element.validators.ts
import { AbstractControl, ValidationErrors, ValidatorFn, AsyncValidatorFn } from &#39;@angular/forms&#39;;
import { HttpClient } from &#39;@angular/common/http&#39;;
import { Observable, of, timer } from &#39;rxjs&#39;;
import { map, switchMap, catchError } from &#39;rxjs/operators&#39;;
/**
 * Valida format de codi intern d&#39;element: CAT-YYYY-NNN
 */
export function codiElementValid(): ValidatorFn {
  return (control: AbstractControl): ValidationErrors | null =&gt; {
    const valor = String(control.value || &#39;&#39;).trim();
    if (!valor) return null;
    const pattern = /^CAT-\d{4}-\d{3}$/;
    return pattern.test(valor) ? null : {
      codiInternInvalid: {
        formatEsperat: &#39;CAT-YYYY-NNN&#39;,
        exemple: &#39;CAT-2024-001&#39;
      }
    };
  };
}
/**
 * Valida disponibilitat de codi d&#39;element contra API
 */
export function codiElementDisponible(http: HttpClient, apiUrl: string): AsyncValidatorFn {
  return (control: AbstractControl): Observable&lt;ValidationErrors | null&gt; =&gt; {
    const valor = String(control.value || &#39;&#39;).trim();
    if (!valor || !/^CAT-\d{4}-\d{3}$/.test(valor)) {
      return of(null);
    }
    return timer(500).pipe(
      switchMap(() =&gt;
        http.get&lt;string[]&gt;(`${apiUrl}/codisExistents`).pipe(
          map(codis =&gt; codis.includes(valor) ? { codiDuplicat: { valor } } : null),
          catchError(() =&gt; of(null))
        )
      )
    );
  };
}</code></pre>
  </div>
</div>

<h4>2.10.4. Barrel export per imports nets</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// src/app/validacions/index.ts
export * from &#39;./comuns.validators&#39;;
export * from &#39;./element.validators&#39;;
export * from &#39;./usuari.validators&#39;;</code></pre>
  </div>
</div>

<h4>2.10.5. Imports nets al component</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">// component.ts - Import net
import {
  codiElementValid,
  codiElementDisponible,
  multipliDe
} from &#39;../../validacions&#39;;
formulari = this.fb.group({
  codi: [&#39;&#39;,
    [Validators.required, codiElementValid()],
    [codiElementDisponible(this.http, apiUrl)]
  ],
  pressupost: [0, [Validators.required, multipliDe(100)]]
});</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Organitzar validadors per domini (element, usuari, comuns). Usar barrel exports per imports nets.
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.11. Documentar política de validacions (115-120')</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<p>Actualitzeu el fitxer <code>docs/formularis.md</code> amb la documentació completa de validadors personalitzats:</p>
<h4>2.11.1. Validadors síncrons</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Validador</th>
<th>Tipus</th>
<th>Descripció</th>
<th>Exemple ús</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>codiElementValid()</code></td>
<td>Síncron</td>
<td>Format CAT-YYYY-NNN</td>
<td><code>[codiElementValid()]</code></td>
</tr>
<tr>
<td><code>multipliDe(n)</code></td>
<td>Síncron</td>
<td>Valor múltiple de n</td>
<td><code>[multipliDe(100)]</code></td>
</tr>
<tr>
<td><code>senseParaula(p)</code></td>
<td>Síncron</td>
<td>Text sense paraula p</td>
<td><code>[senseParaula('spam')]</code></td>
</tr>
</tbody>
</table>
<h4>2.11.2. Validadors asíncrons</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Validador</th>
<th>Descripció</th>
<th>Temps resposta</th>
<th>Exemple ús</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>codiElementDisponible(http, url)</code></td>
<td>Comprova codi no duplicat a API</td>
<td>500ms-2s</td>
<td><code>[codiElementDisponible(http, apiUrl)]</code></td>
</tr>
<tr>
<td><code>usernameDisponible(http, url)</code></td>
<td>Comprova username lliure</td>
<td>500ms-2s</td>
<td><code>[usernameDisponible(http, apiUrl)]</code></td>
</tr>
</tbody>
</table>
<h4>2.11.3. Missatges d'error</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Clau error</th>
<th>Missatge</th>
<th>Metadades disponibles</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>codiInternInvalid</code></td>
<td>"Format incorrecte. Esperat: CAT-YYYY-NNN"</td>
<td><code>formatEsperat</code>, <code>exemple</code>, <code>valorRebut</code></td>
</tr>
<tr>
<td><code>codiDuplicat</code></td>
<td>"Aquest codi ja existeix"</td>
<td><code>valor</code>, <code>missatge</code></td>
</tr>
<tr>
<td><code>noMultipli</code></td>
<td>"El valor ha de ser múltiple de {multipli}"</td>
<td><code>multipli</code>, <code>valorRebut</code>, <code>multiplesPropers</code></td>
</tr>
</tbody>
</table>
<h4>2.11.4. Configuració API mock</h4>
<p><strong>Endpoint:</strong> <code>http://localhost:4301</code></p>
<p><strong>Recursos:</strong></p>
<ul>
<li><code>GET /codisExistents</code> → Array de codis existents</li>
<li><code>GET /usuarisExistents</code> → Array d'usernames registrats</li>
</ul>
<p><strong>Fitxer:</strong> <code>tools/api/cataleg.json</code></p>
<p><strong>Executar:</strong></p>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">json-server --watch tools/api/cataleg.json --port 4301</code></pre>
  </div>
</div>

<!-- Component: Caixa informativa -->
<div class="info-box" role="note">
    <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-info-circle" aria-hidden="true"></i> Informació</div>
    <strong>Clau:</strong> Documentar validadors, missatges, configuració API i proves facilita manteniment i onboarding.
    
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.12. Mini exemple pràctic</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<p>Consolideu el flux complet amb aquest mini exemple que inclou validadors síncrons, asíncrons, indicadors pending i documentació.</p>
<h4>2.12.1. Crear directori de validacions</h4>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">mkdir -p src/app/validacions</code></pre>
  </div>
</div>

<h4>2.12.2. Configurar API mock</h4>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">{ &quot;codisExistents&quot;: [&quot;CAT-2024-001&quot;, &quot;CAT-2024-002&quot;] }
json-server --watch tools/api/cataleg.json --port 4301</code></pre>
  </div>
</div>

<h4>2.12.3. Aplicar validadors al formulari</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  codi: [&#39;&#39;,
    [Validators.required, codiElementValid()],
    [codiElementDisponible(this.http, &#39;http://localhost:4301&#39;)]
  ],
  pressupost: [0, [multipliDe(100)]],
  dataInici: [&#39;&#39;, Validators.required],
  dataFi: [&#39;&#39;, Validators.required]
}, {
  validators: [dataFiPosterior()]
});</code></pre>
  </div>
</div>

<h4>2.12.4. Implementar template amb indicadors</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div *ngIf=&quot;codiControl?.pending&quot; class=&quot;info&quot;&gt;
  &lt;span class=&quot;spinner&quot;&gt;&lt;/span&gt; Comprovant...
&lt;/div&gt;
&lt;div *ngIf=&quot;codiControl?.touched &amp;&amp; codiControl?.invalid&quot; class=&quot;error&quot;&gt;
  &lt;p *ngIf=&quot;codiControl?.hasError(&#39;codiDuplicat&#39;)&quot;&gt;
    Codi ja existeix
  &lt;/p&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<h4>2.12.5. Provar funcionalitat</h4>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">ng serve --port 4300
# Provar: CAT-2024-001 (duplicat), CAT-2024-999 (disponible)
# Verificar spinner apareix
# Verificar missatges contextuals
npm run lint
npm run test -- --watch=false</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    Formulari complet amb validacions síncrones i asíncrones, indicadors visuals, missatges contextuals i documentació tècnica actualitzada.
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.13. Resolució de problemes (Win/macOS/Linux)</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>2.13.1. Problemes transversals</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Símptoma</th>
<th>Possible causa</th>
<th>Solució ràpida</th>
</tr>
</thead>
<tbody>
<tr>
<td>Validador asíncron sempre pending</td>
<td>Observable no completa</td>
<td>Verificar que observable emet i completa amb <code>of()</code> o <code>map()</code></td>
</tr>
<tr>
<td>Missatges d'error no apareixen</td>
<td>Clau error incorrecta</td>
<td>Comprovar <code>.hasError('clauCorrecta')</code> coincideix amb el retornat</td>
</tr>
<tr>
<td>Validador asíncron no s'executa</td>
<td>Validadors síncrons fallen</td>
<td>Validadors asíncrons només executen si síncrons passen</td>
</tr>
<tr>
<td>Múltiples peticions API</td>
<td>Falta debounce</td>
<td>Afegir <code>timer(500)</code> abans de <code>switchMap()</code></td>
</tr>
<tr>
<td>Formulari bloquejat per error API</td>
<td>catchError no implementat</td>
<td>Afegir <code>.pipe(catchError(() => of(null)))</code></td>
</tr>
</tbody>
</table>
<h4>2.13.2. Errors de configuració (Win/Linux/macOS)</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Error</th>
<th>Solució Windows</th>
<th>Solució Linux/macOS</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AsyncValidator must return Observable</code></td>
<td>Wrapejar amb <code>of()</code>: <code>return of(null)</code></td>
<td>Wrapejar amb <code>of()</code>: <code>return of(null)</code></td>
</tr>
<tr>
<td><code>json-server: command not found</code></td>
<td><code>npm install -g json-server</code></td>
<td><code>npm install -g json-server</code></td>
</tr>
<tr>
<td><code>Cannot find name 'ValidatorFn'</code></td>
<td><code>import { ValidatorFn } from '@angular/forms';</code></td>
<td><code>import { ValidatorFn } from '@angular/forms';</code></td>
</tr>
<tr>
<td><code>HttpClient not provided</code></td>
<td>Afegir a <code>app.config.ts</code>: <code>provideHttpClient()</code></td>
<td>Afegir a <code>app.config.ts</code>: <code>provideHttpClient()</code></td>
</tr>
</tbody>
</table>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.14. Prompts d'IA</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Expert en validacions Angular. <strong>Context:</strong> Necessito generar validadors personalitzats per un formulari d'ecommerce. <strong>Tasca:</strong> Genera una taula amb 10 validadors personalitzats per formularis d'ecommerce (codi descompte, targeta crèdit, codi postal, etc.) amb missatges d'error contextuals. <strong>Format:</strong> Taula amb columnes: Nom validador, Règim validació, Exemple regex/lògica, Missatge error, Metadades retornades.</div>
  </div>
</div>

<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Arquitecte de validacions asíncrones. <strong>Context:</strong> Vull implementar un validador asíncron robust per comprovar disponibilitat d'email. <strong>Tasca:</strong> Explica en 10 punts com implementar un validador asíncron per comprovar disponibilitat d'email amb debounce, cancel·lació de peticions anteriors i gestió d'errors. Inclou codi TypeScript complet amb comentaris detallats. <strong>Format:</strong> Llista numerada amb exemples de codi per cada punt.</div>
  </div>
</div>

<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Especialista en patrons de validació. <strong>Context:</strong> Estic creant un validador de contrasenyes amb múltiples requisits. <strong>Tasca:</strong> Crea un validador personalitzat que comprovi que un camp 'password' contingui almenys 1 majúscula, 1 número i 1 caràcter especial, retornant metadades detallades per cada requisit incomplert. Mostra com usar aquestes metadades al template per feedback específic. <strong>Format:</strong> Codi TypeScript del validador + exemple template HTML amb missatges específics.</div>
  </div>
</div>

<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Analista de rendiment Angular. <strong>Context:</strong> Necessito entendre les diferències de rendiment entre validadors síncrons i asíncrons. <strong>Tasca:</strong> Compara validadors síncrons vs asíncrons en Angular en una taula: temps d'execució típic, casos d'ús recomanats, signatura TypeScript, gestió d'errors, millors pràctiques per optimització. Afegeix 3 exemples concrets on cal escollir entre un o altre. <strong>Format:</strong> Taula comparativa + 3 casos d'ús amb justificació.</div>
  </div>
</div>

<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Expert en formularis reactius. <strong>Context:</strong> Vull veure un exemple complet de FormGroup amb validacions complexes. <strong>Tasca:</strong> Genera un exemple complet de FormGroup amb 5 camps que utilitzin validadors síncrons personalitzats, 2 validadors asíncrons i 1 validador de grup, amb template HTML complet amb indicadors pending, missatges d'error contextuals i estils SCSS. <strong>Format:</strong> 3 blocs de codi: TypeScript component, HTML template, SCSS styles.</div>
  </div>
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.15. Autoavaluació</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>Conceptes teòrics</h4>
<!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Comprenc la diferència entre validadors integrats i personalitzats</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Entenc quan usar validadors síncrons vs asíncrons</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé què és el factory pattern per validadors amb paràmetres</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Comprenc el flux pending → valid/invalid en validacions asíncrones</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Entenc com retornar objectes amb metadades per missatges contextuals</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>

<h4>Habilitats pràctiques</h4>

<!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc crear validadors síncrons personalitzats amb signatura correcta</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé implementar factory pattern per validadors amb paràmetres configurables</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc crear validadors asíncrons que consulten APIs amb HttpClient</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé usar timer() per debounce i switchMap() per cancel·lar peticions</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc mostrar indicadors pending durant validacions asíncrones</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé organitzar validadors en fitxers reutilitzables per domini</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc aplicar validadors de grup per dependències entre camps</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé documentar validadors amb JSDoc i taules de referència</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>

<h4>Resolució de problemes</h4>
<!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé diagnosticar per què un validador asíncron està sempre pending</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc solucionar problemes de múltiples peticions API amb debounce</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Entenc com gestionar errors API sense bloquejar formulari</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.16. Síntesi</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<p>Disposeu de <strong>validacions personalitzades completes</strong> que extenen les capacitats dels validadors integrats amb regles de negoci específiques i comprovacions asíncrones contra fonts externes. El projecte inclou validadors síncrons personalitzats com funcions reutilitzables per formats interns (CAT-YYYY-NNN), múltiples (multipliDe), paraules prohibides i dependències entre camps (dates), validadors amb paràmetres utilitzant factory pattern per configurar validadors reutilitzables en diferents contextos sense duplicar codi, validació asíncrona funcional que comprova disponibilitat de codi contra API mock amb debounce de 500ms cancel·lació de peticions anteriors amb switchMap i gestió d'errors amb catchError, indicadors pending avançats proporcionant feedback visual durant validacions asíncrones amb spinners missatges contextuals i indicadors d'èxit/error, organització mantenible amb validadors estructurats en directori dedicat amb separació per domini (comuns element usuari) i barrel exports per imports nets, i documentació tècnica completa amb taules de validadors descripcions exemples d'ús missatges d'error amb metadades configuració API mock i proves realitzades registrades a docs/formularis.md. La base de validacions personalitzades establerta serveix com a fonament per aplicar-les a estructures de formularis més complexes amb FormArray i formularis niuats.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">2.17. Repàs de conceptes</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>ValidatorFn:</strong> Funció pura que rep <code>AbstractControl</code> i retorna <code>ValidationErrors | null</code> per validacions síncrones.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>AsyncValidatorFn:</strong> Funció que retorna <code>Observable&lt;ValidationErrors | null&gt;</code> per validacions contra API/DB.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>ValidationErrors:</strong> Objecte amb claus d'error i metadades: <code>{ clauError: { meta1: valor1 } }</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>AbstractControl:</strong> Classe base per FormControl/FormGroup que proporciona accés a <code>.value</code>, <code>.errors</code>, <code>.parent</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>Factory pattern:</strong> Funció que retorna ValidatorFn per crear validadors amb paràmetres configurables: <code>(param) => ValidatorFn</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.pending:</strong> Estat booleà durant validació asíncrona: <code>control.pending: boolean</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>timer():</strong> Operador RxJS per debounce: <code>timer(500)</code> espera 500ms abans d'executar.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>switchMap():</strong> Operador RxJS que cancel·la peticions anteriors quan arriba nou valor.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>catchError():</strong> Operador RxJS per gestionar errors sense bloquejar: <code>catchError(() => of(null))</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>of():</strong> Funció RxJS que crea Observable que emet valor immediatament: <code>of(null)</code>.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>Validador de grup:</strong> Validador aplicat a FormGroup per validar relacions entre múltiples camps.</p>
  </div>
</div>

<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>Barrel export:</strong> Fitxer <code>index.ts</code> que exporta tots els validadors: <code>export * from './validators'</code>.</p>
  </div>
</div>

  
  </div>
</div>

</div>

<!-- SECCIÓ 3: Formularis complexos i camps dinàmics -->
<div class="section" id="Unitat3_Bloc3_Seccio3">
  <h2 id="Unitat3_Bloc3_Seccio3">3. Formularis complexos i camps dinàmics</h2>

  <!-- MULTIMÈDIA -->
  <!--
  ════════════════════════════════════════════════════════════════
  Component: Enllaços multimèdia YouTube
  ════════════════════════════════════════════════════════════════

  Paràmetres:
    - unitat: número de la unitat (1-4)
    - bloc: número del bloc (1-4)
    - seccio: número de la secció (1-3)

  Exemple d'ús:
    {% include multimedia-youtube.html unitat=1 bloc=1 seccio=1 %}

  El component busca automàticament les URLs corresponents a
  site.data.multimedia i mostra els botons de vídeo i àudio.
  ════════════════════════════════════════════════════════════════
-->





  
  
  
  
  

  

  

  
<div class="multimedia-resources">
  <div class="multimedia-header">
    <i class="bi bi-play-circle-fill"></i>
    <span>Contingut multimèdia d'aquesta lectura</span>
  </div>

  <div class="multimedia-buttons">
    
    <a href="https://www.youtube.com/watch?v=s2-UewCf_Fw" target="_blank" rel="noopener noreferrer" class="multimedia-btn video-btn" title="Lectura 3.3.3 · Formularis complexos i camps dinàmics">
      <i class="bi bi-youtube"></i>
      <span>Veure vídeo</span>
      <i class="bi bi-box-arrow-up-right"></i>
    </a>
    

    
    <a href="https://www.youtube.com/watch?v=e60Z6NInsNs" target="_blank" rel="noopener noreferrer" class="multimedia-btn audio-btn" title="[Audio] Lectura 3.3.3 · Formularis complexos i camps dinàmics">
      <i class="bi bi-mic-fill"></i>
      <span>Escoltar àudio</span>
      <i class="bi bi-box-arrow-up-right"></i>
    </a>
    
  </div>

  
  
</div>
  




  <!-- Component: Objectius del bloc/unitat -->



<div class="objectius-box">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-bullseye" aria-hidden="true"></i> Objectius</div>
  <div class="component-content">
    <ul>
      
        <li>Construir formularis reactius amb estructures niuades (FormGroup dins FormGroup) per organitzar camps relacionats lògicament (adreça, contacte, configuració)</li>
      
        <li>Utilitzar FormArray per gestionar col·leccions dinàmiques de controls que l'usuari pot afegir o eliminar en temps d'execució (telèfons, adreces, variants de producte)</li>
      
        <li>Dominar les diferències entre setValue(), patchValue() i reset() per gestionar valors del formulari de forma precisa segons les necessitats de cada situació</li>
      
    </ul>
  </div>
  <!-- IMPORTANT: també es pot usar via front matter: page.objectius (array) -->
</div>



  <!-- Component: Caixa informativa -->
<div class="info-box" role="note">
    <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-info-circle" aria-hidden="true"></i> Informació</div>
    <strong>RA3 · Criteri 1</strong> — Defineix models de dades i estructures adequades al cas d'ús.
    
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.1. Prerequisits</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<p>Abans de començar, necessiteu:</p>
<ul>
<li><strong>Lectures 3.3.1 i 3.3.2 completes:</strong> Formulari reactiu amb FormBuilder, validadors integrats, validadors personalitzats i asíncrons funcionals</li>
<li><strong>Conceptes consolidats:</strong> FormGroup, FormControl, Validators, validadors personalitzats</li>
<li><strong>Projecte actualitzat:</strong> <code>cataleg-elements</code> amb <code>git status</code> net</li>
<li><strong>VS Code obert:</strong> Terminal integrada disponible</li>
</ul>
<p><strong>Verificació ràpida:</strong></p>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">cd ~/workspace/cataleg-elements
ng serve --port 4300
# Verificar formularis anteriors funcionals</code></pre>
  </div>
</div>

<p><strong>Punt d'autocomprovació:</strong> Servidor operatiu, formularis de lectures 3.3.1 i 3.3.2 accessibles i funcionals.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.2. Marc conceptual</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.2.1. Què són els formularis complexos</h4>
<p>Els <strong>formularis complexos</strong> són aquells que contenen estructures jeràrquiques (formularis dins de formularis) o col·leccions dinàmiques de camps que l'usuari pot afegir o eliminar segons les seves necessitats. Mentre un formulari bàsic té camps estàtics predefinits, un formulari complex s'adapta dinàmicament al context.</p>
<p><strong>Diferència clau:</strong></p>
<ul>
<li><strong>Formulari bàsic:</strong> Camps fixos predefinits (nom, email, telèfon)</li>
<li><strong>Formulari complex:</strong> Camps dinàmics (múltiples telèfons, adreces, variants) + estructures niuades (adreça amb 5 camps agrupats)</li>
</ul>
<h4>3.2.2. Problema sense FormArray i formularis niuats</h4>
<p>Els formularis amb només FormGroups plans presenten limitacions quan necessitem camps dinàmics o agrupacions lògiques.</p>
<p><strong>Situació sense FormArray (camps fixos):</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  nom: [&#39;&#39;, Validators.required],
  telefon1: [&#39;&#39;, Validators.pattern(/^[0-9]{9}$/)],
  telefon2: [&#39;&#39;, Validators.pattern(/^[0-9]{9}$/)],
  telefon3: [&#39;&#39;, Validators.pattern(/^[0-9]{9}$/)],
  carrer: [&#39;&#39;, Validators.required],
  ciutat: [&#39;&#39;, Validators.required],
  codiPostal: [&#39;&#39;, Validators.required],
  provincia: [&#39;&#39;, Validators.required],
  pais: [&#39;&#39;, Validators.required]
});</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;label&gt;
Telèfon 1
&lt;input formControlName=&quot;telefon1&quot;&gt;
&lt;/label&gt;
&lt;div *ngIf=&quot;formulari.get(&#39;telefon1&#39;)?.hasError(&#39;pattern&#39;)&quot;&gt;
Format incorrecte
&lt;/div&gt;
&lt;label&gt;
Telèfon 2
&lt;input formControlName=&quot;telefon2&quot;&gt;
&lt;/label&gt;
&lt;div *ngIf=&quot;formulari.get(&#39;telefon2&#39;)?.hasError(&#39;pattern&#39;)&quot;&gt;
Format incorrecte
&lt;/div&gt;
&lt;label&gt;
Telèfon 3
&lt;input formControlName=&quot;telefon3&quot;&gt;
&lt;/label&gt;
&lt;div *ngIf=&quot;formulari.get(&#39;telefon3&#39;)?.hasError(&#39;pattern&#39;)&quot;&gt;
Format incorrecte
&lt;/div&gt;</code></pre>
  </div>
</div>

<p><strong>Problemes que genera:</strong></p>
<p><strong>1. Camps limitats i rígids</strong></p>
<p>Definiu 3 camps de telèfon però l'usuari necessita 5? Cal modificar codi TypeScript (afegir <code>telefon4</code>, <code>telefon5</code>) i HTML (duplicar template). Usuari només necessita 1 telèfon? Els altres 2 queden buits al formulari, confós visualment. Impossible adaptar formulari a necessitats reals sense modificar codi.</p>
<p><strong>2. Duplicació massiva de codi</strong></p>
<p>Cada camp repetit (telefon1, telefon2, telefon3) requereix: definició a FormGroup, getter al component, HTML amb label+input+validació, SCSS per estils. Per 3 telèfons: 3×10 línies = 30 línies duplicades. Canviar validació de telèfon: modificar 3 llocs. Error en 1, inconsistència total. Manteniment caòtic.</p>
<p><strong>3. Estructura plana sense agrupacions lògiques</strong></p>
<p>Adreça amb 5 camps (carrer, ciutat, CP, província, país) dispersos al FormGroup principal entre altres camps. Accés: <code>formulari.get('carrer')</code>, <code>formulari.get('ciutat')</code>. Impossible tractar adreça com a entitat lògica. Validacions interdependents (ex: CP depèn de província) difícils d'implementar.</p>
<p><strong>4. Impossibilitat d'operacions col·lectives</strong></p>
<p>Voleu validar tots els telèfons com a grup? Impossible amb FormControls independents. Voleu netejar tots els telèfons alhora? Cal fer <code>setValue()</code> a <code>telefon1</code>, <code>telefon2</code>, <code>telefon3</code> individualment. Voleu comptar telèfons vàlids? Codi manual complicat.</p>
<p><strong>5. Experiència d'usuari deficient</strong></p>
<p>Usuari veu 3 camps de telèfon sempre, encara que només necessiti 1. No pot afegir més telèfons si en necessita. Formulari sembla rígid i poc adaptat a necessitats reals. Frustrant i poc professional.</p>
<h4>3.2.3. Solució amb FormArray i FormGroup niuats</h4>
<p>Angular proporciona <code>FormArray</code> per col·leccions dinàmiques i permet niuar <code>FormGroup</code> per organitzar camps.</p>
<p><strong>Situació amb FormArray i niuació:</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  nom: [&#39;&#39;, Validators.required],
  telefons: this.fb.array([
    this.crearTelefon()
  ]),
  adreca: this.fb.group({
    carrer: [&#39;&#39;, Validators.required],
    ciutat: [&#39;&#39;, Validators.required],
    codiPostal: [&#39;&#39;, [Validators.required, Validators.pattern(/^[0-9]{5}$/)]],
    provincia: [&#39;&#39;, Validators.required],
    pais: [&#39;Espanya&#39;, Validators.required]
  })
});
get telefons(): FormArray {
  return this.formulari.get(&#39;telefons&#39;) as FormArray;
}
crearTelefon(): FormGroup {
  return this.fb.group({
    numero: [&#39;&#39;, [Validators.required, Validators.pattern(/^[0-9]{9}$/)]],
    tipus: [&#39;mobil&#39;, Validators.required]
  });
}
afegirTelefon(): void {
  this.telefons.push(this.crearTelefon());
}
eliminarTelefon(index: number): void {
  this.telefons.removeAt(index);
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;section&gt;
&lt;h3&gt;Telèfons&lt;/h3&gt;
&lt;button type=&quot;button&quot; (click)=&quot;afegirTelefon()&quot;&gt;
Afegir telèfon
&lt;/button&gt;
&lt;div formArrayName=&quot;telefons&quot;&gt;
&lt;div *ngFor=&quot;let telefon of telefons.controls; let i = index&quot; [formGroupName]=&quot;i&quot; class=&quot;telefon-item&quot;&gt;
&lt;label&gt;
Número
&lt;input formControlName=&quot;numero&quot; placeholder=&quot;612345678&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Tipus
&lt;select formControlName=&quot;tipus&quot;&gt;
&lt;option value=&quot;mobil&quot;&gt;Mòbil&lt;/option&gt;
&lt;option value=&quot;fix&quot;&gt;Fix&lt;/option&gt;
&lt;option value=&quot;treball&quot;&gt;Treball&lt;/option&gt;
&lt;/select&gt;
&lt;/label&gt;
&lt;button type=&quot;button&quot; (click)=&quot;eliminarTelefon(i)&quot;&gt;
Eliminar
&lt;/button&gt;
&lt;div *ngIf=&quot;telefon.get(&#39;numero&#39;)?.hasError(&#39;pattern&#39;)&quot; class=&quot;error&quot;&gt;
Format incorrecte (9 dígits)
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;
&lt;section formGroupName=&quot;adreca&quot;&gt;
&lt;h3&gt;Adreça&lt;/h3&gt;
&lt;label&gt;
Carrer
&lt;input formControlName=&quot;carrer&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Ciutat
&lt;input formControlName=&quot;ciutat&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Codi postal
&lt;input formControlName=&quot;codiPostal&quot;&gt;
&lt;/label&gt;
&lt;/section&gt;</code></pre>
  </div>
</div>

<p><strong>Avantatges específics:</strong></p>
<ul>
<li><i class="bi bi-check-circle" aria-hidden="true"></i> <strong>Flexibilitat total:</strong> Usuari afegeix 1, 5 o 10 telèfons segons necessitat. Botó "Afegir" crea nou FormGroup automàticament. Botó "Eliminar" esborra telèfon específic. Adaptació dinàmica perfecta.</li>
<li><i class="bi bi-check-circle" aria-hidden="true"></i> <strong>Zero duplicació de codi:</strong> 1 mètode <code>crearTelefon()</code> reutilitzat per tots els telèfons. 1 bloc HTML amb <code>*ngFor</code> renderitza tots. Canviar validació: modificar 1 lloc vs 3-10 llocs. Manteniment simple.</li>
<li><i class="bi bi-check-circle" aria-hidden="true"></i> <strong>Organització lògica:</strong> Adreça agrupada amb <code>formGroupName="adreca"</code>. Accés net: <code>formulari.get('adreca.ciutat')</code>. Validacions interdependents fàcils (CP depèn de província). Estructura clara i mantenible.</li>
<li><i class="bi bi-check-circle" aria-hidden="true"></i> <strong>Operacions col·lectives:</strong> Validar tots telèfons: <code>telefons.valid</code>. Comptar telèfons: <code>telefons.length</code>. Netejar tots: <code>telefons.clear()</code>. API potent per col·leccions.</li>
<li><i class="bi bi-check-circle" aria-hidden="true"></i> <strong>Experiència d'usuari excel·lent:</strong> Usuari controla formulari: afegeix camps quan cal, elimina els que sobren. Formulari adaptat a cas real. Professional i intuïtiu.</li>
</ul>
<h4>3.2.4. Exemple real complet</h4>
<p><strong>Situació:</strong> Formulari d'element de catàleg amb variants dinàmiques (color + estoc) i adreça de distribució niuada.</p>
<p><strong>Sense FormArray (limitat a 3 variants):</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  nom: [&#39;&#39;, Validators.required],
  variant1Color: [&#39;&#39;],
  variant1Estoc: [0],
  variant2Color: [&#39;&#39;],
  variant2Estoc: [0],
  variant3Color: [&#39;&#39;],
  variant3Estoc: [0],
  distribucioCarrer: [&#39;&#39;],
  distribucioCiutat: [&#39;&#39;],
  distribucioCP: [&#39;&#39;]
});</code></pre>
  </div>
</div>

<p><strong>Amb FormArray i niuació (flexible i organitzat):</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  nom: [&#39;&#39;, Validators.required],
  variants: this.fb.array([
    this.crearVariant()
  ]),
  distribucio: this.fb.group({
    carrer: [&#39;&#39;, Validators.required],
    ciutat: [&#39;&#39;, Validators.required],
    codiPostal: [&#39;&#39;, [Validators.required, Validators.pattern(/^[0-9]{5}$/)]]
  })
});
crearVariant(): FormGroup {
  return this.fb.group({
    color: [&#39;&#39;, Validators.required],
    estoc: [0, [Validators.required, Validators.min(0)]],
    preu: [0, [Validators.required, Validators.min(0)]]
  });
}
afegirVariant(): void {
  this.variants.push(this.crearVariant());
}</code></pre>
  </div>
</div>

<h4>3.2.5. Comparativa visual</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Aspecte</th>
<th>FormGroup pla</th>
<th>FormArray + FormGroup niat</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Camps dinàmics</strong></td>
<td>Impossibles (cal predefinir)</td>
<td>Natiu (push/removeAt)</td>
</tr>
<tr>
<td><strong>Límit de camps</strong></td>
<td>Fix (telefon1, telefon2, telefon3)</td>
<td>Il·limitat (usuari controla)</td>
</tr>
<tr>
<td><strong>Duplicació de codi</strong></td>
<td>Alta (repetir per cada camp)</td>
<td>Baixa (1 mètode + *ngFor)</td>
</tr>
<tr>
<td><strong>Organització lògica</strong></td>
<td>Plana (tots camps al mateix nivell)</td>
<td>Jeràrquica (FormGroups niuats)</td>
</tr>
<tr>
<td><strong>Accés a camps</strong></td>
<td><code>formulari.get('telefon1')</code></td>
<td><code>telefons.at(0).get('numero')</code></td>
</tr>
<tr>
<td><strong>Validacions col·lectives</strong></td>
<td>Impossible</td>
<td>Fàcil (<code>telefons.valid</code>)</td>
</tr>
<tr>
<td><strong>Experiència usuari</strong></td>
<td>Rígida (camps fixos)</td>
<td>Flexible (afegir/eliminar)</td>
</tr>
<tr>
<td><strong>Mantenibilitat</strong></td>
<td>Baixa (canviar 3+ llocs)</td>
<td>Alta (canviar 1 mètode)</td>
</tr>
<tr>
<td><strong>Escalabilitat</strong></td>
<td>Limitada (redessenys constants)</td>
<td>Excel·lent (adapta automàticament)</td>
</tr>
<tr>
<td><strong>Testing</strong></td>
<td>Complex (molts casos)</td>
<td>Senzill (testejar mètode factory)</td>
</tr>
</tbody>
</table>
<h4>3.2.6. Conceptes clau</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Concepte</th>
<th>Definició</th>
<th>Sintaxi</th>
<th>Quan usar</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>FormArray</strong></td>
<td>Col·lecció dinàmica de FormControls o FormGroups</td>
<td><code>fb.array([control1, control2])</code></td>
<td>Múltiples camps similars (telèfons, adreces)</td>
</tr>
<tr>
<td><strong>FormGroup niat</strong></td>
<td>FormGroup dins d'un altre FormGroup</td>
<td><code>fb.group({ adreca: fb.group({...}) })</code></td>
<td>Agrupar camps relacionats lògicament</td>
</tr>
<tr>
<td><strong>.push()</strong></td>
<td>Afegir control al final del FormArray</td>
<td><code>formArray.push(nouControl)</code></td>
<td>Afegir camp dinàmic</td>
</tr>
<tr>
<td><strong>.removeAt(i)</strong></td>
<td>Eliminar control a l'índex i</td>
<td><code>formArray.removeAt(2)</code></td>
<td>Eliminar camp específic</td>
</tr>
<tr>
<td><strong>.at(i)</strong></td>
<td>Accedir a control a l'índex i</td>
<td><code>formArray.at(0)</code></td>
<td>Llegir/modificar control específic</td>
</tr>
<tr>
<td><strong>.clear()</strong></td>
<td>Buidar FormArray completament</td>
<td><code>formArray.clear()</code></td>
<td>Netejar tots els camps dinàmics</td>
</tr>
<tr>
<td><strong>.setValue()</strong></td>
<td>Assignar TOTS els valors</td>
<td><code>form.setValue({...})</code></td>
<td>Carregar formulari complet</td>
</tr>
<tr>
<td><strong>.patchValue()</strong></td>
<td>Assignar ALGUNS valors</td>
<td><code>form.patchValue({...})</code></td>
<td>Actualitzar camps parcials</td>
</tr>
<tr>
<td><strong>.reset()</strong></td>
<td>Reiniciar amb valors opcionals</td>
<td><code>form.reset({...})</code></td>
<td>Netejar formulari</td>
</tr>
</tbody>
</table>
<h4>3.2.7. Quan usar cada estructura</h4>
<p><strong><i class="bi bi-check-circle" aria-hidden="true"></i> Usar FormArray quan:</strong></p>
<ul>
<li>Múltiples camps del mateix tipus (telèfons, emails, adreces)</li>
<li>Nombre de camps variable segons usuari</li>
<li>Necessiteu operacions col·lectives (comptar vàlids, netejar tots)</li>
<li>Voleu afegir/eliminar camps dinàmicament</li>
</ul>
<p><strong><i class="bi bi-check-circle" aria-hidden="true"></i> Usar FormGroup niat quan:</strong></p>
<ul>
<li>Agrupar camps relacionats lògicament (adreça = carrer+ciutat+CP)</li>
<li>Reutilitzar estructura entre formularis (adreça en perfil, comanda, enviament)</li>
<li>Validacions interdependents entre camps del grup</li>
<li>Millorar organització i lectura del codi</li>
</ul>
<p><strong><i class="bi bi-check-circle" aria-hidden="true"></i> Usar FormGroup pla quan:</strong></p>
<ul>
<li>Formulari simple amb pocs camps (&lt;10)</li>
<li>Camps heterogenis sense agrupació lògica</li>
<li>Cap necessitat de camps dinàmics</li>
</ul>
<p><strong>Recomanació general:</strong> Per aplicacions professionals, preferir FormArray per col·leccions i FormGroup niat per agrupacions. Només usar FormGroup pla per formularis molt simples.</p>
<h4>3.2.8. Característiques principals</h4>
<p><strong>Col·leccions tipades</strong></p>
<p>FormArray és genèric: <code>FormArray&lt;FormGroup&gt;</code>, <code>FormArray&lt;FormControl&gt;</code>. TypeScript proporciona type safety. Compilador detecta errors d'accés.</p>
<p><strong>Índexs dinàmics</strong></p>
<p>Accés per índex: <code>.at(i)</code>. Iteració fàcil amb <code>*ngFor</code>. Gestió d'índexs automàtica (eliminar actualitza índexs restants).</p>
<p><strong>Validacions globals i individuals</strong></p>
<p>Validar FormArray complet: <code>formArray.valid</code>. Validar control individual: <code>formArray.at(i).valid</code>. Comptar vàlids: <code>formArray.controls.filter(c => c.valid).length</code>.</p>
<p><strong>Composició il·limitada</strong></p>
<p>FormArray dins FormGroup, FormGroup dins FormArray, niuacions múltiples nivells. Estructures complexes possibles: llista de comandes, cada comanda amb llista de productes.</p>
<h4>3.2.9. Integració amb el flux de treball</h4>
<p>Els formularis complexos s'integren amb:</p>
<ul>
<li><strong>Services:</strong> Carregar/guardar estructures niuades via API</li>
<li><strong>Routing:</strong> Resolvers per precarregar dades abans de mostrar formulari</li>
<li><strong>State management:</strong> Signals/observables per sincronitzar dades complexes</li>
<li><strong>Testing:</strong> Tests unitaris per mètodes factory de controls</li>
</ul>
<p>En futurs projectes aprendreu:</p>
<ul>
<li>Formularis amb niuació profunda (3+ nivells)</li>
<li>Drag & drop per reordenar FormArray</li>
<li>Validacions asíncrones en FormArrays</li>
<li>Performance optimization per FormArrays grans (&gt;100 controls)</li>
</ul>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.3. Model mental</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.3.1. Jerarquia de formularis complexos</h4>

<div class="code-block" data-lang="text" role="region" aria-label="Bloc de codi text">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-text">FormGroup (formulari principal)
  ├── FormControl (nom)
  ├── FormControl (email)
  │
  ├── FormArray (telefons)
  │     ├── FormGroup [0]
  │     │     ├── FormControl (numero)
  │     │     └── FormControl (tipus)
  │     ├── FormGroup [1]
  │     │     ├── FormControl (numero)
  │     │     └── FormControl (tipus)
  │     └── ... (dinàmic)
  │
  └── FormGroup (adreca) [niat]
        ├── FormControl (carrer)
        ├── FormControl (ciutat)
        ├── FormControl (codiPostal)
        └── FormControl (pais)</code></pre>
  </div>
</div>

<h4>3.3.2. Flux afegir/eliminar controls</h4>

<div class="code-block" data-lang="text" role="region" aria-label="Bloc de codi text">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-text">Usuari clica &quot;Afegir telèfon&quot;
  ↓ (click)=&quot;afegirTelefon()&quot;
Component executa mètode
  ↓ crearTelefon() retorna FormGroup
  ↓ telefons.push(nouFormGroup)
FormArray actualitzat
  ↓ Change detection Angular
Template re-renderitza *ngFor
  ↓ Nou camp apareix a la UI
Usuari pot omplir nou telèfon
---
Usuari clica &quot;Eliminar&quot; (índex 2)
  ↓ (click)=&quot;eliminarTelefon(2)&quot;
Component executa mètode
  ↓ telefons.removeAt(2)
FormArray actualitzat (índexs recalculats)
  ↓ [0, 1, 2, 3] → [0, 1, 3]
  ↓ Índex 3 passa a ser 2
Template re-renderitza *ngFor
  ↓ Camp eliminat desapareix
Usuari veu canvi immediat</code></pre>
  </div>
</div>

<h4>3.3.3. Accés a dades niuades</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari.get(&#39;nom&#39;)                    → FormControl
formulari.get(&#39;adreca&#39;)                 → FormGroup
formulari.get(&#39;adreca.ciutat&#39;)          → FormControl
formulari.get(&#39;adreca&#39;)?.get(&#39;ciutat&#39;)  → FormControl
formulari.get(&#39;telefons&#39;)               → FormArray
telefons.at(0)                          → FormGroup
telefons.at(0).get(&#39;numero&#39;)            → FormControl
telefons.controls[1].value.tipus        → &#39;mobil&#39;</code></pre>
  </div>
</div>

<h4>3.3.4. Analogia útil</h4>
<p><strong>FormGroup = Objecte JavaScript</strong></p>

<div class="code-block" data-lang="javascript" role="region" aria-label="Bloc de codi javascript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">JAVASCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-javascript">const persona = {
  nom: &#39;Joan&#39;,
  email: &#39;joan@example.com&#39;,
  adreca: {
    carrer: &#39;Main St&#39;,
    ciutat: &#39;Barcelona&#39;
  }
}</code></pre>
  </div>
</div>

<p><strong>FormArray = Array JavaScript</strong></p>

<div class="code-block" data-lang="javascript" role="region" aria-label="Bloc de codi javascript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">JAVASCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-javascript">const persona = {
  nom: &#39;Joan&#39;,
  telefons: [
    { numero: &#39;612345678&#39;, tipus: &#39;mobil&#39; },
    { numero: &#39;934567890&#39;, tipus: &#39;fix&#39; }
  ]
}</code></pre>
  </div>
</div>

<p><strong>Afegir/eliminar:</strong></p>

<div class="code-block" data-lang="javascript" role="region" aria-label="Bloc de codi javascript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">JAVASCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-javascript">persona.telefons.push({ numero: &#39;600111222&#39;, tipus: &#39;treball&#39; });
persona.telefons.splice(1, 1);</code></pre>
  </div>
</div>

<h4>3.3.5. Diferència setValue vs patchValue vs reset</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari.setValue({
  nom: &#39;Joan&#39;,
  telefons: [...],
  adreca: {...}
});
formulari.patchValue({
  nom: &#39;Joan&#39;
});
formulari.reset({
  nom: &#39;&#39;,
  telefons: [],
  adreca: { ciutat: &#39;Barcelona&#39;, pais: &#39;Espanya&#39; }
});</code></pre>
  </div>
</div>

<p><strong>Regla mnemotècnica:</strong></p>
<ul>
<li><code>setValue</code> = assignació <strong>completa</strong> (tots els camps)</li>
<li><code>patchValue</code> = actualització <strong>parcial</strong> (només alguns camps)</li>
<li><code>reset</code> = <strong>neteja</strong> amb valors inicials opcionals</li>
</ul>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.4. FormArray vs FormGroup: quan usar cada estructura</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.4.1. Objectiu</h4>
<p>Entendre les diferències entre FormArray i FormGroup, i decidir quin usar segons el cas.</p>
<h4>3.4.2. Contingut</h4>
<p><strong>FormGroup:</strong></p>
<ul>
<li>Estructura d'objecte amb claus fixes</li>
<li>Camps predefinits coneguts</li>
<li>Accés per nom: <code>.get('camp')</code></li>
<li>Exemple: <code>{ nom: '...', email: '...' }</code></li>
</ul>
<p><strong>FormArray:</strong></p>
<ul>
<li>Estructura d'array amb índexs</li>
<li>Camps dinàmics variables</li>
<li>Accés per índex: <code>.at(0)</code></li>
<li>Exemple: <code>[telefon1, telefon2, telefon3]</code></li>
</ul>
<p><strong>Taula comparativa:</strong></p>
<table class="table table-bordered">
<thead>
<tr>
<th>Criteri</th>
<th>FormGroup</th>
<th>FormArray</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Estructura</strong></td>
<td>Objecte <code>{ clau: valor }</code></td>
<td>Array <code>[item0, item1]</code></td>
</tr>
<tr>
<td><strong>Accés</strong></td>
<td>Per nom <code>.get('clau')</code></td>
<td>Per índex <code>.at(0)</code></td>
</tr>
<tr>
<td><strong>Camps</strong></td>
<td>Fixos (predefinits)</td>
<td>Dinàmics (push/removeAt)</td>
</tr>
<tr>
<td><strong>Cas d'ús</strong></td>
<td>Adreça (carrer, ciutat, CP)</td>
<td>Múltiples telèfons</td>
</tr>
<tr>
<td><strong>Iteració</strong></td>
<td>No aplicable</td>
<td>Fàcil amb *ngFor</td>
</tr>
<tr>
<td><strong>Afegir camp</strong></td>
<td>No previst (modificar codi)</td>
<td><code>.push(nouControl)</code></td>
</tr>
<tr>
<td><strong>Eliminar camp</strong></td>
<td>No aplicable</td>
<td><code>.removeAt(i)</code></td>
</tr>
</tbody>
</table>
<p><strong>Exemples de decisió:</strong></p>
<p><strong>Usar FormGroup quan:</strong></p>
<ul>
<li>Adreça: sempre té carrer, ciutat, CP → FormGroup <code>{ carrer, ciutat, CP }</code></li>
<li>Configuració: opcions fixes → FormGroup <code>{ tema, idioma, notificacions }</code></li>
</ul>
<p><strong>Usar FormArray quan:</strong></p>
<ul>
<li>Telèfons: 1, 3 o 10 segons usuari → FormArray de FormGroups</li>
<li>Ingredients: variable → FormArray de FormControls</li>
<li>Participants: afegir/eliminar → FormArray</li>
</ul>
<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> FormGroup per estructura fixa coneguda. FormArray per col·leccions variables dinàmiques.
</div>

<h4>3.4.3. Resultat esperat</h4>
<p>Compreneu quan usar FormGroup (objectes) vs FormArray (arrays).</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.5. Crear FormArray bàsic per camps dinàmics</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.5.1. Objectiu</h4>
<p>Aprendre a crear un FormArray bàsic amb controls dinàmics.</p>
<h4>3.5.2. Sintaxi bàsica</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { FormArray, FormGroup, FormControl } from &#39;@angular/forms&#39;;
formulari = this.fb.group({
  nom: [&#39;&#39;, Validators.required],
  telefons: this.fb.array([
    this.fb.control(&#39;&#39;, Validators.pattern(/^[0-9]{9}$/))
  ])
});
get telefons(): FormArray {
  return this.formulari.get(&#39;telefons&#39;) as FormArray;
}</code></pre>
  </div>
</div>

<h4>3.5.3. FormArray de FormControls (simple)</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">telefons: this.fb.array([
  this.fb.control(&#39;612345678&#39;),
  this.fb.control(&#39;934567890&#39;)
])
telefons.at(0).value</code></pre>
  </div>
</div>

<h4>3.5.4. FormArray de FormGroups (compost)</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">telefons: this.fb.array([
  this.fb.group({
    numero: [&#39;612345678&#39;, Validators.required],
    tipus: [&#39;mobil&#39;]
  }),
  this.fb.group({
    numero: [&#39;934567890&#39;, Validators.required],
    tipus: [&#39;fix&#39;]
  })
])
telefons.at(0).get(&#39;numero&#39;)?.value</code></pre>
  </div>
</div>

<h4>3.5.5. Template per FormArray</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div formArrayName=&quot;telefons&quot;&gt;
&lt;div *ngFor=&quot;let telefon of telefons.controls; let i = index&quot;&gt;
&lt;input [formControlName]=&quot;i&quot;&gt;
&lt;div [formGroupName]=&quot;i&quot;&gt;
&lt;input formControlName=&quot;numero&quot;&gt;
&lt;select formControlName=&quot;tipus&quot;&gt;
&lt;option value=&quot;mobil&quot;&gt;Mòbil&lt;/option&gt;
&lt;option value=&quot;fix&quot;&gt;Fix&lt;/option&gt;
&lt;/select&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<h4>3.5.6. Exemple complet</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">export class FormulariComponent {
  private readonly fb = inject(FormBuilder);
  formulari = this.fb.group({
    emails: this.fb.array([
      this.fb.control(&#39;&#39;, [Validators.required, Validators.email])
    ])
  });
  get emails(): FormArray {
    return this.formulari.get(&#39;emails&#39;) as FormArray;
  }
}</code></pre>
  </div>
</div>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;form [formGroup]=&quot;formulari&quot;&gt;
&lt;h3&gt;Emails&lt;/h3&gt;
&lt;div formArrayName=&quot;emails&quot;&gt;
&lt;div *ngFor=&quot;let email of emails.controls; let i = index&quot;&gt;
&lt;input [formControlName]=&quot;i&quot; placeholder=&quot;email@example.com&quot;&gt;
&lt;div *ngIf=&quot;emails.at(i).hasError(&#39;email&#39;)&quot; class=&quot;error&quot;&gt;
Format email incorrecte
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/form&gt;</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> FormArray es crea amb <code>fb.array([...])</code>. Accés amb <code>.at(i)</code>. Template amb <code>formArrayName</code> + <code>*ngFor</code>.
</div>

<h4>3.5.7. Resultat esperat</h4>
<p>Sabeu crear FormArray bàsic amb FormControls o FormGroups.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.6. Afegir i eliminar controls programàticament</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.6.1. Objectiu</h4>
<p>Implementar funcionalitat per afegir i eliminar camps dinàmicament.</p>
<h4>3.6.2. Mètode factory per crear controls</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">crearTelefon(): FormGroup {
  return this.fb.group({
    numero: [&#39;&#39;, [Validators.required, Validators.pattern(/^[0-9]{9}$/)]],
    tipus: [&#39;mobil&#39;, Validators.required],
    principal: [false]
  });
}
crearEmail(): FormControl {
  return this.fb.control(&#39;&#39;, [Validators.required, Validators.email]);
}</code></pre>
  </div>
</div>

<h4>3.6.3. Afegir control al FormArray</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">afegirTelefon(): void {
  const nouTelefon = this.crearTelefon();
  this.telefons.push(nouTelefon);
}
afegirEmail(): void {
  this.emails.push(this.crearEmail());
}</code></pre>
  </div>
</div>

<h4>3.6.4. Eliminar control per índex</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">eliminarTelefon(index: number): void {
  this.telefons.removeAt(index);
}
eliminarEmail(index: number): void {
  if (this.emails.length &gt; 1) {
    this.emails.removeAt(index);
  }
}</code></pre>
  </div>
</div>

<h4>3.6.5. Botó afegir al template</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;button type=&quot;button&quot; (click)=&quot;afegirTelefon()&quot;&gt;
Afegir telèfon
&lt;/button&gt;</code></pre>
  </div>
</div>

<h4>3.6.6. Botó eliminar per cada item</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div formArrayName=&quot;telefons&quot;&gt;
&lt;div *ngFor=&quot;let telefon of telefons.controls; let i = index&quot; [formGroupName]=&quot;i&quot;&gt;
&lt;input formControlName=&quot;numero&quot;&gt;
&lt;select formControlName=&quot;tipus&quot;&gt;&lt;/select&gt;
&lt;button type=&quot;button&quot; (click)=&quot;eliminarTelefon(i)&quot; [disabled]=&quot;telefons.length === 1&quot;&gt;
Eliminar
&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<h4>3.6.7. Validacions abans d'eliminar</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">eliminarTelefon(index: number): void {
  if (this.telefons.length &lt;= 1) {
    alert(&#39;Cal almenys 1 telèfon&#39;);
    return;
  }
  const telefon = this.telefons.at(index);
  if (telefon.get(&#39;numero&#39;)?.value &amp;&amp; !confirm(&#39;Segur?&#39;)) {
    return;
  }
  this.telefons.removeAt(index);
}</code></pre>
  </div>
</div>

<h4>3.6.8. Altres mètodes útils</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">netejaTelefons(): void {
  this.telefons.clear();
  this.telefons.push(this.crearTelefon());
}
insertarTelefon(index: number): void {
  this.telefons.insert(index, this.crearTelefon());
}
get telefonsValids(): number {
  return this.telefons.controls.filter(c =&gt; c.valid).length;
}</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> <code>.push()</code> afegeix al final, <code>.removeAt(i)</code> elimina per índex, <code>.clear()</code> buida tot. Sempre validar abans d'eliminar.
</div>

<h4>3.6.9. Resultat esperat</h4>
<p>Sabeu afegir/eliminar controls dinàmicament amb validacions.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.7. Formularis niuats amb FormGroup dins FormGroup</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.7.1. Objectiu</h4>
<p>Crear estructures jeràrquiques amb FormGroups niuats per organitzar camps.</p>
<h4>3.7.2. FormGroup niat bàsic</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  nom: [&#39;&#39;, Validators.required],
  adreca: this.fb.group({
    carrer: [&#39;&#39;, Validators.required],
    numero: [&#39;&#39;, Validators.required],
    pis: [&#39;&#39;],
    ciutat: [&#39;&#39;, Validators.required],
    codiPostal: [&#39;&#39;, [Validators.required, Validators.pattern(/^[0-9]{5}$/)]],
    pais: [&#39;Espanya&#39;, Validators.required]
  })
});</code></pre>
  </div>
</div>

<h4>3.7.3. Accedir a FormGroup niat</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">get adreca(): FormGroup {
  return this.formulari.get(&#39;adreca&#39;) as FormGroup;
}
this.adreca.get(&#39;ciutat&#39;)?.value
this.formulari.get(&#39;adreca.ciutat&#39;)?.value
this.formulari.get(&#39;adreca&#39;)?.get(&#39;ciutat&#39;)?.value</code></pre>
  </div>
</div>

<h4>3.7.4. Template amb formGroupName</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;form [formGroup]=&quot;formulari&quot;&gt;
&lt;label&gt;
Nom
&lt;input formControlName=&quot;nom&quot;&gt;
&lt;/label&gt;
&lt;section formGroupName=&quot;adreca&quot;&gt;
&lt;h3&gt;Adreça&lt;/h3&gt;
&lt;label&gt;
Carrer
&lt;input formControlName=&quot;carrer&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Número
&lt;input formControlName=&quot;numero&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Pis (opcional)
&lt;input formControlName=&quot;pis&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Ciutat
&lt;input formControlName=&quot;ciutat&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
Codi postal
&lt;input formControlName=&quot;codiPostal&quot;&gt;
&lt;/label&gt;
&lt;label&gt;
País
&lt;input formControlName=&quot;pais&quot;&gt;
&lt;/label&gt;
&lt;/section&gt;
&lt;/form&gt;</code></pre>
  </div>
</div>

<h4>3.7.5. Múltiples nivells de niuació</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  dadesPrincipals: this.fb.group({
    nom: [&#39;&#39;],
    cognoms: [&#39;&#39;]
  }),
  contacte: this.fb.group({
    telefon: [&#39;&#39;],
    adreca: this.fb.group({
      carrer: [&#39;&#39;],
      ciutat: [&#39;&#39;],
      coordenades: this.fb.group({
        latitud: [0],
        longitud: [0]
      })
    })
  })
});
formulari.get(&#39;contacte.adreca.coordenades.latitud&#39;)?.value</code></pre>
  </div>
</div>

<h4>3.7.6. Validacions en FormGroup niat</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">adreca: this.fb.group({
  carrer: [&#39;&#39;, Validators.required],
  ciutat: [&#39;&#39;, Validators.required]
}, {
  validators: [this.codiPostalValidPerCiutat()]
})
codiPostalValidPerCiutat(): ValidatorFn {
  return (group: AbstractControl): ValidationErrors | null =&gt; {
    const ciutat = group.get(&#39;ciutat&#39;)?.value;
    const cp = group.get(&#39;codiPostal&#39;)?.value;
    if (ciutat === &#39;Barcelona&#39; &amp;&amp; !cp.startsWith(&#39;08&#39;)) {
      return { cpInvalidPerCiutat: true };
    }
    return null;
  };
}</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> FormGroup niat amb <code>fb.group()</code> dins altre grup. Template amb <code>formGroupName</code>. Accés amb notació punt.
</div>

<h4>3.7.7. Resultat esperat</h4>
<p>Sabeu crear formularis niuats amb múltiples nivells per organitzar camps relacionats.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.8. Gestió de valors: setValue, patchValue, reset</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.8.1. Objectiu</h4>
<p>Dominar les diferències entre setValue, patchValue i reset per gestionar dades.</p>
<h4>3.8.2. setValue: assignar TOTS els valors</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari.setValue({
  nom: &#39;Joan Garcia&#39;,
  telefons: [
    { numero: &#39;612345678&#39;, tipus: &#39;mobil&#39; },
    { numero: &#39;934567890&#39;, tipus: &#39;fix&#39; }
  ],
  adreca: {
    carrer: &#39;Main St&#39;,
    ciutat: &#39;Barcelona&#39;,
    codiPostal: &#39;08001&#39;,
    pais: &#39;Espanya&#39;
  }
});
formulari.setValue({
  nom: &#39;Joan Garcia&#39;,
  adreca: {...}
});</code></pre>
  </div>
</div>

<h4>3.8.3. patchValue: assignar ALGUNS valors</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari.patchValue({
  nom: &#39;Joan Garcia&#39;
});
formulari.patchValue({
  adreca: {
    ciutat: &#39;Girona&#39;
  }
});
formulari.patchValue({
  telefons: [
    { numero: &#39;600111222&#39; }
  ]
});</code></pre>
  </div>
</div>

<h4>3.8.4. reset: netejar amb valors opcionals</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari.reset();
formulari.reset({
  nom: &#39;&#39;,
  telefons: [
    { numero: &#39;&#39;, tipus: &#39;mobil&#39; }
  ],
  adreca: {
    carrer: &#39;&#39;,
    ciutat: &#39;&#39;,
    codiPostal: &#39;&#39;,
    pais: &#39;Espanya&#39;
  }
});
formulari.get(&#39;adreca&#39;)?.reset({
  carrer: &#39;&#39;,
  ciutat: &#39;Barcelona&#39;,
  codiPostal: &#39;&#39;,
  pais: &#39;Espanya&#39;
});</code></pre>
  </div>
</div>

<h4>3.8.5. Taula comparativa</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Mètode</th>
<th>Camps requerits</th>
<th>Camps omesos</th>
<th>Cas d'ús</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>setValue()</code></td>
<td>TOTS obligatoris</td>
<td><i class="bi bi-x-circle" aria-hidden="true"></i> Error</td>
<td>Carregar formulari complet des d'API</td>
</tr>
<tr>
<td><code>patchValue()</code></td>
<td>Opcional (parcial)</td>
<td><i class="bi bi-check-circle" aria-hidden="true"></i> No modifica</td>
<td>Actualitzar només alguns camps</td>
</tr>
<tr>
<td><code>reset()</code></td>
<td>Opcional (parcial)</td>
<td><i class="bi bi-check-circle" aria-hidden="true"></i> Posa null/buit</td>
<td>Netejar formulari amb valors inicials</td>
</tr>
</tbody>
</table>
<h4>3.8.6. Casos d'ús pràctics</h4>
<p><strong>Carregar dades d'API (setValue):</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">carregarElement(id: number): void {
  this.elementService.obtenir(id).subscribe(element =&gt; {
    this.formulari.setValue({
      nom: element.nom,
      telefons: element.telefons.map(t =&gt; ({
        numero: t.numero,
        tipus: t.tipus
      })),
      adreca: {
        carrer: element.adreca.carrer,
        ciutat: element.adreca.ciutat,
        codiPostal: element.adreca.codiPostal,
        pais: element.adreca.pais
      }
    });
  });
}</code></pre>
  </div>
</div>

<p><strong>Actualitzar ciutat (patchValue):</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">canviarCiutat(novaCiutat: string): void {
  this.formulari.patchValue({
    adreca: { ciutat: novaCiutat }
  });
}</code></pre>
  </div>
</div>

<p><strong>Netejar formulari després d'enviar (reset):</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">onSubmit(): void {
  if (this.formulari.valid) {
    this.elementService.crear(this.formulari.value).subscribe(() =&gt; {
      this.formulari.reset({
        nom: &#39;&#39;,
        telefons: [{ numero: &#39;&#39;, tipus: &#39;mobil&#39; }],
        adreca: { pais: &#39;Espanya&#39; }
      });
    });
  }
}</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> setValue = complet, patchValue = parcial, reset = netejar. Usar segons necessitat.
</div>

<h4>3.8.7. Resultat esperat</h4>
<p>Domineu setValue, patchValue i reset per gestionar valors adequadament.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.9. Validacions en camps dinàmics</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.9.1. Objectiu</h4>
<p>Aplicar validacions a FormArrays i gestionar errors dinàmicament.</p>
<h4>3.9.2. Validacions per FormArray complet</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">telefons: this.fb.array(
  [this.crearTelefon()],
  [Validators.minLength(1), Validators.maxLength(5)]
)
if (this.telefons.invalid) {
  if (this.telefons.hasError(&#39;minlength&#39;)) {
    console.log(&#39;Cal almenys 1 telèfon&#39;);
  }
  if (this.telefons.hasError(&#39;maxlength&#39;)) {
    console.log(&#39;Màxim 5 telèfons&#39;);
  }
}</code></pre>
  </div>
</div>

<h4>3.9.3. Validacions per cada control del FormArray</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">crearTelefon(): FormGroup {
  return this.fb.group({
    numero: [&#39;&#39;, [
      Validators.required,
      Validators.pattern(/^[0-9]{9}$/),
      this.telefonUnic()
    ]],
    tipus: [&#39;mobil&#39;, Validators.required]
  });
}
telefonUnic(): ValidatorFn {
  return (control: AbstractControl): ValidationErrors | null =&gt; {
    const numero = control.value;
    const duplicat = this.telefons?.controls.some(
      (c, i) =&gt; c.get(&#39;numero&#39;)?.value === numero &amp;&amp;
                c !== control.parent
    );
    return duplicat ? { telefonDuplicat: true } : null;
  };
}</code></pre>
  </div>
</div>

<h4>3.9.4. Mostrar errors al template</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div formArrayName=&quot;telefons&quot;&gt;
&lt;div *ngIf=&quot;telefons.hasError(&#39;maxlength&#39;)&quot; class=&quot;error&quot;&gt;
Màxim 5 telèfons permesos
&lt;/div&gt;
&lt;div *ngFor=&quot;let telefon of telefons.controls; let i = index&quot; [formGroupName]=&quot;i&quot;&gt;
&lt;input formControlName=&quot;numero&quot;&gt;
&lt;div *ngIf=&quot;telefon.get(&#39;numero&#39;)?.touched &amp;&amp; telefon.get(&#39;numero&#39;)?.invalid&quot; class=&quot;error&quot;&gt;
&lt;p *ngIf=&quot;telefon.get(&#39;numero&#39;)?.hasError(&#39;required&#39;)&quot;&gt;
Número obligatori
&lt;/p&gt;
&lt;p *ngIf=&quot;telefon.get(&#39;numero&#39;)?.hasError(&#39;pattern&#39;)&quot;&gt;
Format incorrecte (9 dígits)
&lt;/p&gt;
&lt;p *ngIf=&quot;telefon.get(&#39;numero&#39;)?.hasError(&#39;telefonDuplicat&#39;)&quot;&gt;
Aquest telèfon ja existeix
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>

<h4>3.9.5. Validador a nivell FormGroup dins FormArray</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">crearVariant(): FormGroup {
  return this.fb.group({
    color: [&#39;&#39;, Validators.required],
    estoc: [0, Validators.min(0)],
    preu: [0, Validators.min(0)]
  }, {
    validators: [this.preuCoherentAmbEstoc()]
  });
}
preuCoherentAmbEstoc(): ValidatorFn {
  return (group: AbstractControl): ValidationErrors | null =&gt; {
    const estoc = group.get(&#39;estoc&#39;)?.value;
    const preu = group.get(&#39;preu&#39;)?.value;
    if (estoc === 0 &amp;&amp; preu &gt; 0) {
      return { preuSenseEstoc: true };
    }
    return null;
  };
}</code></pre>
  </div>
</div>

<h4>3.9.6. Deshabilitar botó afegir si límit assolit</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;button type=&quot;button&quot; (click)=&quot;afegirTelefon()&quot; [disabled]=&quot;telefons.length &gt;= 5&quot;&gt;
Afegir telèfon (/5)
&lt;/button&gt;</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Validacions a FormArray (minLength/maxLength), a cada control individual, i a FormGroups dins FormArray.
</div>

<h4>3.9.7. Resultat esperat</h4>
<p>Sabeu aplicar validacions completes a FormArrays amb missatges contextuals.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.10. Patrons de gestió d'índexs i referències</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.10.1. Objectiu</h4>
<p>Gestionar índexs de FormArray de forma segura i eficient.</p>
<h4>3.10.2. Tracking per index al *ngFor</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div *ngFor=&quot;let telefon of telefons.controls; let i = index&quot;&gt;
&lt;/div&gt;
&lt;div *ngFor=&quot;let telefon of telefons.controls; let i = index; trackBy: trackByIndex&quot;&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">trackByIndex(index: number): number {
  return index;
}</code></pre>
  </div>
</div>

<h4>3.10.3. Guardar referència a FormGroup</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">eliminarTelefon(index: number): void {
  setTimeout(() =&gt; {
    this.telefons.removeAt(index);
  }, 2000);
}
eliminarTelefon(telefon: AbstractControl): void {
  const index = this.telefons.controls.indexOf(telefon as FormGroup);
  if (index !== -1) {
    this.telefons.removeAt(index);
  }
}</code></pre>
  </div>
</div>

<h4>3.10.4. Marcar control específic com a tocat</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">marcarTelefonComATocat(index: number): void {
  const telefon = this.telefons.at(index);
  telefon.markAsTouched();
  Object.keys((telefon as FormGroup).controls).forEach(key =&gt; {
    telefon.get(key)?.markAsTouched();
  });
}</code></pre>
  </div>
</div>

<h4>3.10.5. Validar FormArray abans d'enviar</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">onSubmit(): void {
  this.telefons.controls.forEach(control =&gt; {
    control.markAsTouched();
    if (control instanceof FormGroup) {
      Object.keys(control.controls).forEach(key =&gt; {
        control.get(key)?.markAsTouched();
      });
    }
  });
  if (this.formulari.invalid) {
    console.warn(&#39;Formulari invàlid&#39;);
    return;
  }
}</code></pre>
  </div>
</div>

<h4>3.10.6. Reordenar elements</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">moureAmunt(index: number): void {
  if (index === 0) return;
  const control = this.telefons.at(index);
  this.telefons.removeAt(index);
  this.telefons.insert(index - 1, control);
}
moureAvall(index: number): void {
  if (index === this.telefons.length - 1) return;
  const control = this.telefons.at(index);
  this.telefons.removeAt(index);
  this.telefons.insert(index + 1, control);
}</code></pre>
  </div>
</div>

<h4>3.10.7. Getter per validacions</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">get algunaVariantAmbEstoc(): boolean {
  return this.variants.controls.some(
    v =&gt; (v as FormGroup).get(&#39;estoc&#39;)?.value &gt; 0
  );
}
get totalEstoc(): number {
  return this.variants.controls.reduce(
    (sum, v) =&gt; sum + ((v as FormGroup).get(&#39;estoc&#39;)?.value || 0),
    0
  );
}</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Usar trackBy, guardar referències segures, marcar tocats abans d'enviar, getters per validacions agregades.
</div>

<h4>3.10.8. Resultat esperat</h4>
<p>Domineu patrons avançats de gestió d'índexs i operacions col·lectives.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.11. Documentar casos d'ús i bones pràctiques</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.11.1. Objectiu</h4>
<p>Registrar patrons, decisions i casos d'ús al dossier tècnic.</p>
<h4>3.11.2. Actualitzar docs/formularis.md</h4>
<p><strong>Estructures utilitzades:</strong></p>
<table class="table table-bordered">
<thead>
<tr>
<th>Estructura</th>
<th>Descripció</th>
<th>Cas d'ús</th>
<th>Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td>FormArray de FormControls</td>
<td>Col·lecció simple</td>
<td>Múltiples emails</td>
<td><code>emails: fb.array([fb.control('')])</code></td>
</tr>
<tr>
<td>FormArray de FormGroups</td>
<td>Col·lecció composta</td>
<td>Múltiples telèfons amb tipus</td>
<td><code>telefons: fb.array([fb.group({numero, tipus})])</code></td>
</tr>
<tr>
<td>FormGroup niat</td>
<td>Agrupació lògica</td>
<td>Adreça dins formulari</td>
<td><code>adreca: fb.group({carrer, ciutat})</code></td>
</tr>
<tr>
<td>FormGroup dins FormArray</td>
<td>Combinació complexa</td>
<td>Variants amb múltiples camps</td>
<td><code>variants: fb.array([fb.group({color, estoc, preu})])</code></td>
</tr>
</tbody>
</table>
<h4>3.11.3. Patrons implementats</h4>
<p><strong>Mètode factory:</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">crearTelefon(): FormGroup {
  return this.fb.group({
    numero: [&#39;&#39;, [Validators.required, Validators.pattern(/^[0-9]{9}$/)]],
    tipus: [&#39;mobil&#39;, Validators.required]
  });
}</code></pre>
  </div>
</div>

<p><strong>Gestió de valors:</strong></p>
<table class="table table-bordered">
<thead>
<tr>
<th>Mètode</th>
<th>Quan usar</th>
<th>Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>setValue()</code></td>
<td>Carregar formulari complet des d'API</td>
<td>Edició element existent</td>
</tr>
<tr>
<td><code>patchValue()</code></td>
<td>Actualitzar només alguns camps</td>
<td>Canviar ciutat mantenir resta</td>
</tr>
<tr>
<td><code>reset()</code></td>
<td>Netejar després d'enviar</td>
<td>Nou element amb valors per defecte</td>
</tr>
</tbody>
</table>
<h4>3.11.4. Bones pràctiques</h4>
<p><strong>1. Sempre mètode factory per crear controls</strong></p>
<ul>
<li>Centralitza configuració (validacions, valors per defecte)</li>
<li>Facilita manteniment (1 lloc per canviar)</li>
<li>Testejable aïlladament</li>
</ul>
<p><strong>2. Límits mínim/màxim en FormArrays</strong></p>
<ul>
<li>Evita arrays buits o massa llargs</li>
<li>Deshabilita botons quan assoleixen límit</li>
<li>Mostra comptador: "Telèfons (3/5)"</li>
</ul>
<p><strong>3. TrackBy en *ngFor</strong></p>
<ul>
<li>Millora performance evitant recrear DOM</li>
<li>Essencial per FormArrays grans (&gt;10 elements)</li>
</ul>
<p><strong>4. Validacions abans d'eliminar</strong></p>
<ul>
<li>Confirmar si control té dades</li>
<li>Mantenir mínim controls necessaris</li>
<li>Feedback clar a l'usuari</li>
</ul>
<p><strong>5. Marcar tocats abans d'enviar</strong></p>
<ul>
<li>Mostrar tots els errors si formulari invàlid</li>
<li>Iterar FormArray i marcar cada control</li>
</ul>
<p><strong>6. Getters per accés net</strong></p>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">get telefons(): FormArray {
  return this.formulari.get(&#39;telefons&#39;) as FormArray;
}</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    <strong>Clau:</strong> Documentar estructures, patrons, proves i decisions facilita manteniment i reutilització.
</div>

<h4>3.11.5. Resultat esperat</h4>
<p>Dossier actualitzat amb documentació completa de formularis complexos.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.12. Mini exemple pràctic</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.12.1. Objectiu</h4>
<p>Consolidar el flux complet: FormArray, FormGroup niat, afegir/eliminar, validacions, gestió valors.</p>
<h4>3.12.2. Generar component</h4>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">ng generate component components/formulari-variants --standalone</code></pre>
  </div>
</div>

<h4>3.12.3. Crear estructura FormArray + FormGroup niat</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">formulari = this.fb.group({
  nom: [&#39;&#39;, Validators.required],
  variants: this.fb.array([
    this.crearVariant()
  ], [Validators.minLength(1), Validators.maxLength(5)]),
  distribucio: this.fb.group({
    carrer: [&#39;&#39;, Validators.required],
    ciutat: [&#39;&#39;, Validators.required],
    codiPostal: [&#39;&#39;, [Validators.required, Validators.pattern(/^[0-9]{5}$/)]]
  })
});
get variants(): FormArray {
  return this.formulari.get(&#39;variants&#39;) as FormArray;
}
crearVariant(): FormGroup {
  return this.fb.group({
    color: [&#39;&#39;, Validators.required],
    estoc: [0, [Validators.required, Validators.min(0)]],
    preu: [0, [Validators.required, Validators.min(0)]]
  });
}</code></pre>
  </div>
</div>

<h4>3.12.4. Implementar afegir/eliminar</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">afegirVariant(): void {
  if (this.variants.length &lt; 5) {
    this.variants.push(this.crearVariant());
  }
}
eliminarVariant(index: number): void {
  if (this.variants.length &gt; 1) {
    this.variants.removeAt(index);
  }
}</code></pre>
  </div>
</div>

<h4>3.12.5. Crear template</h4>

<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;form [formGroup]=&quot;formulari&quot;&gt;
&lt;label&gt;
Nom element
&lt;input formControlName=&quot;nom&quot;&gt;
&lt;/label&gt;
&lt;section&gt;
&lt;h3&gt;Variants&lt;/h3&gt;
&lt;button type=&quot;button&quot; (click)=&quot;afegirVariant()&quot; [disabled]=&quot;variants.length &gt;= 5&quot;&gt;
Afegir (/5)
&lt;/button&gt;
&lt;div formArrayName=&quot;variants&quot;&gt;
&lt;div *ngFor=&quot;let variant of variants.controls; let i = index&quot; [formGroupName]=&quot;i&quot;&gt;
&lt;input formControlName=&quot;color&quot; placeholder=&quot;Color&quot;&gt;
&lt;input type=&quot;number&quot; formControlName=&quot;estoc&quot; placeholder=&quot;Estoc&quot;&gt;
&lt;input type=&quot;number&quot; formControlName=&quot;preu&quot; placeholder=&quot;Preu&quot;&gt;
&lt;button type=&quot;button&quot; (click)=&quot;eliminarVariant(i)&quot;&gt;Eliminar&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;
&lt;section formGroupName=&quot;distribucio&quot;&gt;
&lt;h3&gt;Distribució&lt;/h3&gt;
&lt;input formControlName=&quot;carrer&quot; placeholder=&quot;Carrer&quot;&gt;
&lt;input formControlName=&quot;ciutat&quot; placeholder=&quot;Ciutat&quot;&gt;
&lt;input formControlName=&quot;codiPostal&quot; placeholder=&quot;CP&quot;&gt;
&lt;/section&gt;
&lt;/form&gt;</code></pre>
  </div>
</div>

<h4>3.12.6. Implementar setValue/patchValue/reset</h4>

<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">carregarExemple(): void {
  this.formulari.setValue({
    nom: &#39;Element exemple&#39;,
    variants: [
      { color: &#39;Blau&#39;, estoc: 10, preu: 50 },
      { color: &#39;Verd&#39;, estoc: 5, preu: 45 }
    ],
    distribucio: {
      carrer: &#39;Main St&#39;,
      ciutat: &#39;Barcelona&#39;,
      codiPostal: &#39;08001&#39;
    }
  });
}
actualitzarCiutat(): void {
  this.formulari.patchValue({
    distribucio: { ciutat: &#39;Girona&#39; }
  });
}
reiniciar(): void {
  this.formulari.reset({
    nom: &#39;&#39;,
    variants: [{ color: &#39;&#39;, estoc: 0, preu: 0 }],
    distribucio: { carrer: &#39;&#39;, ciutat: &#39;&#39;, codiPostal: &#39;&#39; }
  });
}</code></pre>
  </div>
</div>

<h4>3.12.7. Provar funcionalitat</h4>

<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">ng serve --port 4300
npm run lint
npm run test -- --watch=false</code></pre>
  </div>
</div>

<!-- Component: Caixa d'èxit -->
<div class="success-box" role="status" aria-live="polite">
    <div class="component-header success-header" role="heading" aria-level="4"><i class="bi bi-check-circle" aria-hidden="true"></i> Èxit</div>
    Formulari complet amb FormArray dinàmic, FormGroup niat, validacions, gestió de valors i documentació actualitzada.
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.13. Resolució de problemes (Win/macOS/Linux)</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>3.13.1. Problemes transversals</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Símptoma</th>
<th>Possible causa</th>
<th>Solució ràpida</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Cannot find control with name 'X'</code></td>
<td>formControlName fora del context correcte</td>
<td>Verificar <code>[formGroupName]</code> i <code>formArrayName</code> envolten correctament</td>
</tr>
<tr>
<td><code>setValue()</code> llança error</td>
<td>Falten camps a l'objecte passat</td>
<td>Usar <code>patchValue()</code> o assegurar que TOTS els camps hi són</td>
</tr>
<tr>
<td>Controls no es reinicien</td>
<td><code>reset()</code> sense passar objecte amb valors</td>
<td>Passar objecte amb valors inicials: <code>reset({ campo: '' })</code></td>
</tr>
<tr>
<td>Botó eliminar no funciona</td>
<td>Índex incorrecte o no actualitzat</td>
<td>Usar <code>let i = index</code> a *ngFor i passar <code>i</code> a mètode</td>
</tr>
<tr>
<td>FormArray sempre buit després d'eliminar tot</td>
<td>No es recrea FormArray després de <code>.clear()</code></td>
<td>Després de <code>.clear()</code> fer <code>.push(crearControl())</code></td>
</tr>
</tbody>
</table>
<h4>3.13.2. Errors de configuració</h4>
<table class="table table-bordered">
<thead>
<tr>
<th>Error</th>
<th>Solució Windows</th>
<th>Solució Linux/macOS</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>formArrayName must be used with parent formGroup</code></td>
<td>Assegurar <code>&lt;form [formGroup]="formulari"&gt;</code> envolta</td>
<td>Assegurar <code>&lt;form [formGroup]="formulari"&gt;</code> envolta</td>
</tr>
<tr>
<td><code>Cannot read property 'at' of undefined</code></td>
<td>Verificar <code>get variants(): FormArray</code> retorna correctament</td>
<td>Verificar <code>get variants(): FormArray</code> retorna correctament</td>
</tr>
<tr>
<td><code>Expected validator to return Promise or Observable</code></td>
<td>FormArray no suporta validadors asíncrons nativamente</td>
<td>FormArray no suporta validadors asíncrons nativamente</td>
</tr>
<tr>
<td>TypeScript error: <code>Type 'AbstractControl' is not assignable to 'FormGroup'</code></td>
<td>Usar <code>as FormGroup</code> o <code>as FormArray</code> explícitament</td>
<td>Usar <code>as FormGroup</code> o <code>as FormArray</code> explícitament</td>
</tr>
<tr>
<td><code>removeAt() index out of range</code></td>
<td>Comprovar <code>if (index >= 0 && index &lt; array.length)</code></td>
<td>Comprovar <code>if (index >= 0 && index &lt; array.length)</code></td>
</tr>
</tbody>
</table>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.14. Prompts d'IA</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Expert Angular FormArray. <strong>Context:</strong> Estic dissenyant un formulari de comanda amb múltiples productes que es poden afegir dinàmicament. <strong>Tasca:</strong> Genera una taula comparativa completa entre FormGroup, FormArray i FormControl amb cas d'ús, sintaxi, accés a valors, validacions, quan usar cada un i exemples de codi per cada estructura. <strong>Format:</strong> Taula amb 7 columnes i exemples de codi TypeScript per cada fila.</div>
  </div>
</div>


<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Arquitecte de formularis complexos Angular. <strong>Context:</strong> Necessito implementar un formulari d'inscripció a esdeveniment amb assistents dinàmics i preferències alimentàries. <strong>Tasca:</strong> Crea un checklist exhaustiu de 20 punts per validar que un formulari complex amb FormArrays funciona correctament abans de passar a producció, incloent: estructura correcta, validacions, gestió d'errors, límits, performance, accessibilitat i testing. <strong>Format:</strong> Llista numerada amb descripció detallada de cada punt.</div>
  </div>
</div>


<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Expert en gestió d'estat Angular. <strong>Context:</strong> Tinc un formulari amb FormArray i FormGroup niat i necessito entendre com gestionar valors. <strong>Tasca:</strong> Explica amb exemples de codi detallats les diferències entre <code>setValue()</code>, <code>patchValue()</code> i <code>reset()</code>, incloent quan usar cada un, errors comuns, comportament amb FormArrays niuats i com gestionar valors parcials. Proporciona 3 casos d'ús reals per cada mètode. <strong>Format:</strong> Guia amb taula comparativa i 9 exemples de codi comentats.</div>
  </div>
</div>


<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Desenvolupador Angular senior. <strong>Context:</strong> Estic creant un formulari de catàleg amb variants dinàmiques de producte. <strong>Tasca:</strong> Genera un formulari Angular complet d'inscripció a esdeveniment amb: dades personals (FormGroup niat amb nom, cognoms, email, telèfon), múltiples assistents (FormArray de FormGroups amb nom, edat, dieta), preferències alimentàries (FormArray de FormControls), validacions creuades entre camps, límits (mínim 1 assistent, màxim 10), i gestió completa amb afegir/eliminar. <strong>Format:</strong> Codi TypeScript complet del component + template HTML + validadors personalitzats.</div>
  </div>
</div>


<!-- Component: Prompt per IA amb caixa de text i botó de còpia -->
<div class="ai-prompt" role="note">
  <div class="component-header ai-header" role="heading" aria-level="4">
    <i class="bi bi-robot" aria-hidden="true"></i> Prompt per IA
    <div class="ai-actions">
      <button type="button" class="copy-btn" title="Copiar prompt" aria-label="Copiar prompt">
        <i class="bi bi-clipboard" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div class="ai-container">
    <div class="ai-prompt-content" aria-label="Text del prompt"><strong>Rol:</strong> Expert en patrons avançats Angular. <strong>Context:</strong> Necessito optimitzar formularis amb FormArrays grans i implementar funcionalitats avançades. <strong>Tasca:</strong> Descriu 7 patrons avançats per gestionar FormArrays: 1) reordenar elements amb drag & drop, 2) validacions creuades entre elements del FormArray, 3) auto-guardat temporal a localStorage, 4) duplicar elements existents, 5) límits dinàmics segons altres camps, 6) performance optimization amb trackBy i OnPush, 7) exportar/importar FormArray com JSON. Per cada patró proporciona explicació, cas d'ús, codi TypeScript complet i avantatges/inconvenients. <strong>Format:</strong> 7 seccions amb codi executable i taula resum final.</div>
  </div>
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.15. Autoavaluació</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<h4>Conceptes teòrics</h4>
<!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Comprenc la diferència entre FormArray i FormGroup</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Entenc quan usar FormArray (col·leccions dinàmiques) vs FormGroup (agrupació lògica)</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé què és el mètode factory per crear controls dinàmics</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Comprenc les diferències entre setValue(), patchValue() i reset()</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Entenc com niuar FormGroups dins d'altres FormGroups per organització lògica</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>

<h4>Habilitats pràctiques</h4>

<!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc crear FormArray amb <code>fb.array([...])</code> de FormControls o FormGroups</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé afegir controls amb <code>.push(nouControl)</code> dinàmicament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc eliminar controls amb <code>.removeAt(index)</code> i gestionar índexs</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé accedir a controls amb <code>.at(index)</code> i iterar amb <code>.controls</code></div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc crear FormGroups niuats per organitzar camps relacionats</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé aplicar validacions a FormArray complet (minLength, maxLength)</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc validar cada control dins FormArray individualment</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé mostrar errors tant a nivell FormArray com FormControl</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc implementar mètodes factory per crear controls consistents</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé gestionar límits (mínim/màxim) amb botons deshabilitant</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Entenc com usar trackBy per optimitzar *ngFor en FormArrays grans</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc marcar tots els controls com a tocats abans d'enviar</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé quan usar setValue() (TOTS els camps) vs patchValue() (ALGUNS camps)</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc usar reset() per netejar formulari amb valors opcionals</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé carregar formularis complexos des d'API amb setValue</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>

<h4>Resolució de problemes</h4>
<!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Sé diagnosticar error 'Cannot find control with name'</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Puc solucionar problemes de setValue() amb camps faltants</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Entenc com gestionar índexs correctament després d'eliminar controls</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>

  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.16. Síntesi</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<p>Disposeu de formularis complexos completament funcionals amb estructures jeràrquiques mitjançant FormGroups niuats per organitzar camps relacionats lògicament com adreces amb carrer ciutat i codi postal agrupats amb accés net utilitzant notació punt i validacions a nivell de grup, i col·leccions dinàmiques amb FormArrays que permeten a l'usuari afegir o eliminar controls en temps d'execució per gestionar múltiples telèfons emails o variants de producte amb límits mínim i màxim implementats i feedback visual. El projecte inclou mètodes factory com crearVariant i crearTelefon que centralitzen la configuració de controls amb validacions i valors per defecte facilitant el manteniment amb un sol lloc per canviar la lògica, gestió precisa de valors dominant setValue per càrrega completa des d'API patchValue per actualitzacions parcials de camps específics i reset per neteja amb valors inicials personalitzats segons cada necessitat, validacions completes aplicades a FormArray complet amb minLength i maxLength a controls individuals dins el FormArray i validadors custom per duplicats amb missatges contextuals per cada nivell, patrons de performance amb trackBy en ngFor per optimitzar renderitzat getters per accés eficient i marcar controls tocats abans d'enviar per mostrar tots els errors, i documentació exhaustiva amb taules d'estructures utilitzades patrons implementats bones pràctiques proves realitzades i decisions de disseny registrades al dossier tècnic. La base de formularis complexos establerta serveix com a fonament per qualsevol aplicació professional amb requisits dinàmics i adaptatius.</p>
  
  </div>
</div>


  
  <!-- Component: Punt destacat dins d'una secció -->


<div class="section-point" >
  <div class="component-header section-point-header" role="heading" aria-level="4">
    <i class="bi bi-journal-text" aria-hidden="true"></i>
    <div class="section-point-meta">
      <div class="section-point-title">3.17. Repàs de conceptes</div>
      
    </div>
  </div>
  <div class="section-point-body component-content">
    
<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>FormArray:</strong> Col·lecció dinàmica: <code>fb.array([control1, control2])</code>. Afegir: <code>.push(nouControl)</code>. Eliminar: <code>.removeAt(index)</code>. Accés: <code>.at(index)</code> o <code>.controls[index]</code>. Neteja: <code>.clear()</code>.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>FormGroup niat:</strong> Estructura jeràrquica: <code>fb.group({ grup: fb.group({...}) })</code>. Accés: notació punt <code>.get('grup.camp')</code> o encadenament <code>.get('grup')?.get('camp')</code>. Template: <code>formGroupName="nom"</code>. Organització: agrupar camps relacionats lògicament.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>Mètodes factory:</strong> Funció que retorna FormGroup o FormControl. Centralitza configuració i validacions. Exemple: <code>crearTelefon(): FormGroup { return fb.group({...}) }</code>. Reutilitzable i testejable.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>setValue vs patchValue vs reset:</strong> setValue: assignar TOTS els camps (error si falta algun). patchValue: assignar ALGUNS camps (altres no modificats). reset: netejar amb valors opcionals inicials.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>Validacions:</strong> FormArray complet: <code>fb.array([...], [Validators.minLength(1)])</code>. Control individual: validacions a cada FormControl del factory. FormGroup dins FormArray: validadors a nivell grup.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>Template FormArray:</strong> <code>formArrayName="nom"</code> al contenidor. <code>*ngFor="let item of items.controls; let i = index"</code>. <code>[formGroupName]="i"</code> per FormGroups dins FormArray. <code>[formControlName]="i"</code> per FormControls dins FormArray.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>Patrons:</strong> TrackBy: optimitzar *ngFor amb <code>trackBy: trackByIndex</code>. Límits: deshabilitar botons quan assoleixen min/max. Marcar tocats: iterar controls abans d'enviar. Getters: accés net a FormArray i FormGroups.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.push():</strong> Afegir control al final del FormArray: <code>formArray.push(nouControl)</code>.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.removeAt(i):</strong> Eliminar control a l'índex i: <code>formArray.removeAt(2)</code>. Els índexs es recalculen automàticament.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.at(i):</strong> Accedir a control a l'índex i: <code>formArray.at(0)</code>. Retorna AbstractControl.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>.clear():</strong> Buidar FormArray completament: <code>formArray.clear()</code>. Normalment seguit de <code>.push()</code> per afegir control buit.</p>
  </div>
</div>


<!-- Component: Definició curta -->
<div class="definition-box" role="definition" aria-label="Definició">
  <div class="component-header info-header" role="heading" aria-level="4"><i class="bi bi-journal-text" aria-hidden="true"></i> Definició</div>
  <div class="component-content">
    <p><strong>trackBy:</strong> Funció per optimitzar *ngFor: <code>trackBy: trackByIndex</code>. Evita recrear DOM innecessàriament.</p>
  </div>
</div>

  
  </div>
</div>


</div>


<!-- Exercicis proposats (si estan definits) -->


<!-- Recursos addicionals -->


<!-- Glossari del bloc -->



<!-- Schema.org structured data per SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "name": "Bloc 3: Formularis reactius i validacions",
  "description": "FormGroup, FormControl, FormBuilder i validadors integrats per gestió avançada de formularis",
  "author": {
    "@type": "Organization",
    "name": "Institut Obert de Catalunya"
  },
  "provider": {
    "@type": "Organization",
    "name": "Institut Obert de Catalunya"
  },
  "educationalLevel": "Intermediate",
  "learningResourceType": "Course Module",
  "inLanguage": "ca",
  
  
  "isPartOf": {
    "@type": "Course",
    "name": "DA2_OA01 - Programació Avançada (Angular) — IOC",
    "description": "Materials del mòdul DA2_OA01 - Programació Avançada amb Angular"
  }
}
</script>

                </div>
            </article>
            
            <!-- Navegació entre pàgines -->
            
            <nav class="page-navigation" role="navigation" aria-label="Navegació entre blocs">
                <div class="nav-links-container">
                    
                    
                    
                    
                    
                    
                    
                    
                        
                    
                        
                    
                        
                            
                            
                    
                    
                    
                        
                            
                        
                            
                        
                            
                                
                                
                                
                                
                                
                                    
                                    
                                        
                                    
                                        
                                            
                                            
                                
                                
                                
                                
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        
                                        
                                
                                
                    
                    
                    <div class="nav-link-wrapper">
                        
                        <a href="/ioc/da2_OA01/unitat-3/bloc-2/" class="nav-button" aria-label="Bloc anterior: Gestió d'estat i comunicació entre components">← Anterior</a>
                        
                    </div>
                    
                    <div class="nav-link-wrapper">
                        
                        <a href="/ioc/da2_OA01/unitat-3/bloc-4/" class="nav-button" aria-label="Bloc següent: Cas d'ús: Catàleg amb API REST">Següent →</a>
                        
                    </div>
                </div>
            </nav>
            
        </main>
    </div>

    <!-- Footer fix -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-info">
                Versió v1.0
            </div>
            <div class="footer-progress" aria-label="Progrés de lectura"><!-- Progrés per unitats (posició de la unitat actual) --><div class="progress-group course-progress">
                    <span class="progress-label">Unitat</span>
                    <span class="progress-text" data-pos="3" data-total="4">(3/4)</span>
                    <div class="progress-bar-footer"><div class="progress-fill-footer" style="width: 75%"></div></div>
                </div><!-- Progrés per blocs dins de la unitat --><div class="progress-group unit-progress">
                        <span class="progress-label">Bloc</span>
                        <span class="progress-text" data-pos="3" data-total="4">(3/4)</span>
                        <div class="progress-bar-footer"><div class="progress-fill-footer" style="width: 75%"></div></div>
                    </div>

                    <!-- Progrés per seccions (H2) dins del bloc --><div class="progress-group section-progress" data-scan-sections="true">
                        <span class="progress-label">Secció</span>
                        <span class="progress-text" data-pos="1" data-total="3">(1/3)</span>
                        <div class="progress-bar-footer"><div class="progress-fill-footer" style="width: 33%"></div></div>
                    </div></div>
            <div class="footer-actions" aria-label="Accions ràpides">
                <button class="task-btn footer-collapse-toggle" type="button" aria-expanded="true" aria-label="Amaga el peu de pàgina">
                  <i class="bi bi-chevron-down" aria-hidden="true"></i>
                </button>
                <a href="#top" id="footer-btn-top" class="task-btn" aria-label="Anar a l'inici">↑</a>
                <a href="#bottom" id="footer-btn-bottom" class="task-btn" aria-label="Anar al final">↓</a>
                <a href="#next" id="footer-btn-next" class="task-btn" aria-label="Secció següent">→</a>
                <a href="#prev" id="footer-btn-prev" class="task-btn" aria-label="Secció anterior">←</a>
                <a href="#bookmark" id="footer-btn-bookmark" class="task-btn" aria-label="Desar marcador" title="Desar marcador">
                  <i class="bi bi-bookmark" aria-hidden="true"></i>
                </a>
                <a href="/ioc/da2_OA01/quadern.html" class="task-btn" aria-label="Obrir quadern complet" title="Quadern">
                  <i class="bi bi-journal-text" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </footer>

    <!-- Scripts del lloc -->
    <script src="/ioc/da2_OA01/assets/js/site.js" defer></script>
    <!-- Quadern Notes v2 (nou sistema) -->
    <script src="/ioc/da2_OA01/assets/js/quadern-app/constants.js" defer></script>
    <script src="/ioc/da2_OA01/assets/js/quadern-app/utils.js" defer></script>
    <script src="/ioc/da2_OA01/assets/js/quadern-app/store.js" defer></script>
    <script src="/ioc/da2_OA01/assets/js/quadern-app/panel.js" defer></script>
    <script src="/ioc/da2_OA01/assets/js/index-notes.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" defer></script>
    <script src="/ioc/da2_OA01/assets/js/quadern-app/rich-editor.js" defer></script>
    <script>
      document.addEventListener('DOMContentLoaded', function(){
        if (window.Quadern && typeof window.Quadern.bootstrapNotes === 'function') {
          try { window.Quadern.bootstrapNotes(); } catch(e) {}
        }
        if (window.Quadern && window.Quadern.RichEditor && typeof window.Quadern.RichEditor.autoInit === 'function') {
          try { window.Quadern.RichEditor.autoInit(); } catch(e) {}
        }
      });
    </script>
</body>
</html>
