<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <title>Cas d'ús: Aplicació completa amb navegació i optimització | DA2_OA01 - Programació Avançada (Angular) - IOC</title>
    <meta name="description" content="Material educatiu - Institut Obert de Catalunya">
    <meta name="page-unitat" content="4">
    <meta name="page-bloc" content="4">
    
    <!-- SEO Tags -->
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Cas d’ús: Aplicació completa amb navegació i optimització | DA2_OA01 - Programació Avançada (Angular)</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Cas d’ús: Aplicació completa amb navegació i optimització" />
<meta property="og:locale" content="ca_ES" />
<meta name="description" content="Materials del mòdul DA2_OA01 - Programació Avançada amb Angular" />
<meta property="og:description" content="Materials del mòdul DA2_OA01 - Programació Avançada amb Angular" />
<link rel="canonical" href="http://localhost:4006/ioc/da2_oa01/unitat-4/bloc-4/" />
<meta property="og:url" content="http://localhost:4006/ioc/da2_oa01/unitat-4/bloc-4/" />
<meta property="og:site_name" content="DA2_OA01 - Programació Avançada (Angular)" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Cas d’ús: Aplicació completa amb navegació i optimització" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Materials del mòdul DA2_OA01 - Programació Avançada amb Angular","headline":"Cas d’ús: Aplicació completa amb navegació i optimització","url":"http://localhost:4006/ioc/da2_oa01/unitat-4/bloc-4/"}</script>
<!-- End Jekyll SEO tag -->

    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/ioc/da2_oa01/assets/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="canonical" href="http://localhost:4006/ioc/da2_oa01/unitat-4/bloc-4/">
    <!-- Rich editor styles (for embedded notes panel) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.snow.min.css">
    <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css" disabled>
    <link rel="stylesheet" href="/ioc/da2_oa01/assets/css/quadern-rich-editor.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/ioc/da2_oa01/assets/images/favicon.ico">
    
    <!-- RSS Feed -->
    <link type="application/atom+xml" rel="alternate" href="http://localhost:4006/ioc/da2_oa01/feed.xml" title="DA2_OA01 - Programació Avançada (Angular)" />

    <!-- Syntax Highlighting (Prism) -->
    <link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-java.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-jsx.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-html.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-tsx.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>

    <!-- Code Block Component -->
    <link rel="stylesheet" href="/ioc/da2_oa01/assets/css/code-block.css">
    <script src="/ioc/da2_oa01/assets/js/code-block.js"></script>

</head>

<body class="bloc-layout">
    <!-- Skip to content for accessibility -->
    <a class="skip-link" href="#main-content">Salta al contingut principal</a>


    
    <!-- Header fix -->
    <header class="header" role="banner" id="top">
        <div class="header-brand">
            <a href="/ioc/da2_oa01/" class="logo-link" aria-label="Inici">
                <img src="/ioc/da2_oa01/assets/images/logo_IOC_light.jpg" alt="Institut Obert de Catalunya" class="logo logo-light">
                <img src="/ioc/da2_oa01/assets/images/logo_IOC_dark.png" alt="Institut Obert de Catalunya" class="logo logo-dark">
            </a>
            <a href="/ioc/da2_oa01/" class="title-link">
                <h1>DA2_OA01 - DA2_OA01 - Programació Avançada (Angular)</h1>
            </a>
        </div>
        <div class="header-actions">
            <button class="theme-toggle" id="theme-toggle">Mode Fosc</button>
            <button class="nav-panel-toggle" type="button" aria-expanded="false" aria-label="Obre la navegació">
                <i class="bi bi-list" aria-hidden="true"></i>
                <span class="nav-panel-label">Navegació</span>
            </button>
        </div>
    </header>

    <div class="offcanvas-backdrop" hidden></div>
    <nav class="offcanvas-nav" aria-hidden="true" aria-label="Navegació del curs">
        <div class="offcanvas-header">
            <h2 class="offcanvas-title">Navegació</h2>
            <button class="offcanvas-close" type="button" aria-label="Tanca la navegació">
                <i class="bi bi-x-lg" aria-hidden="true"></i>
            </button>
        </div>
        <div class="offcanvas-body">
            <a href="/ioc/da2_oa01/" class="nav-dropdown-item ">Índex del Curs</a>
            
                
                    <a href="/ioc/da2_oa01/unitat-1/bloc-1/" class="nav-dropdown-item ">
                        Unitat 1 - Bloc 1: Conceptes fonamentals i instal·lació
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-1/bloc-2/" class="nav-dropdown-item ">
                        Unitat 1 - Bloc 2: Entorn de desenvolupament integrat
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-1/bloc-3/" class="nav-dropdown-item ">
                        Unitat 1 - Bloc 3: Creació del projecte base
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-1/bloc-4/" class="nav-dropdown-item ">
                        Unitat 1 - Bloc 4: Cas d'ús: Preparació de l'entorn
                    </a>
                
            
                
                    <a href="/ioc/da2_oa01/unitat-2/bloc-1/" class="nav-dropdown-item ">
                        Unitat 2 - Bloc 1: Components i comunicació bàsica
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-2/bloc-2/" class="nav-dropdown-item ">
                        Unitat 2 - Bloc 2: Data binding i events
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-2/bloc-3/" class="nav-dropdown-item ">
                        Unitat 2 - Bloc 3: Formularis amb vinculació bidireccional
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-2/bloc-4/" class="nav-dropdown-item ">
                        Unitat 2 - Bloc 4: Cas d'ús: Catàleg d'elements
                    </a>
                
            
                
                    <a href="/ioc/da2_oa01/unitat-3/bloc-1/" class="nav-dropdown-item ">
                        Unitat 3 - Bloc 1: Serveis i separació de responsabilitats
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-3/bloc-2/" class="nav-dropdown-item ">
                        Unitat 3 - Bloc 2: Gestió d'estat i comunicació entre components
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-3/bloc-3/" class="nav-dropdown-item ">
                        Unitat 3 - Bloc 3: Optimització i bones pràctiques
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-3/bloc-4/" class="nav-dropdown-item ">
                        Unitat 3 - Bloc 4: Cas d'ús: Catàleg amb API REST
                    </a>
                
            
                
                    <a href="/ioc/da2_oa01/unitat-4/bloc-1/" class="nav-dropdown-item ">
                        Unitat 4 - Bloc 1: Sistema de rutes i navegació
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-4/bloc-2/" class="nav-dropdown-item ">
                        Unitat 4 - Bloc 2: Arquitectura escalable
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-4/bloc-3/" class="nav-dropdown-item ">
                        Unitat 4 - Bloc 3: Optimització de rendiment
                    </a>
                
                    <a href="/ioc/da2_oa01/unitat-4/bloc-4/" class="nav-dropdown-item current">
                        Unitat 4 - Bloc 4: Cas d'ús: Aplicació completa
                    </a>
                
            
        </div>
    </nav>

    <div class="container">
        <!-- Sidebar Navegació -->
        
        <aside class="sidebar">
            <button class="sidebar-toggle" type="button" aria-expanded="false">
                <span>Contingut del bloc</span>
                <i class="bi bi-chevron-down" aria-hidden="true"></i>
            </button>
            <div class="sidebar-scroll">
                <!-- Contingut d'aquest Bloc -->
                <div class="sidebar-section">
                    <h3>Contingut del Bloc</h3>
                    

    
    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio0" class="nav-link" data-section="Unitat4_Bloc4_Seccio0">Introducció</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio1" class="nav-link" data-section="Unitat4_Bloc4_Seccio1">1. Prerequisits</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio2" class="nav-link" data-section="Unitat4_Bloc4_Seccio2">2. Visió general de l'aplicació</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio3" class="nav-link" data-section="Unitat4_Bloc4_Seccio3">3. Sistema de rutes complet</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio4" class="nav-link" data-section="Unitat4_Bloc4_Seccio4">4. Vista de detall amb paràmetres</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio5" class="nav-link" data-section="Unitat4_Bloc4_Seccio5">5. Guàrdies i gestió d'estat</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio6" class="nav-link" data-section="Unitat4_Bloc4_Seccio6">6. Modularització i lazy loading</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio7" class="nav-link" data-section="Unitat4_Bloc4_Seccio7">7. Optimitzacions de rendiment</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio8" class="nav-link" data-section="Unitat4_Bloc4_Seccio8">8. Verificació i build de producció</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio9" class="nav-link" data-section="Unitat4_Bloc4_Seccio9">9. Autoavaluació</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    
        
        
        
        
        
        
        
        <div class="nav-item">
            <a href="#Unitat4_Bloc4_Seccio10" class="nav-link" data-section="Unitat4_Bloc4_Seccio10">10. Recapitulació</a>
        </div>
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    



                </div>
            </div>
        </aside>
        

        <main class="main-content" role="main" id="main-content">
            
            <!-- Navegació horizontal -->
            
            <nav class="horizontal-nav" aria-label="Navegació de ruta">
                <div class="horizontal-nav-list">
                    <a href="/ioc/da2_oa01/" class="horizontal-nav-item">Inici</a>
                    
                    
                        
                        
                            
                        
                            
                        
                            
                        
                            
                                
                                
                        
                        
                            <span class="horizontal-nav-separator"> &gt; </span>
                            <a href="/ioc/da2_oa01/unitat-4/" class="horizontal-nav-item">
                                Unitat 4: Navegació i arquitectura d'aplicacions (RA4)
                            </a>
                        
                        
                        
                            
                            
                                
                            
                                
                            
                                
                            
                                
                                    
                                    
                            
                            
                                <span class="horizontal-nav-separator"> &gt; </span>
                                <span class="horizontal-nav-item current">
                                    Bloc 4.4: Cas d'ús: Aplicació completa
                                </span>
                            
                        
                    
                </div>
            </nav>
            
            
            <!-- Contingut de la Pàgina -->
            <article class="page-content">
                <div class="content-body">
                    

<!-- Objectius del bloc (si estan definits al frontmatter) -->


<!-- Contingut principal -->
<!-- SECCIÓ 0: Introducció -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio0">
  <h2 id="Unitat4_Bloc4_Seccio0">Introducció</h2>

  <!-- MULTIMÈDIA -->
  <!--
  ════════════════════════════════════════════════════════════════
  Component: Enllaços multimèdia YouTube
  ════════════════════════════════════════════════════════════════

  Paràmetres:
    - unitat: número de la unitat (1-4)
    - bloc: número del bloc (1-4)
    - seccio: número de la secció (1-3)

  Exemple d'ús:
    {% include multimedia-youtube.html unitat=1 bloc=1 seccio=1 %}

  El component busca automàticament les URLs corresponents a
  site.data.multimedia i mostra els botons de vídeo i àudio.
  ════════════════════════════════════════════════════════════════
-->





  
  
  
  
  

  

  

  
<div class="multimedia-resources">
  <div class="multimedia-header">
    <i class="bi bi-play-circle-fill"></i>
    <span>Contingut multimèdia d'aquesta lectura</span>
  </div>

  <div class="multimedia-buttons">
    
    <a href="https://www.youtube.com/watch?v=HYJWQZXbj9c" target="_blank" rel="noopener noreferrer" class="multimedia-btn video-btn" title="Cas d'ús 4.4 · Aplicació completa amb navegació i optimització">
      <i class="bi bi-youtube"></i>
      <span>Veure vídeo</span>
      <i class="bi bi-box-arrow-up-right"></i>
    </a>
    

    
    <a href="https://www.youtube.com/watch?v=ICJFOTyyJ-Q" target="_blank" rel="noopener noreferrer" class="multimedia-btn audio-btn" title="[Audio] Cas d'ús 4.4 · Aplicació completa amb navegació i optimització">
      <i class="bi bi-mic-fill"></i>
      <span>Escoltar àudio</span>
      <i class="bi bi-box-arrow-up-right"></i>
    </a>
    
  </div>

  
  
</div>
  



  <div class="info_box">
    <p>En aquest cas d'ús pràctic, integrareu tots els conceptes treballats al llarg del mòdul per construir una aplicació completa de catàleg d'elements amb Angular. Desenvolupareu "Catàleg Universal", una SPA amb navegació multi-pàgina, arquitectura organitzada, optimitzacions de rendiment aplicades i desplegament a producció.</p>

    <p>Aquest cas d'ús representa el projecte final integrador que us permetrà aplicar els coneixements adquirits sobre entorn de desenvolupament, components, serveis, rutes, arquitectura modular i optimització en un context professional complet.</p>
  </div>

  <h3>Objectius</h3>

  <p>En finalitzar aquest cas d'ús, hauríeu de ser capaços de:</p>

  <ul>
    <li>Configurar un sistema de rutes complet amb múltiples vistes i navegació entre elles</li>
    <li>Capturar i gestionar paràmetres de ruta per vistes de detall</li>
    <li>Implementar autenticació simulada amb gestió d'estat d'usuari</li>
    <li>Crear guàrdies de ruta per protegir seccions privades de l'aplicació</li>
    <li>Modularitzar l'aplicació amb lazy loading per optimitzar la càrrega</li>
    <li>Aplicar estratègies de detecció de canvis (OnPush) per millorar el rendiment</li>
    <li>Implementar virtualització per llistes grans amb Angular CDK</li>
    <li>Compilar l'aplicació per a producció i analitzar el bundle generat</li>
  </ul>

  <h3>Criteris d'avaluació (RA4)</h3>

  <p>Aquest cas d'ús cobreix els següents criteris del <strong>Resultat d'Aprenentatge 4</strong>:</p>

  <ul>
    <li><strong>RA4.1:</strong> S'ha configurat la navegació entre pantalles i la gestió de paràmetres de ruta</li>
    <li><strong>RA4.2:</strong> S'ha implementat un flux d'inici de sessió i control d'accés bàsic basat en serveis</li>
    <li><strong>RA4.3:</strong> S'han aplicat mecanismes per preservar l'estat d'usuari i protegir seccions privades</li>
    <li><strong>RA4.4:</strong> S'han optimitzat els recursos i generat un paquet llest per a publicació</li>
    <li><strong>RA4.5:</strong> S'ha verificat el funcionament global i documentat el procés adequadament</li>
  </ul>

  <h3>Lectures integrades</h3>

  <p>Aquest cas d'ús integra els continguts de totes les unitats del mòdul:</p>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>Unitat</th>
        <th>Tema</th>
        <th>Aplicació en el cas d'ús</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Unitat 1</strong></td>
        <td>Entorn de desenvolupament</td>
        <td>Creació de projecte, estructura de carpetes, Git i control de versions</td>
      </tr>
      <tr>
        <td><strong>Unitat 2</strong></td>
        <td>Components i interfície</td>
        <td>Components reutilitzables, directives, vinculació de dades, formularis bàsics</td>
      </tr>
      <tr>
        <td><strong>Unitat 3</strong></td>
        <td>Serveis i integració</td>
        <td>HttpClient, comunicació amb APIs, gestió d'errors, models i estat reactiu</td>
      </tr>
      <tr>
        <td><strong>Unitat 4</strong></td>
        <td>Navegació i optimització</td>
        <td>Routing, paràmetres, guàrdies, lazy loading, OnPush, virtualització, build</td>
      </tr>
    </tbody>
  </table>

  <h3>Descripció de l'aplicació</h3>

  <p>Creareu <strong>"Catàleg Universal"</strong>, una aplicació SPA amb les següents característiques:</p>

  <h4>Funcionalitats principals</h4>

  <ul>
    <li>Llistat de 100 elements amb cerca i ordenació</li>
    <li>Vista de detall per a cada element amb paràmetres de ruta</li>
    <li>Secció de preferits protegida amb autenticació simulada</li>
    <li>Navegació fluida entre totes les vistes</li>
    <li>Rendiment optimitzat amb virtualització i OnPush</li>
    <li>Build de producció analitzat i preparat per desplegament</li>
  </ul>

  <h4>Arquitectura tècnica</h4>

  <ul>
    <li>Rutes principals: Home, Cerca, Detall, Preferits, Login</li>
    <li>Mòdul de preferits amb lazy loading</li>
    <li>Guàrdies de ruta per protecció d'accés</li>
    <li>Servei centralitzat d'estat d'usuari</li>
    <li>Components presentacionals i contenidors</li>
  </ul>

  <h4>Tecnologies utilitzades</h4>

  <ul>
    <li>Angular (versió actual del curs)</li>
    <li>Angular Router per navegació</li>
    <li>Angular CDK per virtualització</li>
    <li>JSONPlaceholder com API simulada</li>
    <li>Possibilitat de desplegament a Netlify o Vercel</li>
  </ul>

</div>

<!-- SECCIÓ 1: Prerequisits -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio1">
  <h2 id="Unitat4_Bloc4_Seccio1">1. Prerequisits</h2>

  <p>Abans de començar aquest cas d'ús, assegureu-vos que teniu:</p>

  <h3>1.1. Entorn preparat</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Angular CLI instal·lat i funcional</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Node.js i npm operatius</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">VS Code amb extensions d'Angular</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Git configurat amb repositori remot</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>1.2. Coneixements previs</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Unitat 1: Entorn de desenvolupament preparat</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Unitat 2: Components, directives i formularis</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Unitat 3: Serveis, HTTP i integració amb APIs</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Lectures 4.1, 4.2 i 4.3: Rutes, arquitectura i optimització</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>1.3. Verificació inicial</h3>

  <p>Executeu les següents comandes per assegurar-vos que el vostre entorn està llest:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">ng version
git --version
node --version
npm --version</code></pre>
  </div>
</div>


  <p><strong>Punt d'autocomprovació:</strong> Tots els comandaments han de retornar versions sense errors.</p>

</div>

<!-- SECCIÓ 2: Visió general de l'aplicació -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio2">
  <h2 id="Unitat4_Bloc4_Seccio2">2. Visió general de l'aplicació</h2>

  <h3>2.1. Estructura de rutes</h3>


<div class="code-block" data-lang="plaintext" role="region" aria-label="Bloc de codi plaintext">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">PLAINTEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-plaintext">/                       → HomeComponent (llistat complet)
/search                 → SearchComponent (cerca avançada)
/item/:id               → DetailComponent (detall amb ID)
/favorites              → FavoritesModule (lazy loaded, protegit)
  /favorites/list       → FavoritesListComponent
  /favorites/settings   → FavoritesSettingsComponent
/login                  → LoginComponent (autenticació simulada)
/404                    → NotFoundComponent</code></pre>
  </div>
</div>


  <h3>2.2. Arquitectura de components</h3>


<div class="code-block" data-lang="plaintext" role="region" aria-label="Bloc de codi plaintext">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">PLAINTEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-plaintext">AppComponent (contenidor principal)
├── HeaderComponent (navegació)
├── router-outlet (contingut dinàmic)
│   ├── HomeComponent
│   │   └── ItemCardComponent (presentacional)
│   ├── SearchComponent
│   │   ├── SearchFormComponent
│   │   └── ItemCardComponent
│   ├── DetailComponent
│   ├── FavoritesModule (lazy)
│   │   ├── FavoritesListComponent
│   │   └── FavoritesSettingsComponent
│   └── LoginComponent
└── FooterComponent</code></pre>
  </div>
</div>


  <h3>2.3. Serveis</h3>


<div class="code-block" data-lang="plaintext" role="region" aria-label="Bloc de codi plaintext">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">PLAINTEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-plaintext">CoreModule
├── ItemService (gestió d&#39;elements)
├── AuthService (autenticació simulada)
├── StateService (estat global)
└── FavoriteService (gestió de preferits)

SharedModule
├── LoaderComponent
├── ErrorComponent
└── ItemCardComponent</code></pre>
  </div>
</div>


</div>

<!-- SECCIÓ 3: Sistema de rutes complet -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio3">
  <h2 id="Unitat4_Bloc4_Seccio3">3. Sistema de rutes complet</h2>

  <div class="info_box">
    <p><strong>Objectiu:</strong> Configurar el sistema de rutes principal amb totes les vistes, crear components bàsics per a cada ruta i implementar navegació funcional amb menú actiu.</p>
  </div>

  <h3>3.1. Crear projecte i estructura base</h3>

  <p>Creeu un nou projecte Angular amb routing habilitat i organitzeu l'estructura de carpetes:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Crear nou projecte Angular amb routing
ng new cataleg-universal --routing --style=css --skip-git
cd cataleg-universal

# Crear estructura de carpetes
mkdir -p src/app/core/services
mkdir -p src/app/core/guards
mkdir -p src/app/core/models
mkdir -p src/app/shared/components
mkdir -p src/app/features/home
mkdir -p src/app/features/search
mkdir -p src/app/features/detail
mkdir -p src/app/features/login

# Verificar que ng serve arrenca
ng serve</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Projecte creat sense errors</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Estructura de carpetes organitzada</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Servidor arrenca a http://localhost:4200</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>3.2. Crear components per a cada ruta</h3>

  <p>Genereu els components necessaris per a les diferents vistes de l'aplicació:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Components principals
ng generate component features/home --skip-tests
ng generate component features/search --skip-tests
ng generate component features/detail --skip-tests
ng generate component features/login --skip-tests
ng generate component shared/components/header --skip-tests
ng generate component shared/components/footer --skip-tests
ng generate component shared/components/item-card --skip-tests
ng generate component shared/components/not-found --skip-tests</code></pre>
  </div>
</div>


  <p>Verifiqueu que els components s'han creat correctament:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Llistar components creats
ls -la src/app/features/
ls -la src/app/shared/components/</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">8 components creats correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Fitxers .ts, .html, .css generats per cada component</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">No hi ha errors de compilació</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>3.3. Configurar rutes principals</h3>

  <p>Configureu el sistema de rutes a l'arxiu de routing principal:</p>

  <p><strong>Fitxer:</strong> <code>src/app/app-routing.module.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { NgModule } from &#39;@angular/core&#39;;
import { RouterModule, Routes } from &#39;@angular/router&#39;;
import { HomeComponent } from &#39;./features/home/home.component&#39;;
import { SearchComponent } from &#39;./features/search/search.component&#39;;
import { DetailComponent } from &#39;./features/detail/detail.component&#39;;
import { LoginComponent } from &#39;./features/login/login.component&#39;;
import { NotFoundComponent } from &#39;./shared/components/not-found/not-found.component&#39;;

const routes: Routes = [
  { path: &#39;&#39;, redirectTo: &#39;/home&#39;, pathMatch: &#39;full&#39; },
  { path: &#39;home&#39;, component: HomeComponent },
  { path: &#39;search&#39;, component: SearchComponent },
  { path: &#39;item/:id&#39;, component: DetailComponent },
  { path: &#39;login&#39;, component: LoginComponent },
  {
    path: &#39;favorites&#39;,
    loadChildren: () =&gt; import(&#39;./features/favorites/favorites.module&#39;).then(m =&gt; m.FavoritesModule)
    // Nota: crearem aquest mòdul més endavant
  },
  { path: &#39;404&#39;, component: NotFoundComponent },
  { path: &#39;**&#39;, redirectTo: &#39;/404&#39; }
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule { }</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Rutes definides correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Redirect a /home funciona</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Ruta 404 configurada per paths no existents</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>3.4. Implementar navegació al header</h3>

  <p>Creeu un component de capçalera amb navegació funcional i enllaços actius:</p>

  <p><strong>Fitxer:</strong> <code>src/app/shared/components/header/header.component.html</code></p>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;header class=&quot;header&quot;&gt;
  &lt;div class=&quot;container&quot;&gt;
    &lt;h1 class=&quot;logo&quot;&gt;
      &lt;a routerLink=&quot;/home&quot;&gt;Catàleg Universal&lt;/a&gt;
    &lt;/h1&gt;

    &lt;nav class=&quot;nav&quot;&gt;
      &lt;a routerLink=&quot;/home&quot; routerLinkActive=&quot;active&quot; [routerLinkActiveOptions]=&quot;{exact: true}&quot; class=&quot;nav-link&quot;&gt;Inici&lt;/a&gt;
      &lt;a routerLink=&quot;/search&quot; routerLinkActive=&quot;active&quot; class=&quot;nav-link&quot;&gt;Cerca&lt;/a&gt;
      &lt;a routerLink=&quot;/favorites&quot; routerLinkActive=&quot;active&quot; class=&quot;nav-link&quot;&gt;Preferits&lt;/a&gt;
      &lt;a routerLink=&quot;/login&quot; routerLinkActive=&quot;active&quot; class=&quot;nav-link&quot;&gt;Login&lt;/a&gt;
    &lt;/nav&gt;
  &lt;/div&gt;
&lt;/header&gt;</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/shared/components/header/header.component.css</code></p>


<div class="code-block" data-lang="css" role="region" aria-label="Bloc de codi css">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">CSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-css">.header {
  background: #2196F3;
  color: white;
  padding: 1rem 0;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.logo a {
  color: white;
  text-decoration: none;
  font-size: 1.5rem;
  font-weight: bold;
}

.nav {
  display: flex;
  gap: 2rem;
}

.nav-link {
  color: white;
  text-decoration: none;
  padding: 0.5rem 1rem;
  border-radius: 4px;
  transition: background-color 0.2s;
}

.nav-link:hover {
  background-color: rgba(255,255,255,0.1);
}

.nav-link.active {
  background-color: rgba(255,255,255,0.2);
  font-weight: bold;
}</code></pre>
  </div>
</div>


  <p>Actualitzeu el component arrel per incloure la navegació:</p>

  <p><strong>Fitxer:</strong> <code>src/app/app.component.html</code></p>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;app-header&gt;&lt;/app-header&gt;

&lt;main class=&quot;main-content&quot;&gt;
  &lt;router-outlet&gt;&lt;/router-outlet&gt;
&lt;/main&gt;

&lt;app-footer&gt;&lt;/app-footer&gt;</code></pre>
  </div>
</div>


  <p>Verifiqueu la navegació:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Arrencar aplicació
ng serve

# Provar al navegador:
# - Clicar cada enllaç del menú
# - Verificar que la ruta activa es destaca
# - Provar URL directa: http://localhost:4200/search
# - Verificar que 404 funciona: http://localhost:4200/invalid</code></pre>
  </div>
</div>


  <h3>Checkpoint</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Navegació funciona entre totes les rutes</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Enllaç actiu es destaca visualment</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Ruta 404 captura paths no existents</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">No hi ha errors a la consola</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Resolució de problemes</h3>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Problema</th>
        <th>Causa probable</th>
        <th>Solució</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Rutes no funcionen</td>
        <td>RouterModule no importat</td>
        <td>Verificar imports a app.module.ts</td>
      </tr>
      <tr>
        <td>404 no apareix</td>
        <td>Comodí mal configurat</td>
        <td>Verificar que <code>**</code> està al final</td>
      </tr>
      <tr>
        <td>Active class no funciona</td>
        <td>routerLinkActive mal escrit</td>
        <td>Verificar sintaxi exacta</td>
      </tr>
      <tr>
        <td>Components no es veuen</td>
        <td>router-outlet absent</td>
        <td>Afegir a app.component.html</td>
      </tr>
    </tbody>
  </table>

</div>

<!-- SECCIÓ 4: Vista de detall amb paràmetres -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio4">
  <h2 id="Unitat4_Bloc4_Seccio4">4. Vista de detall amb paràmetres</h2>

  <div class="info_box">
    <p><strong>Objectiu:</strong> Crear vista de detall que captura ID de la URL, consulta API per obtenir dades de l'element i mostra informació completa. Implementar navegació des del llistat al detall passant paràmetres.</p>
  </div>

  <h3>4.1. Crear model i servei d'elements</h3>

  <p>Definiu el model de dades i creeu el servei que consultarà l'API:</p>

  <p><strong>Fitxer:</strong> <code>src/app/core/models/item.model.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">export interface Item {
  id: number;
  title: string;
  body: string;
  userId: number;
}</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/core/services/item.service.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Injectable } from &#39;@angular/core&#39;;
import { HttpClient } from &#39;@angular/common/http&#39;;
import { Observable } from &#39;rxjs&#39;;
import { Item } from &#39;../models/item.model&#39;;

@Injectable({
  providedIn: &#39;root&#39;
})
export class ItemService {
  private apiUrl = &#39;https://jsonplaceholder.typicode.com/posts&#39;;

  constructor(private http: HttpClient) {}

  getAllItems(): Observable&lt;Item[]&gt; {
    return this.http.get&lt;Item[]&gt;(this.apiUrl);
  }

  getItemById(id: number): Observable&lt;Item&gt; {
    return this.http.get&lt;Item&gt;(`${this.apiUrl}/${id}`);
  }

  searchItems(query: string, items: Item[]): Item[] {
    const lowerQuery = query.toLowerCase();
    return items.filter(item =&gt;
      item.title.toLowerCase().includes(lowerQuery) ||
      item.body.toLowerCase().includes(lowerQuery)
    );
  }
}</code></pre>
  </div>
</div>


  <p>Importeu HttpClientModule al mòdul principal:</p>

  <p><strong>Fitxer:</strong> <code>src/app/app.module.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { HttpClientModule } from &#39;@angular/common/http&#39;;

@NgModule({
  imports: [
    BrowserModule,
    AppRoutingModule,
    HttpClientModule  // ← Afegir
  ],
  // ...
})
export class AppModule { }</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Model Item definit amb interfície</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">ItemService creat amb mètodes HTTP</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">HttpClientModule importat correctament</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>4.2. Implementar component de llistat</h3>

  <p>Desenvolupeu el component Home que mostra el llistat d'elements i permet navegar al detall:</p>

  <p><strong>Fitxer:</strong> <code>src/app/features/home/home.component.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Component, OnInit } from &#39;@angular/core&#39;;
import { Router } from &#39;@angular/router&#39;;
import { ItemService } from &#39;../../core/services/item.service&#39;;
import { Item } from &#39;../../core/models/item.model&#39;;

@Component({
  selector: &#39;app-home&#39;,
  templateUrl: &#39;./home.component.html&#39;,
  styleUrls: [&#39;./home.component.css&#39;]
})
export class HomeComponent implements OnInit {
  items: Item[] = [];
  loading = true;
  error = &#39;&#39;;

  constructor(
    private itemService: ItemService,
    private router: Router
  ) {}

  ngOnInit(): void {
    this.loadItems();
  }

  loadItems(): void {
    this.loading = true;
    this.itemService.getAllItems().subscribe({
      next: (data) =&gt; {
        this.items = data;
        this.loading = false;
      },
      error: (err) =&gt; {
        this.error = &#39;Error carregant elements&#39;;
        this.loading = false;
        console.error(err);
      }
    });
  }

  viewDetail(id: number): void {
    this.router.navigate([&#39;/item&#39;, id]);
  }

  trackByItemId(index: number, item: Item): number {
    return item.id;
  }
}</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/home/home.component.html</code></p>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div class=&quot;container&quot;&gt;
  &lt;h2&gt;Catàleg complet ({{ items.length }} elements)&lt;/h2&gt;

  &lt;!-- Loading --&gt;
  &lt;div *ngIf=&quot;loading&quot; class=&quot;loading&quot;&gt;Carregant elements...&lt;/div&gt;

  &lt;!-- Error --&gt;
  &lt;div *ngIf=&quot;error&quot; class=&quot;error&quot;&gt;{{ error }}&lt;/div&gt;

  &lt;!-- Llistat --&gt;
  &lt;div *ngIf=&quot;!loading &amp;&amp; !error&quot; class=&quot;items-grid&quot;&gt;
    &lt;div *ngFor=&quot;let item of items; trackBy: trackByItemId&quot; class=&quot;item-card&quot; (click)=&quot;viewDetail(item.id)&quot;&gt;
      &lt;h3&gt;{{ item.title }}&lt;/h3&gt;
      &lt;p&gt;{{ item.body | slice:0:100 }}...&lt;/p&gt;
      &lt;span class=&quot;item-id&quot;&gt;ID: {{ item.id }}&lt;/span&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/home/home.component.css</code></p>


<div class="code-block" data-lang="css" role="region" aria-label="Bloc de codi css">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">CSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-css">.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.loading, .error {
  text-align: center;
  padding: 3rem;
  font-size: 1.2rem;
}

.error {
  color: #f44336;
}

.items-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 1.5rem;
  margin-top: 2rem;
}

.item-card {
  background: white;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 1.5rem;
  cursor: pointer;
  transition: all 0.2s;
}

.item-card:hover {
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  transform: translateY(-2px);
}

.item-card h3 {
  margin: 0 0 1rem 0;
  color: #2196F3;
}

.item-card p {
  color: #666;
  line-height: 1.5;
}

.item-id {
  display: inline-block;
  background: #E3F2FD;
  color: #1976D2;
  padding: 0.25rem 0.75rem;
  border-radius: 12px;
  font-size: 0.875rem;
  margin-top: 1rem;
}</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Llistat mostra 100 elements de JSONPlaceholder</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Clicar una targeta navega a /item/:id</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Loading apareix mentre carrega</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">trackBy implementat per rendiment</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>4.3. Implementar component de detall</h3>

  <p>Creeu el component de detall que captura l'ID de la ruta i mostra la informació completa:</p>

  <p><strong>Fitxer:</strong> <code>src/app/features/detail/detail.component.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Component, OnInit } from &#39;@angular/core&#39;;
import { ActivatedRoute, Router } from &#39;@angular/router&#39;;
import { ItemService } from &#39;../../core/services/item.service&#39;;
import { Item } from &#39;../../core/models/item.model&#39;;

@Component({
  selector: &#39;app-detail&#39;,
  templateUrl: &#39;./detail.component.html&#39;,
  styleUrls: [&#39;./detail.component.css&#39;]
})
export class DetailComponent implements OnInit {
  item: Item | null = null;
  loading = true;
  error = &#39;&#39;;
  itemId: number = 0;

  constructor(
    private route: ActivatedRoute,
    private router: Router,
    private itemService: ItemService
  ) {}

  ngOnInit(): void {
    // Capturar paràmetre ID de la ruta
    this.route.params.subscribe(params =&gt; {
      this.itemId = +params[&#39;id&#39;];  // Convertir a number
      this.loadItem(this.itemId);
    });
  }

  loadItem(id: number): void {
    this.loading = true;
    this.itemService.getItemById(id).subscribe({
      next: (data) =&gt; {
        this.item = data;
        this.loading = false;
      },
      error: (err) =&gt; {
        this.error = &#39;Element no trobat&#39;;
        this.loading = false;
        console.error(err);
      }
    });
  }

  goBack(): void {
    this.router.navigate([&#39;/home&#39;]);
  }

  goToNext(): void {
    const nextId = this.itemId + 1;
    this.router.navigate([&#39;/item&#39;, nextId]);
  }

  goToPrevious(): void {
    if (this.itemId &gt; 1) {
      const prevId = this.itemId - 1;
      this.router.navigate([&#39;/item&#39;, prevId]);
    }
  }
}</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/detail/detail.component.html</code></p>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div class=&quot;container&quot;&gt;
  &lt;!-- Loading --&gt;
  &lt;div *ngIf=&quot;loading&quot; class=&quot;loading&quot;&gt;Carregant detall...&lt;/div&gt;

  &lt;!-- Error --&gt;
  &lt;div *ngIf=&quot;error&quot; class=&quot;error&quot;&gt;
    &lt;p&gt;{{ error }}&lt;/p&gt;
    &lt;button (click)=&quot;goBack()&quot; class=&quot;btn-primary&quot;&gt;Tornar al llistat&lt;/button&gt;
  &lt;/div&gt;

  &lt;!-- Detall --&gt;
  &lt;div *ngIf=&quot;item &amp;&amp; !loading&quot; class=&quot;detail&quot;&gt;
    &lt;div class=&quot;detail-header&quot;&gt;
      &lt;button (click)=&quot;goBack()&quot; class=&quot;btn-back&quot;&gt;← Tornar&lt;/button&gt;
      &lt;span class=&quot;item-badge&quot;&gt;ID: {{ item.id }}&lt;/span&gt;
    &lt;/div&gt;

    &lt;h1&gt;{{ item.title }}&lt;/h1&gt;

    &lt;div class=&quot;detail-meta&quot;&gt;
      &lt;span&gt;Usuari ID: {{ item.userId }}&lt;/span&gt;
      &lt;span&gt;Element: {{ item.id }} / 100&lt;/span&gt;
    &lt;/div&gt;

    &lt;div class=&quot;detail-content&quot;&gt;
      &lt;h3&gt;Descripció completa&lt;/h3&gt;
      &lt;p&gt;{{ item.body }}&lt;/p&gt;
    &lt;/div&gt;

    &lt;div class=&quot;detail-actions&quot;&gt;
      &lt;button (click)=&quot;goToPrevious()&quot; [disabled]=&quot;itemId &lt;= 1&quot; class=&quot;btn-secondary&quot;&gt;← Anterior&lt;/button&gt;
      &lt;button (click)=&quot;goToNext()&quot; [disabled]=&quot;itemId &gt;= 100&quot; class=&quot;btn-secondary&quot;&gt;Següent →&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/detail/detail.component.css</code></p>


<div class="code-block" data-lang="css" role="region" aria-label="Bloc de codi css">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">CSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-css">.container {
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem;
}

.loading, .error {
  text-align: center;
  padding: 3rem;
}

.detail {
  background: white;
  border-radius: 8px;
  padding: 2rem;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.detail-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
}

.btn-back {
  padding: 0.5rem 1rem;
  background: #e0e0e0;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 1rem;
}

.btn-back:hover {
  background: #d0d0d0;
}

.item-badge {
  background: #E3F2FD;
  color: #1976D2;
  padding: 0.5rem 1rem;
  border-radius: 20px;
  font-weight: bold;
}

.detail h1 {
  color: #2196F3;
  margin: 0 0 1rem 0;
}

.detail-meta {
  display: flex;
  gap: 2rem;
  color: #666;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid #e0e0e0;
}

.detail-content {
  margin: 2rem 0;
}

.detail-content h3 {
  color: #333;
  margin-bottom: 1rem;
}

.detail-content p {
  line-height: 1.8;
  color: #555;
}

.detail-actions {
  display: flex;
  gap: 1rem;
  justify-content: center;
  margin-top: 3rem;
}

.btn-secondary {
  padding: 0.75rem 2rem;
  background: #2196F3;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 1rem;
}

.btn-secondary:hover:not(:disabled) {
  background: #1976D2;
}

.btn-secondary:disabled {
  background: #ccc;
  cursor: not-allowed;
}

.btn-primary {
  padding: 0.75rem 2rem;
  background: #4CAF50;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 1rem;
}

.btn-primary:hover {
  background: #45a049;
}</code></pre>
  </div>
</div>


  <p>Verifiqueu la funcionalitat completa:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># 1. Navegar a Home
http://localhost:4200/home

# 2. Clicar qualsevol element
# Hauria de navegar a /item/:id

# 3. Verificar que mostra detall correcte
# 4. Provar botons Anterior/Següent
# 5. Provar botó Tornar
# 6. Provar URL directa: http://localhost:4200/item/25</code></pre>
  </div>
</div>


  <h3>Checkpoint</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Llistat mostra tots els elements de l'API</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Clicar element navega a detall amb ID correcte</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Component de detall captura paràmetre de ruta</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Detall mostra informació completa de l'element</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Navegació Anterior/Següent funciona</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Botó Tornar retorna al llistat</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Resolució de problemes</h3>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Problema</th>
        <th>Causa probable</th>
        <th>Solució</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>ID no es captura</td>
        <td>ActivatedRoute no usat</td>
        <td>Importar i injectar ActivatedRoute</td>
      </tr>
      <tr>
        <td>API no respon</td>
        <td>HttpClientModule no importat</td>
        <td>Afegir a app.module.ts</td>
      </tr>
      <tr>
        <td>Navegació no funciona</td>
        <td>Router no injectat</td>
        <td>Injectar Router al constructor</td>
      </tr>
      <tr>
        <td>+params['id'] és NaN</td>
        <td>Paràmetre mal capturat</td>
        <td>Verificar sintaxi route.params</td>
      </tr>
    </tbody>
  </table>

</div>

<!-- SECCIÓ 5: Guàrdies i gestió d'estat -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio5">
  <h2 id="Unitat4_Bloc4_Seccio5">5. Guàrdies i gestió d'estat</h2>

  <div class="info_box">
    <p><strong>Objectiu:</strong> Crear servei d'autenticació simulada amb estat global, implementar guàrdia de ruta per protegir seccions privades, i configurar redireccions quan l'accés és denegat.</p>
  </div>

  <h3>5.1. Crear servei d'autenticació</h3>

  <p>Definiu el model d'usuari i creeu el servei que gestionarà l'estat d'autenticació:</p>

  <p><strong>Fitxer:</strong> <code>src/app/core/models/user.model.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">export interface User {
  id: number;
  username: string;
  email: string;
}</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/core/services/auth.service.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Injectable } from &#39;@angular/core&#39;;
import { BehaviorSubject, Observable } from &#39;rxjs&#39;;
import { User } from &#39;../models/user.model&#39;;

@Injectable({
  providedIn: &#39;root&#39;
})
export class AuthService {
  private currentUserSubject: BehaviorSubject&lt;User | null&gt;;
  public currentUser: Observable&lt;User | null&gt;;

  constructor() {
    // Recuperar usuari de localStorage si existeix
    const storedUser = localStorage.getItem(&#39;currentUser&#39;);
    this.currentUserSubject = new BehaviorSubject&lt;User | null&gt;(
      storedUser ? JSON.parse(storedUser) : null
    );
    this.currentUser = this.currentUserSubject.asObservable();
  }

  public get currentUserValue(): User | null {
    return this.currentUserSubject.value;
  }

  login(username: string, password: string): Observable&lt;boolean&gt; {
    return new Observable(observer =&gt; {
      // Simulació d&#39;autenticació
      setTimeout(() =&gt; {
        if (username &amp;&amp; password.length &gt;= 4) {
          const user: User = {
            id: 1,
            username: username,
            email: `${username}@example.com`
          };

          localStorage.setItem(&#39;currentUser&#39;, JSON.stringify(user));
          this.currentUserSubject.next(user);
          observer.next(true);
          observer.complete();
        } else {
          observer.next(false);
          observer.complete();
        }
      }, 1000);  // Simula latència de xarxa
    });
  }

  logout(): void {
    localStorage.removeItem(&#39;currentUser&#39;);
    this.currentUserSubject.next(null);
  }

  isAuthenticated(): boolean {
    return this.currentUserValue !== null;
  }
}</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">AuthService creat amb estat reactiu</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Login simulat amb validació bàsica</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Logout neteja estat correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">isAuthenticated retorna estat correcte</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>5.2. Implementar component de login</h3>

  <p>Creeu el component que permetrà als usuaris autenticar-se:</p>

  <p><strong>Fitxer:</strong> <code>src/app/features/login/login.component.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Component } from &#39;@angular/core&#39;;
import { Router } from &#39;@angular/router&#39;;
import { AuthService } from &#39;../../core/services/auth.service&#39;;

@Component({
  selector: &#39;app-login&#39;,
  templateUrl: &#39;./login.component.html&#39;,
  styleUrls: [&#39;./login.component.css&#39;]
})
export class LoginComponent {
  username = &#39;&#39;;
  password = &#39;&#39;;
  loading = false;
  error = &#39;&#39;;

  constructor(
    private authService: AuthService,
    private router: Router
  ) {
    // Si ja està autenticat, redirigir a home
    if (this.authService.isAuthenticated()) {
      this.router.navigate([&#39;/home&#39;]);
    }
  }

  onSubmit(): void {
    this.error = &#39;&#39;;

    if (!this.username || !this.password) {
      this.error = &#39;Usuari i contrasenya són obligatoris&#39;;
      return;
    }

    if (this.password.length &lt; 4) {
      this.error = &#39;La contrasenya ha de tenir almenys 4 caràcters&#39;;
      return;
    }

    this.loading = true;

    this.authService.login(this.username, this.password).subscribe({
      next: (success) =&gt; {
        this.loading = false;
        if (success) {
          this.router.navigate([&#39;/favorites&#39;]);
        } else {
          this.error = &#39;Credencials incorrectes&#39;;
        }
      },
      error: (err) =&gt; {
        this.loading = false;
        this.error = &#39;Error durant el login&#39;;
        console.error(err);
      }
    });
  }
}</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/login/login.component.html</code></p>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div class=&quot;container&quot;&gt;
  &lt;div class=&quot;login-box&quot;&gt;
    &lt;h2&gt;Iniciar sessió&lt;/h2&gt;
    &lt;p class=&quot;subtitle&quot;&gt;Accedeix a la teva zona de preferits&lt;/p&gt;

    &lt;form (ngSubmit)=&quot;onSubmit()&quot; class=&quot;login-form&quot;&gt;
      &lt;!-- Usuari --&gt;
      &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;username&quot;&gt;Usuari:&lt;/label&gt;
        &lt;input type=&quot;text&quot; id=&quot;username&quot; [(ngModel)]=&quot;username&quot; name=&quot;username&quot; placeholder=&quot;Introdueix el teu usuari&quot; [disabled]=&quot;loading&quot; class=&quot;form-input&quot;&gt;
      &lt;/div&gt;

      &lt;!-- Contrasenya --&gt;
      &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;password&quot;&gt;Contrasenya:&lt;/label&gt;
        &lt;input type=&quot;password&quot; id=&quot;password&quot; [(ngModel)]=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;Mínim 4 caràcters&quot; [disabled]=&quot;loading&quot; class=&quot;form-input&quot;&gt;
      &lt;/div&gt;

      &lt;!-- Error --&gt;
      &lt;div *ngIf=&quot;error&quot; class=&quot;error-message&quot;&gt;{{ error }}&lt;/div&gt;

      &lt;!-- Submit --&gt;
      &lt;button type=&quot;submit&quot; [disabled]=&quot;loading&quot; class=&quot;btn-login&quot;&gt;
        &lt;span *ngIf=&quot;!loading&quot;&gt;Entrar&lt;/span&gt;
        &lt;span *ngIf=&quot;loading&quot;&gt;Autenticant...&lt;/span&gt;
      &lt;/button&gt;
    &lt;/form&gt;

    &lt;div class=&quot;hint&quot;&gt;
      &lt;strong&gt;Hint:&lt;/strong&gt; Qualsevol usuari i contrasenya ≥4 caràcters funciona
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/login/login.component.css</code></p>


<div class="code-block" data-lang="css" role="region" aria-label="Bloc de codi css">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">CSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-css">.container {
  max-width: 400px;
  margin: 4rem auto;
  padding: 2rem;
}

.login-box {
  background: white;
  border-radius: 8px;
  padding: 2rem;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.login-box h2 {
  margin: 0 0 0.5rem 0;
  color: #2196F3;
  text-align: center;
}

.subtitle {
  text-align: center;
  color: #666;
  margin-bottom: 2rem;
}

.login-form {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.form-group label {
  font-weight: 500;
  color: #333;
}

.form-input {
  padding: 0.75rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 1rem;
}

.form-input:focus {
  outline: none;
  border-color: #2196F3;
}

.form-input:disabled {
  background: #f5f5f5;
  cursor: not-allowed;
}

.error-message {
  background: #ffebee;
  color: #c62828;
  padding: 0.75rem;
  border-radius: 4px;
  border-left: 4px solid #c62828;
}

.btn-login {
  padding: 1rem;
  background: #2196F3;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 1rem;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.2s;
}

.btn-login:hover:not(:disabled) {
  background: #1976D2;
}

.btn-login:disabled {
  background: #ccc;
  cursor: not-allowed;
}

.hint {
  margin-top: 2rem;
  padding: 1rem;
  background: #E3F2FD;
  border-radius: 4px;
  font-size: 0.875rem;
  text-align: center;
}</code></pre>
  </div>
</div>


  <p>Importeu FormsModule al mòdul principal:</p>

  <p><strong>Fitxer:</strong> <code>src/app/app.module.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { FormsModule } from &#39;@angular/forms&#39;;

@NgModule({
  imports: [
    // ...
    FormsModule  // ← Afegir per ngModel
  ],
  // ...
})
export class AppModule { }</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Login mostra formulari correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Validacions funcionen (usuari i contrasenya)</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Login simulat funciona amb credencials vàlides</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Redirigeix a /favorites després de login</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>5.3. Crear guàrdia d'autenticació</h3>

  <p>Genereu i implementeu la guàrdia que protegirà les rutes privades:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Generar guàrdia
ng generate guard core/guards/auth --skip-tests</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/core/guards/auth.guard.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Injectable } from &#39;@angular/core&#39;;
import { Router, CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot } from &#39;@angular/router&#39;;
import { AuthService } from &#39;../services/auth.service&#39;;

@Injectable({
  providedIn: &#39;root&#39;
})
export class AuthGuard implements CanActivate {

  constructor(
    private router: Router,
    private authService: AuthService
  ) {}

  canActivate(
    route: ActivatedRouteSnapshot,
    state: RouterStateSnapshot
  ): boolean {
    const currentUser = this.authService.currentUserValue;

    if (currentUser) {
      // Usuari autenticat, permetre accés
      return true;
    }

    // No autenticat, redirigir a login
    this.router.navigate([&#39;/login&#39;], {
      queryParams: { returnUrl: state.url }
    });
    return false;
  }
}</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">AuthGuard creat correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Verifica estat d'autenticació</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Redirigeix a /login si no autenticat</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Guarda returnUrl per tornar després</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>5.4. Actualitzar header amb estat d'usuari</h3>

  <p>Modifiqueu el component de capçalera per mostrar l'estat d'autenticació:</p>

  <p><strong>Fitxer:</strong> <code>src/app/shared/components/header/header.component.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Component, OnInit } from &#39;@angular/core&#39;;
import { Router } from &#39;@angular/router&#39;;
import { AuthService } from &#39;../../../core/services/auth.service&#39;;
import { User } from &#39;../../../core/models/user.model&#39;;

@Component({
  selector: &#39;app-header&#39;,
  templateUrl: &#39;./header.component.html&#39;,
  styleUrls: [&#39;./header.component.css&#39;]
})
export class HeaderComponent implements OnInit {
  currentUser: User | null = null;

  constructor(
    private authService: AuthService,
    private router: Router
  ) {}

  ngOnInit(): void {
    this.authService.currentUser.subscribe(user =&gt; {
      this.currentUser = user;
    });
  }

  logout(): void {
    this.authService.logout();
    this.router.navigate([&#39;/login&#39;]);
  }
}</code></pre>
  </div>
</div>


  <p>Actualitzeu el template del header:</p>

  <p><strong>Fitxer:</strong> <code>src/app/shared/components/header/header.component.html</code></p>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;header class=&quot;header&quot;&gt;
  &lt;div class=&quot;container&quot;&gt;
    &lt;h1 class=&quot;logo&quot;&gt;
      &lt;a routerLink=&quot;/home&quot;&gt;Catàleg Universal&lt;/a&gt;
    &lt;/h1&gt;

    &lt;nav class=&quot;nav&quot;&gt;
      &lt;a routerLink=&quot;/home&quot; routerLinkActive=&quot;active&quot; [routerLinkActiveOptions]=&quot;{exact: true}&quot; class=&quot;nav-link&quot;&gt;Inici&lt;/a&gt;
      &lt;a routerLink=&quot;/search&quot; routerLinkActive=&quot;active&quot; class=&quot;nav-link&quot;&gt;Cerca&lt;/a&gt;
      &lt;a routerLink=&quot;/favorites&quot; routerLinkActive=&quot;active&quot; class=&quot;nav-link&quot;&gt;Preferits&lt;/a&gt;

      &lt;!-- Mostra Login si NO està autenticat --&gt;
      &lt;a *ngIf=&quot;!currentUser&quot; routerLink=&quot;/login&quot; routerLinkActive=&quot;active&quot; class=&quot;nav-link&quot;&gt;Login&lt;/a&gt;

      &lt;!-- Mostra usuari i Logout si està autenticat --&gt;
      &lt;div *ngIf=&quot;currentUser&quot; class=&quot;user-menu&quot;&gt;
        &lt;span class=&quot;username&quot;&gt;{{ currentUser.username }}&lt;/span&gt;
        &lt;button (click)=&quot;logout()&quot; class=&quot;btn-logout&quot;&gt;Sortir&lt;/button&gt;
      &lt;/div&gt;
    &lt;/nav&gt;
  &lt;/div&gt;
&lt;/header&gt;</code></pre>
  </div>
</div>


  <p>Afegiu els estils per al menú d'usuari:</p>

  <p><strong>Fitxer:</strong> <code>src/app/shared/components/header/header.component.css</code></p>


<div class="code-block" data-lang="css" role="region" aria-label="Bloc de codi css">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">CSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-css">/* ... estils anteriors ... */

.user-menu {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.username {
  color: white;
  font-weight: 500;
}

.btn-logout {
  padding: 0.5rem 1rem;
  background: rgba(255,255,255,0.2);
  color: white;
  border: 1px solid white;
  border-radius: 4px;
  cursor: pointer;
  transition: background 0.2s;
}

.btn-logout:hover {
  background: rgba(255,255,255,0.3);
}</code></pre>
  </div>
</div>


  <h3>Checkpoint</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">AuthService gestiona estat d'autenticació</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Login funciona amb credencials simulades</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Header mostra nom d'usuari quan està autenticat</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Botó Logout funciona correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">AuthGuard protegeix rutes (aplicarem al següent bloc)</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Resolució de problemes</h3>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Problema</th>
        <th>Causa probable</th>
        <th>Solució</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>ngModel no funciona</td>
        <td>FormsModule no importat</td>
        <td>Afegir a app.module.ts</td>
      </tr>
      <tr>
        <td>currentUser sempre null</td>
        <td>BehaviorSubject mal inicialitzat</td>
        <td>Verificar constructor AuthService</td>
      </tr>
      <tr>
        <td>Logout no actualitza UI</td>
        <td>No subscrit a currentUser</td>
        <td>Subscribir al header.component</td>
      </tr>
      <tr>
        <td>Guàrdia no redirigeix</td>
        <td>Router no injectat</td>
        <td>Injectar Router a constructor</td>
      </tr>
    </tbody>
  </table>

</div>

<!-- SECCIÓ 6: Modularització i lazy loading -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio6">
  <h2 id="Unitat4_Bloc4_Seccio6">6. Modularització i lazy loading</h2>

  <div class="info_box">
    <p><strong>Objectiu:</strong> Crear mòdul de preferits amb components i rutes pròpies, configurar lazy loading per carregar-lo només quan s'accedeix, i protegir-lo amb la guàrdia d'autenticació.</p>
  </div>

  <h3>6.1. Crear mòdul de preferits</h3>

  <p>Genereu un mòdul funcional amb el seu propi sistema de rutes:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Generar mòdul amb routing
ng generate module features/favorites --routing</code></pre>
  </div>
</div>


  <p>Creeu els components del mòdul:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash">ng generate component features/favorites/favorites-list --skip-tests
ng generate component features/favorites/favorites-settings --skip-tests</code></pre>
  </div>
</div>


  <p>Configureu les rutes internes del mòdul:</p>

  <p><strong>Fitxer:</strong> <code>src/app/features/favorites/favorites-routing.module.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { NgModule } from &#39;@angular/core&#39;;
import { RouterModule, Routes } from &#39;@angular/router&#39;;
import { FavoritesListComponent } from &#39;./favorites-list/favorites-list.component&#39;;
import { FavoritesSettingsComponent } from &#39;./favorites-settings/favorites-settings.component&#39;;

const routes: Routes = [
  { path: &#39;&#39;, redirectTo: &#39;list&#39;, pathMatch: &#39;full&#39; },
  { path: &#39;list&#39;, component: FavoritesListComponent },
  { path: &#39;settings&#39;, component: FavoritesSettingsComponent }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule]
})
export class FavoritesRoutingModule { }</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/favorites/favorites.module.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { NgModule } from &#39;@angular/core&#39;;
import { CommonModule } from &#39;@angular/common&#39;;
import { FavoritesRoutingModule } from &#39;./favorites-routing.module&#39;;
import { FavoritesListComponent } from &#39;./favorites-list/favorites-list.component&#39;;
import { FavoritesSettingsComponent } from &#39;./favorites-settings/favorites-settings.component&#39;;

@NgModule({
  declarations: [
    FavoritesListComponent,
    FavoritesSettingsComponent
  ],
  imports: [
    CommonModule,
    FavoritesRoutingModule
  ]
})
export class FavoritesModule { }</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">FavoritesModule creat amb routing propi</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Components del mòdul generats</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Rutes internes configurades (list, settings)</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>6.2. Implementar components de preferits</h3>

  <p>Desenvolupeu els components del mòdul de preferits:</p>

  <p><strong>Fitxer:</strong> <code>src/app/features/favorites/favorites-list/favorites-list.component.html</code></p>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div class=&quot;favorites-container&quot;&gt;
  &lt;div class=&quot;favorites-header&quot;&gt;
    &lt;h2&gt;Els meus preferits&lt;/h2&gt;
    &lt;a routerLink=&quot;/favorites/settings&quot; class=&quot;btn-settings&quot;&gt;⚙️ Configuració&lt;/a&gt;
  &lt;/div&gt;

  &lt;div class=&quot;favorites-content&quot;&gt;
    &lt;div class=&quot;welcome-message&quot;&gt;
      &lt;h3&gt;Zona de preferits&lt;/h3&gt;
      &lt;p&gt;Aquesta és una zona protegida que només els usuaris autenticats poden veure.&lt;/p&gt;
      &lt;p&gt;Aquí podríeu gestionar els vostres elements favorits, crear llistes personalitzades, etc.&lt;/p&gt;
    &lt;/div&gt;

    &lt;div class=&quot;feature-list&quot;&gt;
      &lt;div class=&quot;feature-card&quot;&gt;
        &lt;h4&gt;📌 Guardar preferits&lt;/h4&gt;
        &lt;p&gt;Marca els elements que més t&#39;agradin per trobar-los fàcilment&lt;/p&gt;
      &lt;/div&gt;
      &lt;div class=&quot;feature-card&quot;&gt;
        &lt;h4&gt;📝 Crear llistes&lt;/h4&gt;
        &lt;p&gt;Organitza els teus preferits en col·leccions temàtiques&lt;/p&gt;
      &lt;/div&gt;
      &lt;div class=&quot;feature-card&quot;&gt;
        &lt;h4&gt;🔔 Notificacions&lt;/h4&gt;
        &lt;p&gt;Rep alertes quan hi hagi novetats als teus preferits&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/favorites/favorites-list/favorites-list.component.css</code></p>


<div class="code-block" data-lang="css" role="region" aria-label="Bloc de codi css">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">CSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-css">.favorites-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.favorites-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid #e0e0e0;
}

.favorites-header h2 {
  margin: 0;
  color: #2196F3;
}

.btn-settings {
  padding: 0.5rem 1rem;
  background: #4CAF50;
  color: white;
  text-decoration: none;
  border-radius: 4px;
  transition: background 0.2s;
}

.btn-settings:hover {
  background: #45a049;
}

.favorites-content {
  background: white;
  border-radius: 8px;
  padding: 2rem;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.welcome-message {
  background: #E3F2FD;
  padding: 2rem;
  border-radius: 8px;
  margin-bottom: 2rem;
  text-align: center;
}

.welcome-message h3 {
  color: #1976D2;
  margin: 0 0 1rem 0;
}

.welcome-message p {
  margin: 0.5rem 0;
  color: #555;
}

.feature-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
}

.feature-card {
  padding: 1.5rem;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  transition: all 0.2s;
}

.feature-card:hover {
  border-color: #2196F3;
  box-shadow: 0 4px 8px rgba(33, 150, 243, 0.2);
}

.feature-card h4 {
  margin: 0 0 1rem 0;
  color: #333;
}

.feature-card p {
  margin: 0;
  color: #666;
  line-height: 1.5;
}</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/favorites/favorites-settings/favorites-settings.component.html</code></p>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div class=&quot;settings-container&quot;&gt;
  &lt;div class=&quot;settings-header&quot;&gt;
    &lt;h2&gt;Configuració de preferits&lt;/h2&gt;
    &lt;a routerLink=&quot;/favorites/list&quot; class=&quot;btn-back&quot;&gt;← Tornar a preferits&lt;/a&gt;
  &lt;/div&gt;

  &lt;div class=&quot;settings-content&quot;&gt;
    &lt;div class=&quot;settings-section&quot;&gt;
      &lt;h3&gt;Opcions de visualització&lt;/h3&gt;
      &lt;label class=&quot;checkbox-label&quot;&gt;
        &lt;input type=&quot;checkbox&quot; checked&gt;
        Mostrar imatges als preferits
      &lt;/label&gt;
      &lt;label class=&quot;checkbox-label&quot;&gt;
        &lt;input type=&quot;checkbox&quot; checked&gt;
        Ordenar per data d&#39;addició
      &lt;/label&gt;
    &lt;/div&gt;

    &lt;div class=&quot;settings-section&quot;&gt;
      &lt;h3&gt;Notificacions&lt;/h3&gt;
      &lt;label class=&quot;checkbox-label&quot;&gt;
        &lt;input type=&quot;checkbox&quot;&gt;
        Alertes de nous elements similars
      &lt;/label&gt;
      &lt;label class=&quot;checkbox-label&quot;&gt;
        &lt;input type=&quot;checkbox&quot;&gt;
        Resum setmanal per correu
      &lt;/label&gt;
    &lt;/div&gt;

    &lt;div class=&quot;settings-actions&quot;&gt;
      &lt;button class=&quot;btn-save&quot;&gt;Guardar canvis&lt;/button&gt;
      &lt;button class=&quot;btn-cancel&quot;&gt;Cancel·lar&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/favorites/favorites-settings/favorites-settings.component.css</code></p>


<div class="code-block" data-lang="css" role="region" aria-label="Bloc de codi css">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">CSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-css">.settings-container {
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem;
}

.settings-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
}

.settings-header h2 {
  margin: 0;
  color: #2196F3;
}

.btn-back {
  padding: 0.5rem 1rem;
  background: #e0e0e0;
  color: #333;
  text-decoration: none;
  border-radius: 4px;
}

.btn-back:hover {
  background: #d0d0d0;
}

.settings-content {
  background: white;
  border-radius: 8px;
  padding: 2rem;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.settings-section {
  margin-bottom: 2rem;
  padding-bottom: 2rem;
  border-bottom: 1px solid #e0e0e0;
}

.settings-section:last-of-type {
  border-bottom: none;
}

.settings-section h3 {
  margin: 0 0 1rem 0;
  color: #333;
}

.checkbox-label {
  display: block;
  margin: 1rem 0;
  cursor: pointer;
  user-select: none;
}

.checkbox-label input {
  margin-right: 0.5rem;
}

.settings-actions {
  display: flex;
  gap: 1rem;
  justify-content: flex-end;
  margin-top: 2rem;
}

.btn-save, .btn-cancel {
  padding: 0.75rem 2rem;
  border: none;
  border-radius: 4px;
  font-size: 1rem;
  cursor: pointer;
}

.btn-save {
  background: #4CAF50;
  color: white;
}

.btn-save:hover {
  background: #45a049;
}

.btn-cancel {
  background: #e0e0e0;
  color: #333;
}

.btn-cancel:hover {
  background: #d0d0d0;
}</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Components de preferits implementats</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Navegació interna funciona (list ↔ settings)</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">UI mostra zona protegida correctament</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>6.3. Configurar lazy loading i protecció</h3>

  <p>Actualitzeu el mòdul de rutes principal per activar lazy loading i protecció amb guàrdia:</p>

  <p><strong>Fitxer:</strong> <code>src/app/app-routing.module.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { AuthGuard } from &#39;./core/guards/auth.guard&#39;;

const routes: Routes = [
  { path: &#39;&#39;, redirectTo: &#39;/home&#39;, pathMatch: &#39;full&#39; },
  { path: &#39;home&#39;, component: HomeComponent },
  { path: &#39;search&#39;, component: SearchComponent },
  { path: &#39;item/:id&#39;, component: DetailComponent },
  { path: &#39;login&#39;, component: LoginComponent },
  {
    path: &#39;favorites&#39;,
    loadChildren: () =&gt; import(&#39;./features/favorites/favorites.module&#39;)
      .then(m =&gt; m.FavoritesModule),
    canActivate: [AuthGuard]  // ← Protegir amb guàrdia
  },
  { path: &#39;404&#39;, component: NotFoundComponent },
  { path: &#39;**&#39;, redirectTo: &#39;/404&#39; }
];</code></pre>
  </div>
</div>


  <p>Verifiqueu que el lazy loading funciona correctament:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># 1. Compilar amb stats
ng build --configuration production --stats-json

# 2. Verificar que crea chunk separat
ls -lh dist/cataleg-universal/browser/

# Hauríeu de veure:
# - main.*.js
# - features-favorites-favorites-module.*.js  ← Chunk separat!</code></pre>
  </div>
</div>


  <p>Proveu el flux complet d'autenticació i accés:</p>


<div class="code-block" data-lang="plaintext" role="region" aria-label="Bloc de codi plaintext">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">PLAINTEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-plaintext">1. Navegar sense login → /favorites
   → Hauria de redirigir a /login

2. Fer login amb credencials
   → Hauria de redirigir a /favorites/list

3. Navegar a /favorites/settings
   → Hauria de funcionar (ja autenticat)

4. Fer logout
   → Tornar a intentar /favorites
   → Hauria de redirigir a /login novament</code></pre>
  </div>
</div>


  <h3>Checkpoint</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">FavoritesModule crea chunk separat (lazy loading)</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">AuthGuard protegeix totes les rutes de /favorites</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Login correcte dona accés a preferits</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Logout revoca accés correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">returnUrl funciona després del login</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Resolució de problemes</h3>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Problema</th>
        <th>Causa probable</th>
        <th>Solució</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Lazy loading no funciona</td>
        <td>loadChildren mal configurat</td>
        <td>Verificar sintaxi import()</td>
      </tr>
      <tr>
        <td>Chunk no es crea</td>
        <td>Build no optimitzat</td>
        <td>Usar --configuration production</td>
      </tr>
      <tr>
        <td>Guàrdia no aplica</td>
        <td>canActivate absent</td>
        <td>Afegir a ruta de favorites</td>
      </tr>
      <tr>
        <td>Redirecció infinita</td>
        <td>Lògica de guàrdia incorrecta</td>
        <td>Verificar condició isAuthenticated</td>
      </tr>
    </tbody>
  </table>

</div>

<!-- SECCIÓ 7: Optimitzacions de rendiment -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio7">
  <h2 id="Unitat4_Bloc4_Seccio7">7. Optimitzacions de rendiment</h2>

  <div class="info_box">
    <p><strong>Objectiu:</strong> Aplicar estratègia OnPush per minimitzar detecció de canvis, implementar virtualització per llistes grans amb Angular CDK, i mesurar impacte de les optimitzacions.</p>
  </div>

  <h3>7.1. Implementar estratègia OnPush</h3>

  <p>Apliqueu la detecció de canvis OnPush al component de llistat per millorar el rendiment:</p>

  <p><strong>Fitxer:</strong> <code>src/app/features/home/home.component.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Component, OnInit, ChangeDetectionStrategy } from &#39;@angular/core&#39;;
// ... altres imports ...

@Component({
  selector: &#39;app-home&#39;,
  templateUrl: &#39;./home.component.html&#39;,
  styleUrls: [&#39;./home.component.css&#39;],
  changeDetection: ChangeDetectionStrategy.OnPush  // ← Afegir OnPush
})
export class HomeComponent implements OnInit {
  // ... codi existent ...
}</code></pre>
  </div>
</div>


  <p>Creeu component presentacional amb OnPush per les targetes:</p>

  <p><strong>Fitxer:</strong> <code>src/app/shared/components/item-card/item-card.component.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { Component, Input, Output, EventEmitter, ChangeDetectionStrategy } from &#39;@angular/core&#39;;
import { Item } from &#39;../../../core/models/item.model&#39;;

@Component({
  selector: &#39;app-item-card&#39;,
  templateUrl: &#39;./item-card.component.html&#39;,
  styleUrls: [&#39;./item-card.component.css&#39;],
  changeDetection: ChangeDetectionStrategy.OnPush
})
export class ItemCardComponent {
  @Input() item!: Item;
  @Output() cardClick = new EventEmitter&lt;number&gt;();

  onCardClick(): void {
    this.cardClick.emit(this.item.id);
  }
}</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/shared/components/item-card/item-card.component.html</code></p>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div class=&quot;item-card&quot; (click)=&quot;onCardClick()&quot;&gt;
  &lt;h3&gt;{{ item.title }}&lt;/h3&gt;
  &lt;p&gt;{{ item.body }}&lt;/p&gt;
  &lt;span class=&quot;item-id&quot;&gt;ID: {{ item.id }}&lt;/span&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">OnPush aplicat a components contenidors</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Components presentacionals amb @Input i @Output</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Immutabilitat respectada (no mutacions directes)</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>7.2. Implementar scroll virtual amb CDK</h3>

  <p>Instal·leu Angular CDK per virtualització de llistes:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Instal·lar Angular CDK
npm install @angular/cdk</code></pre>
  </div>
</div>


  <p>Importeu el mòdul de scrolling:</p>

  <p><strong>Fitxer:</strong> <code>src/app/app.module.ts</code></p>


<div class="code-block" data-lang="typescript" role="region" aria-label="Bloc de codi typescript">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TYPESCRIPT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-typescript">import { ScrollingModule } from &#39;@angular/cdk/scrolling&#39;;

@NgModule({
  imports: [
    // ... altres imports ...
    ScrollingModule  // ← Afegir
  ],
  // ...
})
export class AppModule { }</code></pre>
  </div>
</div>


  <p>Actualitzeu el component Home per usar scroll virtual:</p>

  <p><strong>Fitxer:</strong> <code>src/app/features/home/home.component.html</code></p>


<div class="code-block" data-lang="html" role="region" aria-label="Bloc de codi html">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">HTML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-html">&lt;div class=&quot;container&quot;&gt;
  &lt;h2&gt;Catàleg complet ({{ items.length }} elements)&lt;/h2&gt;

  &lt;!-- Loading --&gt;
  &lt;div *ngIf=&quot;loading&quot; class=&quot;loading&quot;&gt;Carregant elements...&lt;/div&gt;

  &lt;!-- Error --&gt;
  &lt;div *ngIf=&quot;error&quot; class=&quot;error&quot;&gt;{{ error }}&lt;/div&gt;

  &lt;!-- Llistat amb scroll virtual --&gt;
  &lt;cdk-virtual-scroll-viewport *ngIf=&quot;!loading &amp;&amp; !error&quot; itemSize=&quot;200&quot; class=&quot;viewport&quot;&gt;
    &lt;div *cdkVirtualFor=&quot;let item of items; trackBy: trackByItemId&quot; class=&quot;item-wrapper&quot;&gt;
      &lt;app-item-card [item]=&quot;item&quot; (cardClick)=&quot;viewDetail($event)&quot;&gt;&lt;/app-item-card&gt;
    &lt;/div&gt;
  &lt;/cdk-virtual-scroll-viewport&gt;
&lt;/div&gt;</code></pre>
  </div>
</div>


  <p><strong>Fitxer:</strong> <code>src/app/features/home/home.component.css</code></p>


<div class="code-block" data-lang="css" role="region" aria-label="Bloc de codi css">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">CSS</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-css">/* ... estils anteriors ... */

.viewport {
  height: 80vh;
  width: 100%;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
}

.item-wrapper {
  padding: 1rem;
  border-bottom: 1px solid #f0f0f0;
}</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Angular CDK instal·lat correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">ScrollingModule importat</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">cdk-virtual-scroll-viewport funciona</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Només elements visibles es renderitzen</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>7.3. Mesurar rendiment</h3>

  <p>Utilitzeu les eines de desenvolupament del navegador per mesurar l'impacte de les optimitzacions:</p>


<div class="code-block" data-lang="plaintext" role="region" aria-label="Bloc de codi plaintext">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">PLAINTEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-plaintext"># 1. Obrir Chrome DevTools
# 2. Anar a Performance tab
# 3. Gravar mentre navegues:
#    - Scroll per la llista
#    - Navegar entre rutes
#    - Interactuar amb elements

# 4. Analitzar mètriques:
#    - Scripting time (hauria de ser menor amb OnPush)
#    - Rendering time (hauria de ser menor amb virtualització)
#    - FPS (hauria de ser més constant)

# 5. Comparar abans/després d&#39;OnPush</code></pre>
  </div>
</div>


  <p>Proveu amb el Lighthouse integrat:</p>


<div class="code-block" data-lang="plaintext" role="region" aria-label="Bloc de codi plaintext">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">PLAINTEXT</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-plaintext"># 1. Obrir Chrome DevTools
# 2. Anar a Lighthouse tab
# 3. Seleccionar:
#    - Performance
#    - Desktop
# 4. Generate report

# Buscar millores a:
# - First Contentful Paint (FCP)
# - Time to Interactive (TTI)
# - Total Blocking Time (TBT)</code></pre>
  </div>
</div>


  <h3>Checkpoint</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">OnPush redueix cicles de detecció de canvis</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Virtualització millora scroll amb 100 elements</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Lighthouse mostra millores de rendiment</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">FPS més constant durant scroll</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Bundle size reduït amb lazy loading</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Comparativa de rendiment</h3>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Mètrica</th>
        <th>Abans</th>
        <th>Després</th>
        <th>Millora</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>FCP (First Contentful Paint)</td>
        <td>~1.5s</td>
        <td>~0.8s</td>
        <td>47% més ràpid</td>
      </tr>
      <tr>
        <td>Bundle inicial</td>
        <td>~500KB</td>
        <td>~350KB</td>
        <td>30% més petit</td>
      </tr>
      <tr>
        <td>Nodes DOM renderitzats (scroll)</td>
        <td>100</td>
        <td>~10-15</td>
        <td>85% menys</td>
      </tr>
      <tr>
        <td>FPS durant scroll</td>
        <td>30-40 FPS</td>
        <td>55-60 FPS</td>
        <td>50% millor</td>
      </tr>
    </tbody>
  </table>

  <h3>Resolució de problemes</h3>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Problema</th>
        <th>Causa probable</th>
        <th>Solució</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>OnPush no actualitza UI</td>
        <td>Mutació directa d'arrays</td>
        <td>Usar spread o immutabilitat</td>
      </tr>
      <tr>
        <td>CDK viewport no funciona</td>
        <td>ScrollingModule no importat</td>
        <td>Afegir a imports del mòdul</td>
      </tr>
      <tr>
        <td>Scroll irregular</td>
        <td>itemSize incorrecte</td>
        <td>Ajustar a alçada real dels items</td>
      </tr>
      <tr>
        <td>trackBy no funciona</td>
        <td>Funció retorna undefined</td>
        <td>Verificar que retorna item.id</td>
      </tr>
    </tbody>
  </table>

</div>

<!-- SECCIÓ 8: Verificació i build de producció -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio8">
  <h2 id="Unitat4_Bloc4_Seccio8">8. Verificació i build de producció</h2>

  <div class="info_box">
    <p><strong>Objectiu:</strong> Compilar l'aplicació per producció, analitzar la mida dels bundles, verificar que totes les funcionalitats operen correctament i preparar l'aplicació per desplegament.</p>
  </div>

  <h3>8.1. Build de producció</h3>

  <p>Compileu l'aplicació amb optimitzacions de producció:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Build de producció amb stats
ng build --configuration production --stats-json

# Verificar sortida
ls -lh dist/cataleg-universal/browser/</code></pre>
  </div>
</div>


  <p>Analitzeu el contingut dels bundles generats:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Instal·lar webpack-bundle-analyzer
npm install --save-dev webpack-bundle-analyzer

# Analitzar bundles
npx webpack-bundle-analyzer dist/cataleg-universal/browser/stats.json</code></pre>
  </div>
</div>


  <p><strong>Checkpoint:</strong></p>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Build de producció completa sense errors</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Chunks separats per lazy loading visibles</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Bundle analyzer mostra distribució de mides</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Compressió gzip aplicada automàticament</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>8.2. Checklist de funcionalitats</h3>

  <p>Verifiqueu que totes les funcionalitats implementades funcionen correctament:</p>

  <h4>Navegació i rutes</h4>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">/ redirigeix a /home correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Totes les rutes principals funcionen (home, search, item/:id, login, favorites)</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">404 captura rutes inexistents</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Navegació del header actualitza ruta activa</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h4>Vista de detall</h4>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Paràmetre :id es captura correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">API retorna dades de l'element</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Botons Anterior/Següent funcionen</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Botó Tornar retorna a /home</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h4>Autenticació</h4>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Login valida credencials (mínim 4 caràcters)</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Estat d'usuari es guarda a localStorage</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Header mostra usuari autenticat</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Logout neteja estat i redirigeix</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h4>Protecció de rutes</h4>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">AuthGuard bloqueja /favorites sense login</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Login correcte dona accés a favorites</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">returnUrl funciona després de login</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Logout revoca accés a favorites</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h4>Lazy loading</h4>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">FavoritesModule crea chunk separat</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Chunk només es carrega quan s'accedeix a /favorites</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Network tab mostra càrrega diferida</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h4>Optimitzacions</h4>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">OnPush aplicat a components</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Virtualització funciona amb scroll</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">trackBy implementat correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">DevTools mostra millores de rendiment</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>8.3. Anàlisi de mides</h3>

  <p>Reviseu la mida dels arxius generats i identifiqueu possibles millores:</p>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Arxiu</th>
        <th>Mida (gzip)</th>
        <th>Descripció</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>main.*.js</td>
        <td>~150-200 KB</td>
        <td>Bundle principal amb AppModule i components eagerly loaded</td>
      </tr>
      <tr>
        <td>polyfills.*.js</td>
        <td>~35-40 KB</td>
        <td>Polyfills necessaris per compatibilitat navegadors</td>
      </tr>
      <tr>
        <td>favorites-module.*.js</td>
        <td>~15-20 KB</td>
        <td>Chunk del mòdul de preferits (lazy loaded)</td>
      </tr>
      <tr>
        <td>styles.*.css</td>
        <td>~5-10 KB</td>
        <td>Estils globals compilats</td>
      </tr>
    </tbody>
  </table>

  <h3>8.4. Preparar per desplegament</h3>

  <p>Verifiqueu que l'aplicació està llesta per publicar:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># Servir build local
npx http-server dist/cataleg-universal/browser -p 8080

# Provar a: http://localhost:8080

# Verificar:
# - Navegació funciona
# - Assets carreguen correctament
# - No hi ha errors a la consola
# - Rutes funcionen sense hash (#)</code></pre>
  </div>
</div>


  <p>Creeu fitxer de configuració per desplegament:</p>

  <h4>Opció 1: Desplegament a Vercel</h4>

  <p><strong>Fitxer:</strong> <code>vercel.json</code></p>


<div class="code-block" data-lang="json" role="region" aria-label="Bloc de codi json">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">JSON</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-json">{
  &quot;buildCommand&quot;: &quot;ng build --configuration production&quot;,
  &quot;outputDirectory&quot;: &quot;dist/cataleg-universal/browser&quot;,
  &quot;rewrites&quot;: [
    {
      &quot;source&quot;: &quot;/(.*)&quot;,
      &quot;destination&quot;: &quot;/index.html&quot;
    }
  ]
}</code></pre>
  </div>
</div>


  <p>Passos per desplegar a Vercel:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># 1. Instal·lar Vercel CLI (opcional, també pots usar la web)
npm install -g vercel

# 2. Login a Vercel
vercel login

# 3. Desplegar des del directori del projecte
vercel

# 4. Seguir les instruccions:
#    - Set up and deploy? Y
#    - Which scope? (seleccionar el teu compte)
#    - Link to existing project? N
#    - What&#39;s your project&#39;s name? cataleg-universal
#    - In which directory is your code located? ./
#    - Want to override the settings? N

# 5. Per desplegament de producció:
vercel --prod</code></pre>
  </div>
</div>


  <h4>Opció 2: Desplegament a Netlify</h4>

  <p><strong>Fitxer:</strong> <code>netlify.toml</code></p>


<div class="code-block" data-lang="toml" role="region" aria-label="Bloc de codi toml">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">TOML</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-toml">[build]
  publish = &quot;dist/cataleg-universal/browser&quot;
  command = &quot;ng build --configuration production&quot;

[[redirects]]
  from = &quot;/*&quot;
  to = &quot;/index.html&quot;
  status = 200</code></pre>
  </div>
</div>


  <p>Passos per desplegar a Netlify:</p>


<div class="code-block" data-lang="bash" role="region" aria-label="Bloc de codi bash">
  <div class="code-header">
    <div class="code-info">
      <span class="code-lang">BASH</span>
      
    </div>
    <div class="code-actions">
      <button class="toggle-expand" title="Expandir/Col·lapsar alçada" aria-label="Expandir o col·lapsar alçada" aria-pressed="false"><i class="bi bi-arrows-fullscreen" aria-hidden="true"></i></button>
      <button class="toggle-lines" title="Mostrar/Ocultar números de línia" aria-label="Mostrar o ocultar números de línia">#</button>
      <button class="copy-btn" title="Copiar codi al portapapers" aria-label="Copiar codi"><i class="bi bi-clipboard" aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="code-container">
    <div class="line-numbers" aria-hidden="true"></div>
    <pre role="textbox" aria-readonly="true" aria-label="Codi font"><code class="language-bash"># 1. Instal·lar Netlify CLI (opcional)
npm install -g netlify-cli

# 2. Login a Netlify
netlify login

# 3. Inicialitzar i desplegar
netlify init

# 4. O desplegar manualment:
#    - Anar a https://app.netlify.com
#    - New site from Git
#    - Connectar repositori
#    - Build command: ng build --configuration production
#    - Publish directory: dist/cataleg-universal/browser</code></pre>
  </div>
</div>


  <div class="info_box">
    <p><strong>Recomanació:</strong> Vercel ofereix integració excel·lent amb Angular i detecta automàticament la configuració. És una opció molt convenient per projectes Angular.</p>
  </div>

  <h3>Checkpoint final</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Build de producció completa sense warnings</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Totes les funcionalitats verificades</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Bundle analyzer executat i revisat</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Aplicació servida localment funciona</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Preparada per desplegament a hosting</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Resolució de problemes</h3>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Problema</th>
        <th>Causa probable</th>
        <th>Solució</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Build falla</td>
        <td>Errors de TypeScript</td>
        <td>Revisar consola i corregir errors</td>
      </tr>
      <tr>
        <td>Bundle massa gran</td>
        <td>Dependències pesades</td>
        <td>Revisar amb bundle analyzer</td>
      </tr>
      <tr>
        <td>404 en producció</td>
        <td>Server no redirigeix a index.html</td>
        <td>Configurar redirects al servidor</td>
      </tr>
      <tr>
        <td>Assets no carreguen</td>
        <td>Base href incorrecte</td>
        <td>Verificar --base-href al build</td>
      </tr>
    </tbody>
  </table>

</div>

<!-- SECCIÓ 9: Autoavaluació -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio9">
  <h2 id="Unitat4_Bloc4_Seccio9">9. Autoavaluació</h2>

  <p>Utilitzeu aquesta checklist per verificar que heu assolit tots els objectius del cas d'ús:</p>

  <h3>Sistema de rutes (RA4.1)</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">He configurat correctament totes les rutes principals</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">La navegació entre vistes funciona sense errors</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Els enllaços actius es destaquen visualment</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">La ruta 404 captura paths inexistents</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Gestió de paràmetres (RA4.1)</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">La vista de detall captura l'ID de la URL</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Els paràmetres es processen correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">La navegació amb paràmetres funciona</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">He implementat trackBy per rendiment</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Autenticació i estat (RA4.2, RA4.3)</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">El servei d'autenticació gestiona l'estat global</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">El login simula correctament l'autenticació</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">L'estat es preserva amb localStorage</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">El logout neteja l'estat correctament</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Protecció de rutes (RA4.3)</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">La guàrdia bloqueja accés no autoritzat</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Les redireccions funcionen correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">El returnUrl preserva la destinació original</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Totes les rutes protegides estan verificades</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Modularització (RA4.4)</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">He creat un mòdul funcional amb routing propi</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">El lazy loading funciona correctament</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">El chunk separat es genera al build</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">La càrrega diferida es verifica al Network tab</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Optimitzacions (RA4.4)</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">He aplicat OnPush on correspon</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">La virtualització millora el rendiment</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">He mesurat l'impacte amb DevTools</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">El bundle size s'ha reduït amb lazy loading</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


  <h3>Verificació i desplegament (RA4.5)</h3>

  <!-- Component: Checklist (sense contenidor extern) -->

<div class="checklist-list" role="group" aria-label="Checklist">
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">El build de producció completa sense errors</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">He analitzat la mida dels bundles</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">Totes les funcionalitats estan verificades</div>
  </div>
  
  <div class="checklist-item" role="checkbox" tabindex="0" aria-checked="false">
    <div class="checklist-checkbox" aria-hidden="true"></div>
    <div class="checklist-text">L'aplicació està llesta per publicar</div>
  </div>
  
  <!-- Interacció via JS en assets/js/site.js: click/teclat actualitza aria-checked -->
</div>


</div>

<!-- SECCIÓ 10: Recapitulació -->
<div class="section cas-dus" id="Unitat4_Bloc4_Seccio10">
  <h2 id="Unitat4_Bloc4_Seccio10">10. Recapitulació</h2>

  <h3>Què heu après</h3>

  <p>En aquest cas d'ús integrador, heu aplicat tots els coneixements del mòdul per construir una aplicació Angular completa i professional. Heu treballat amb:</p>

  <h4>Navegació i arquitectura</h4>

  <ul>
    <li><strong>Sistema de rutes multi-pàgina:</strong> Configuració completa amb rutes principals, paràmetres, lazy loading i gestió de 404</li>
    <li><strong>Components organitzats:</strong> Separació entre contenidors i presentacionals amb responsabilitats clares</li>
    <li><strong>Serveis centralitzats:</strong> Gestió d'estat, autenticació i comunicació amb API en serveis reutilitzables</li>
  </ul>

  <h4>Seguretat i control d'accés</h4>

  <ul>
    <li><strong>Autenticació simulada:</strong> Sistema de login amb gestió d'estat persistent</li>
    <li><strong>Guàrdies de ruta:</strong> Protecció de seccions privades amb redireccions automàtiques</li>
    <li><strong>Gestió d'estat global:</strong> Ús de BehaviorSubject per estat reactiu compartit</li>
  </ul>

  <h4>Optimitzacions de rendiment</h4>

  <ul>
    <li><strong>Lazy loading:</strong> Càrrega diferida de mòduls per reduir bundle inicial</li>
    <li><strong>OnPush:</strong> Estratègia de detecció de canvis optimitzada</li>
    <li><strong>Virtualització:</strong> Renderització eficient de llistes grans amb CDK</li>
    <li><strong>TrackBy:</strong> Optimització de bucles *ngFor</li>
  </ul>

  <h4>Desplegament i producció</h4>

  <ul>
    <li><strong>Build optimitzat:</strong> Compilació per producció amb anàlisi de bundles</li>
    <li><strong>Verificació completa:</strong> Comprovació sistemàtica de totes les funcionalitats</li>
    <li><strong>Preparació per publicar:</strong> Aplicació llesta per desplegar a hosting</li>
  </ul>

  <h3>Passos següents</h3>

  <p>Per continuar millorant l'aplicació, podríeu:</p>

  <ul>
    <li>Implementar tests unitaris i e2e amb Jest i Cypress</li>
    <li>Afegir internacionalització (i18n) per múltiples idiomes</li>
    <li>Integrar una API real substituint JSONPlaceholder</li>
    <li>Implementar Progressive Web App (PWA) amb Service Workers</li>
    <li>Afegir animacions amb Angular Animations</li>
    <li>Configurar CI/CD per desplegament automàtic</li>
  </ul>

  <h3>Recursos addicionals</h3>

  <ul>
    <li><a href="https://angular.dev/guide/routing/common-router-tasks" target="_blank">Documentació oficial Angular Router</a></li>
    <li><a href="https://angular.dev/best-practices/runtime-performance" target="_blank">Guia detecció de canvis</a></li>
    <li><a href="https://material.angular.dev/cdk/scrolling/overview" target="_blank">Angular CDK Scrolling</a></li>
    <li><a href="https://web.dev/articles/vitals" target="_blank">Web Vitals per mesurar rendiment</a></li>
  </ul>

  <div class="success_box">
    <p><strong>Felicitats!</strong> Heu completat el cas d'ús integrador de la Unitat 4. Ara teniu les habilitats necessàries per desenvolupar aplicacions Angular professionals amb navegació complexa, seguretat, optimitzacions de rendiment i preparades per producció.</p>
  </div>

</div>


<!-- Exercicis proposats (si estan definits) -->


<!-- Recursos addicionals -->


<!-- Glossari del bloc -->



<!-- Schema.org structured data per SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "name": "Cas d'ús: Aplicació completa amb navegació i optimització",
  "description": "",
  "author": {
    "@type": "Organization",
    "name": "Institut Obert de Catalunya"
  },
  "provider": {
    "@type": "Organization",
    "name": "Institut Obert de Catalunya"
  },
  "educationalLevel": "Intermediate",
  "learningResourceType": "Course Module",
  "inLanguage": "ca",
  
  
  "isPartOf": {
    "@type": "Course",
    "name": "DA2_OA01 - Programació Avançada (Angular) — IOC",
    "description": "Materials del mòdul DA2_OA01 - Programació Avançada amb Angular"
  }
}
</script>

                </div>
            </article>
            
            <!-- Navegació entre pàgines -->
            
            <nav class="page-navigation" role="navigation" aria-label="Navegació entre blocs">
                <div class="nav-links-container">
                    
                    
                    
                    
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                            
                    
                    
                    
                        
                            
                        
                            
                        
                            
                        
                            
                                
                                
                                
                                
                                
                                    
                                    
                                        
                                    
                                        
                                    
                                        
                                            
                                            
                                
                                
                                
                                
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                
                                
                    
                    
                    <div class="nav-link-wrapper">
                        
                        <a href="/ioc/da2_oa01/unitat-4/bloc-3/" class="nav-button" aria-label="Bloc anterior: Optimització de rendiment">← Anterior</a>
                        
                    </div>
                    
                    <div class="nav-link-wrapper">
                        
                    </div>
                </div>
            </nav>
            
        </main>
    </div>

    <!-- Footer fix -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-info">
                Versió v1.0
            </div>
            <div class="footer-progress" aria-label="Progrés de lectura"><!-- Progrés per unitats (posició de la unitat actual) --><div class="progress-group course-progress">
                    <span class="progress-label">Unitat</span>
                    <span class="progress-text" data-pos="4" data-total="4">(4/4)</span>
                    <div class="progress-bar-footer"><div class="progress-fill-footer" style="width: 100%"></div></div>
                </div><!-- Progrés per blocs dins de la unitat --><div class="progress-group unit-progress">
                        <span class="progress-label">Bloc</span>
                        <span class="progress-text" data-pos="4" data-total="4">(4/4)</span>
                        <div class="progress-bar-footer"><div class="progress-fill-footer" style="width: 100%"></div></div>
                    </div>

                    <!-- Progrés per seccions (H2) dins del bloc --><div class="progress-group section-progress" data-scan-sections="true">
                        <span class="progress-label">Secció</span>
                        <span class="progress-text" data-pos="1" data-total="11">(1/11)</span>
                        <div class="progress-bar-footer"><div class="progress-fill-footer" style="width: 9%"></div></div>
                    </div></div>
            <div class="footer-actions" aria-label="Accions ràpides">
                <button class="task-btn footer-collapse-toggle" type="button" aria-expanded="true" aria-label="Amaga el peu de pàgina">
                  <i class="bi bi-chevron-down" aria-hidden="true"></i>
                </button>
                <a href="#top" id="footer-btn-top" class="task-btn" aria-label="Anar a l'inici">↑</a>
                <a href="#bottom" id="footer-btn-bottom" class="task-btn" aria-label="Anar al final">↓</a>
                <a href="#next" id="footer-btn-next" class="task-btn" aria-label="Secció següent">→</a>
                <a href="#prev" id="footer-btn-prev" class="task-btn" aria-label="Secció anterior">←</a>
                <a href="#bookmark" id="footer-btn-bookmark" class="task-btn" aria-label="Desar marcador" title="Desar marcador">
                  <i class="bi bi-bookmark" aria-hidden="true"></i>
                </a>
                <a href="/ioc/da2_oa01/quadern.html" class="task-btn" aria-label="Obrir quadern complet" title="Quadern">
                  <i class="bi bi-journal-text" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </footer>

    <!-- Scripts del lloc -->
    <script src="/ioc/da2_oa01/assets/js/site.js" defer></script>
    <!-- Quadern Notes v2 (nou sistema) -->
    <script src="/ioc/da2_oa01/assets/js/quadern-app/constants.js" defer></script>
    <script src="/ioc/da2_oa01/assets/js/quadern-app/utils.js" defer></script>
    <script src="/ioc/da2_oa01/assets/js/quadern-app/store.js" defer></script>
    <script src="/ioc/da2_oa01/assets/js/quadern-app/panel.js" defer></script>
    <script src="/ioc/da2_oa01/assets/js/index-notes.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" defer></script>
    <script src="/ioc/da2_oa01/assets/js/quadern-app/rich-editor.js" defer></script>
    <script>
      document.addEventListener('DOMContentLoaded', function(){
        if (window.Quadern && typeof window.Quadern.bootstrapNotes === 'function') {
          try { window.Quadern.bootstrapNotes(); } catch(e) {}
        }
        if (window.Quadern && window.Quadern.RichEditor && typeof window.Quadern.RichEditor.autoInit === 'function') {
          try { window.Quadern.RichEditor.autoInit(); } catch(e) {}
        }
      });
    </script>
</body>
</html>
